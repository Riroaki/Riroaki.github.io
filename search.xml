<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Aerospike + redis + 流立方部署经历</title>
      <link href="/Aerospike/"/>
      <url>/Aerospike/</url>
      
        <content type="html"><![CDATA[<p>这几天因为业务需要，在linux服务器搞个redis集群。</p><a id="more"></a><h3 id="Aerospike"><a href="#Aerospike" class="headerlink" title="Aerospike"></a>Aerospike</h3><pre class="line-numbers language-shell"><code class="language-shell">$ tar zxf aerospike-server-community-4.5.1.5-ubuntu18.04.tgz$ cd aerospike-server-community-4.5.1.5-ubuntu18.04//aerospike-server-community-4.5.1.5-ubuntu18.04$ ll$ sudo ./asinstall...<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-shell"><code class="language-shell">Checking dependenciesDependency not found: python 2.6+ (< 3)Failed to find all dependencies. Please install all required packages.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>好嘛，没装python。</p><pre class="line-numbers language-shell"><code class="language-shell">bolean@bolean:/$ sudo apt install python2Reading package lists... DoneBuilding dependency treeReading state information... DoneE: Unable to locate package python2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>看来是apt源出了问题。</p><pre class="line-numbers language-shell"><code class="language-shell">bolean@bolean:/$ apt updateErr:1 http://us.archive.ubuntu.com/ubuntu bionic InRelease  Could not resolve 'mirrrors.aliyun.com'Err:2 http://security.ubuntu.com/ubuntu bionic-security InRelease  Could not resolve 'mirrrors.aliyun.com'Err:3 http://us.archive.ubuntu.com/ubuntu bionic-updates InRelease  Could not resolve 'mirrrors.aliyun.com'Err:4 http://us.archive.ubuntu.com/ubuntu bionic-backports InRelease  Could not resolve 'mirrrors.aliyun.com'Reading package lists... DoneBuilding dependency treeReading state information... DoneAll packages are up to date.W: Failed to fetch http://us.archive.ubuntu.com/ubuntu/dists/bionic/InRelease  Could not resolve 'mirrrors.aliyun.com'W: Failed to fetch http://us.archive.ubuntu.com/ubuntu/dists/bionic-updates/InRelease  Could not resolve 'mirrrors.aliyun.com'W: Failed to fetch http://us.archive.ubuntu.com/ubuntu/dists/bionic-backports/InRelease  Could not resolve 'mirrrors.aliyun.com'W: Failed to fetch http://security.ubuntu.com/ubuntu/dists/bionic-security/InRelease  Could not resolve 'mirrrors.aliyun.com'W: Some index files failed to download. They have been ignored, or old ones used instead.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>查了一下找到一个说法（<a href="https://askubuntu.com/questions/1076242/running-sudo-apt-get-update-returns-connection-errors）：">https://askubuntu.com/questions/1076242/running-sudo-apt-get-update-returns-connection-errors）：</a></p><blockquote><p>This was caused by Kaspersky Total Security version 2019. It is a known issue that this version blocks HTTP and HTTPS traffic from consoles. It will be solved in the 2020 version next year, so in the meantime I uninstalled the 2019 version and reinstalled the 2018 version.</p></blockquote><p>然后苦思冥想——终于发现了不对劲的地方：</p><pre class="line-numbers language-shell"><code class="language-shell">Could not resolve 'mirrrors.aliyun.com'<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>mirrror？？？</p><p>哪个zz把mirror拼错的。。</p><p>果然，在<code>/etc/apt/apt.conf</code>中赫然写着：</p><p><code>Acquire::http::Proxy &quot;http://mirrrors.aliyun.com&quot;;</code></p><p>……改回来之后，发现还是有错：</p><pre class="line-numbers language-shell"><code class="language-shell">$ sudo apt updateErr:1 http://security.ubuntu.com/ubuntu bionic-security InRelease  502  Bad Gateway [IP: 117.91.183.232 80]Err:2 http://us.archive.ubuntu.com/ubuntu bionic InRelease  502  Bad Gateway [IP: 117.91.183.232 80]Err:3 http://us.archive.ubuntu.com/ubuntu bionic-updates InRelease  502  Bad Gateway [IP: 117.91.183.232 80]Err:4 http://us.archive.ubuntu.com/ubuntu bionic-backports InRelease  502  Bad Gateway [IP: 117.91.183.232 80]Reading package lists... DoneN: See apt-secure(8) manpage for repository creation and user configuration details.N: Updating from such a repository can't be done securely, and is therefore disabled by default.E: The repository 'http://security.ubuntu.com/ubuntu bionic-security InRelease' is not signed.E: Failed to fetch http://security.ubuntu.com/ubuntu/dists/bionic-security/InRelease  502  Bad Gateway [IP: 117.91.183.232 80]N: See apt-secure(8) manpage for repository creation and user configuration details.N: Updating from such a repository can't be done securely, and is therefore disabled by default.E: The repository 'http://us.archive.ubuntu.com/ubuntu bionic InRelease' is not signed.E: Failed to fetch http://us.archive.ubuntu.com/ubuntu/dists/bionic/InRelease  502  Bad Gateway [IP: 117.91.183.232 80]E: Failed to fetch http://us.archive.ubuntu.com/ubuntu/dists/bionic-updates/InRelease  502  Bad Gateway [IP: 117.91.183.232 80]E: The repository 'http://us.archive.ubuntu.com/ubuntu bionic-updates InRelease' is not signed.N: Updating from such a repository can't be done securely, and is therefore disabled by default.N: See apt-secure(8) manpage for repository creation and user configuration details.E: Failed to fetch http://us.archive.ubuntu.com/ubuntu/dists/bionic-backports/InRelease  502  Bad Gateway [IP: 117.91.183.232 80]E: The repository 'http://us.archive.ubuntu.com/ubuntu bionic-backports InRelease' is not signed.N: Updating from such a repository can't be done securely, and is therefore disabled by default.N: See apt-secure(8) manpage for repository creation and user configuration details.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这下真该换源了。把<code>source.list</code>的内容清空，换成：</p><pre class="line-numbers language-shell"><code class="language-shell">deb http://mirrors.aliyun.com/ubuntu/ bionic main restricted universe multiverse deb http://mirrors.aliyun.com/ubuntu/ bionic-security main restricted universe multiverse deb http://mirrors.aliyun.com/ubuntu/ bionic-updates main restricted universe multiverse deb http://mirrors.aliyun.com/ubuntu/ bionic-proposed main restricted universe multiverse deb http://mirrors.aliyun.com/ubuntu/ bionic-backports main restricted universe multiverse deb-src http://mirrors.aliyun.com/ubuntu/ bionic main restricted universe multiverse deb-src http://mirrors.aliyun.com/ubuntu/ bionic-security main restricted universe multiverse deb-src http://mirrors.aliyun.com/ubuntu/ bionic-updates main restricted universe multiverse deb-src http://mirrors.aliyun.com/ubuntu/ bionic-proposed main restricted universe multiverse deb-src http://mirrors.aliyun.com/ubuntu/ bionic-backports main restricted universe multiverse<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ok了。顺着刚才安装了aerospike和aerospike-tool，成功。</p><p>启动后，可以用asadm查看当前集群：</p><pre class="line-numbers language-shell"><code class="language-shell">$ asadmSeed:        [('127.0.0.1', 3000, None)]Config_file: /home/bolean/.aerospike/astools.conf, /etc/aerospike/astools.confAerospike Interactive Shell, version 0.2.1ERROR: Not able to connect any cluster with [('127.0.0.1', 3000, None)].<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Redis"><a href="#Redis" class="headerlink" title="Redis"></a>Redis</h3><p>接下来安装redis：</p><pre class="line-numbers language-shell"><code class="language-shell">$ sudo apt install make gcc make-guile# 将redis解压，放在usr/local文件目录下，然后进入redis目录：$ make PREFIX=/usr/local/redis-5.0.4 MALLOC=libc install# 将conf放在bin目录下$ cp redis.conf bin/$ cd bin && tree.├── redis-benchmark├── redis-check-aof├── redis-check-rdb├── redis-cli├── redis-sentinel -> redis-server├── redis-server└── redis.conf0 directories, 7 files<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>启动redis：</p><ul><li>可以在bin直接启动：<code>./redis-server</code>，但是这样是前端启动，会话关闭就停止运行</li><li>在配置文件修改守护进程选项，变成后台运行：</li></ul><pre class="line-numbers language-shell"><code class="language-shell"># /usr/local/redis-5.0.4/bin/redis.conf################################# GENERAL ###################################### By default Redis does not run as a daemon. Use 'yes' if you need it.# Note that Redis will write a pid file in /var/run/redis.pid when daemonized.daemonize yes # no就是前台运行，后台运行就要改成yes<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>运行：</p><pre class="line-numbers language-shell"><code class="language-shell"># /usr/local/redis-5.0.4/bin/$ ./redis-server ./redis.conf10442:C 24 Apr 2019 13:36:47.716 # oO0OoO0OoO0Oo Redis is starting oO0OoO0OoO0Oo10442:C 24 Apr 2019 13:36:47.716 # Redis version=5.0.4, bits=64, commit=00000000, modified=0, pid=10442, just started10442:C 24 Apr 2019 13:36:47.716 # Configuration loaded<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>启动客户端进行连接：</p><pre class="line-numbers language-shell"><code class="language-shell">$ ./redis-cli 127.0.0.1:6379> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>关闭（shutdown则数据不会丢失）：</p><pre class="line-numbers language-shell"><code class="language-shell">$ ./bin/redis-cli shutdown$ ./bin/redis-cli shutdown # 强行关闭，有风险<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>配置执行文件：</p><pre class="line-numbers language-shell"><code class="language-shell"># .../redis-5.0.4/$ sudo cp bin/redis-server /usr/local/bin$ sudo cp bin/redis-cli /usr/local/bin<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="搭建redis集群"><a href="#搭建redis集群" class="headerlink" title="搭建redis集群"></a>搭建redis集群</h3><pre class="line-numbers language-shell"><code class="language-shell"># .../redis.5.0.4/$ mkdir redis_cluster$ cd redis_cluster$ mkdir 7000 7001 7002             #redis集群要求最少有3个节点$ touch 7000/redis.conf$ touch 7001/redis.conf$ touch 7002/redis.conf<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>对刚才创建的三个文件进行修改：</p><pre class="line-numbers language-shell"><code class="language-shell">port 7000               # 端口7000,7001,7002，与目录对应bind 127.0.0.1    #默认ip为127.0.0.1，需要改为其他节点机器可访问的ip，                                    #否则创建集群时无法访问对应的端口，无法创建集群daemonize yes       #redis后台运行cluster-enabled yes                                      #开启集群cluster-config-file nodes_7000.conf      #集群的配置，配置文件首次启动自动生成 7000，7001，7002  cluster-node-timeout 8000                       #请求超时，默认15秒，可自行设置appendonly yes      #开启aof持久化模式，每次写操作请求都追加到appendonly.aof文件中appendfsync always                                      #每次有写操作的时候都同步logfile "/data/redis/logs/redis.log"     #redis服务日志pidfile /var/run/redis_7000.pid              #pidfile文件对应7000，7001，7002<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>启动节点：</p><pre class="line-numbers language-shell"><code class="language-shell"># .../redis.5.0.4/bin/$ ./redis_server ../redis_cluster/7000/redis.conf$ ./redis_server ../redis_cluster/7001/redis.conf$ ./redis_server ../redis_cluster/7002/redis.conf<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>检查运行状态：<code>ps -ef | grep redis</code></p><p>创建集群（中间会跳出提示确认主从关系，一般默认yes就可以）：</p><pre class="line-numbers language-shell"><code class="language-shell">$ redis-cli --cluster create 127.0.0.1:7000 127.0.0.1:7001 127.0.0.1:7002>>> Performing hash slots allocation on 3 nodes...Master[0] -> Slots 0 - 5460Master[1] -> Slots 5461 - 10922Master[2] -> Slots 10923 - 16383M: ac89a9153573984a3b44aac06145eab7ea891688 127.0.0.1:7000   slots:[0-5460] (5461 slots) masterM: 5d84b4867d3209aa2fca638b1f7959d3e6b6d5b5 127.0.0.1:7001   slots:[5461-10922] (5462 slots) masterM: 457b35c69e1de25650e0d35d7ca85af6c4b0578f 127.0.0.1:7002   slots:[10923-16383] (5461 slots) masterCan I set the above configuration? (type 'yes' to accept): yes>>> Nodes configuration updated>>> Assign a different config epoch to each node>>> Sending CLUSTER MEET messages to join the clusterWaiting for the cluster to join..>>> Performing Cluster Check (using node 127.0.0.1:7000)M: ac89a9153573984a3b44aac06145eab7ea891688 127.0.0.1:7000   slots:[0-5460] (5461 slots) masterM: 457b35c69e1de25650e0d35d7ca85af6c4b0578f 127.0.0.1:7002   slots:[10923-16383] (5461 slots) masterM: 5d84b4867d3209aa2fca638b1f7959d3e6b6d5b5 127.0.0.1:7001   slots:[5461-10922] (5462 slots) master[OK] All nodes agree about slots configuration.>>> Check for open slots...>>> Check slots coverage...[OK] All 16384 slots covered.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>环境验证（检查集群状态）：</p><pre class="line-numbers language-shell"><code class="language-shell">$  redis-cli --cluster info 127.0.0.1:7000127.0.0.1:7000 (ac89a915...) -> 0 keys | 5461 slots | 0 slaves.127.0.0.1:7002 (457b35c6...) -> 0 keys | 5461 slots | 0 slaves.127.0.0.1:7001 (5d84b486...) -> 0 keys | 5462 slots | 0 slaves.[OK] 0 keys in 3 masters.0.00 keys per slot on average.$ redis-cli --cluster check 127.0.0.1:7000127.0.0.1:7000 (ac89a915...) -> 0 keys | 5461 slots | 0 slaves.127.0.0.1:7002 (457b35c6...) -> 0 keys | 5461 slots | 0 slaves.127.0.0.1:7001 (5d84b486...) -> 0 keys | 5462 slots | 0 slaves.[OK] 0 keys in 3 masters.0.00 keys per slot on average.>>> Performing Cluster Check (using node 127.0.0.1:7000)M: ac89a9153573984a3b44aac06145eab7ea891688 127.0.0.1:7000   slots:[0-5460] (5461 slots) masterM: 457b35c69e1de25650e0d35d7ca85af6c4b0578f 127.0.0.1:7002   slots:[10923-16383] (5461 slots) masterM: 5d84b4867d3209aa2fca638b1f7959d3e6b6d5b5 127.0.0.1:7001   slots:[5461-10922] (5462 slots) master[OK] All nodes agree about slots configuration.>>> Check for open slots...>>> Check slots coverage...[OK] All 16384 slots covered.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>登录节点：</p><pre class="line-numbers language-shell"><code class="language-shell">$ redis-cli -h 10.100.1.239  -p 7000127.0.0.1:7000> cluster info # 查看集群状态cluster_state:okcluster_slots_assigned:16384cluster_slots_ok:16384cluster_slots_pfail:0cluster_slots_fail:0cluster_known_nodes:3cluster_size:3cluster_current_epoch:3cluster_my_epoch:1cluster_stats_messages_ping_sent:970cluster_stats_messages_pong_sent:906cluster_stats_messages_sent:1876cluster_stats_messages_ping_received:904cluster_stats_messages_pong_received:970cluster_stats_messages_meet_received:2cluster_stats_messages_received:1876<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="在多个服务器搭建多个集群"><a href="#在多个服务器搭建多个集群" class="headerlink" title="在多个服务器搭建多个集群"></a>在多个服务器搭建多个集群</h3><p>同上操作，对其他服务器做一样的配置即可。</p><h3 id="节点启动和关闭脚本"><a href="#节点启动和关闭脚本" class="headerlink" title="节点启动和关闭脚本"></a>节点启动和关闭脚本</h3><p>如果有多个节点可以这么启动和关闭：</p><pre class="line-numbers language-shell"><code class="language-shell"># 启动，在每个服务器执行for((i=0;i<3;i++));     do redis-server ~/redis-5.0.4/redis-cluster/700$i/redis.conf;done# 关闭，IP为三台服务器对应IPfor((i=0;i<3;i++));    do redis-cli -c -h $IP -p 700$i shutdown; done<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="无法启动"><a href="#无法启动" class="headerlink" title="无法启动"></a>无法启动</h3><p>删除每个集群的配置文件（第一次运行会产生的<code>nodes_700x.conf</code>），再对每个服务器重启</p><h3 id="Linux安装OpenJDK配置环境"><a href="#Linux安装OpenJDK配置环境" class="headerlink" title="Linux安装OpenJDK配置环境"></a>Linux安装OpenJDK配置环境</h3><p>流立方真的很坑爹。按照这个链接下载包，然后用dpkg安装，遇到依赖要用apt的-f参数下载。</p><p>btw，Linux机器上，网页可以在links上浏览。links2甚至支持鼠标点击～</p><h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><p><a href="https://www.cnblogs.com/zhoujie/p/redis3.html">https://www.cnblogs.com/zhoujie/p/redis3.html</a></p><p><a href="https://blog.csdn.net/isoleo/article/details/53303916">https://blog.csdn.net/isoleo/article/details/53303916</a></p>]]></content>
      
      
      <categories>
          
          <category> back end </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
            <tag> shell </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ML学习日记8——自己实现一个神经网络（2）</title>
      <link href="/ML-8-My-Neuron-Network-Model-2/"/>
      <url>/ML-8-My-Neuron-Network-Model-2/</url>
      
        <content type="html"><![CDATA[<h3 id="第二代网络的训练结果"><a href="#第二代网络的训练结果" class="headerlink" title="第二代网络的训练结果"></a>第二代网络的训练结果</h3><p>将Neuron合并到Layer层，对逻辑进行修整，终于能够正常跑出结果了，而且效果还不差：</p><a id="more"></a><pre class="line-numbers language-shell"><code class="language-shell"># sigmoid + sigmoid + softmax# 256 / 10100%|██████████| 235/235 [04:25<00:00,  1.00s/it]Total loss for epoch 10: 32288.39537826673, time cost: 265.6903088092804 secs.Total loss for prediction: 5931.410300381332, accuracy: 0.8228<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-shell"><code class="language-shell"># tanh + sigmoid + softmax# 64 / 5100%|██████████| 938/938 [04:36<00:00,  4.17it/s]Total loss for epoch 5: 41377.05493973562, time cost: 277.0324709415436 secs.Total loss for prediction: 8342.556892968885, accuracy: 0.7391<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-shell"><code class="language-shell"># 128 / 5100%|██████████| 469/469 [04:30<00:00,  2.37it/s]Total loss for epoch 5: 36775.7511731053, time cost: 270.526123046875 secs.Total loss for prediction: 6180.927977005118, accuracy: 0.8236<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-shell"><code class="language-shell"># 256 / 5100%|██████████| 235/235 [04:24<00:00,  1.26it/s]Total loss for epoch 5: 45772.576551853526, time cost: 264.71701884269714 secs.Total loss for prediction: 7214.586185511183, accuracy: 0.8187<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>忍不住又要贴代码在这里……</p><h3 id="Layer类"><a href="#Layer类" class="headerlink" title="Layer类"></a>Layer类</h3><p>更新w和b矩阵的部分是关键！</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Layer</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> in_dim<span class="token punctuation">:</span> int<span class="token punctuation">,</span> out_dim<span class="token punctuation">:</span> int<span class="token punctuation">,</span> activation<span class="token punctuation">:</span> str<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>__in_dim <span class="token operator">=</span> in_dim        self<span class="token punctuation">.</span>__out_dim <span class="token operator">=</span> out_dim        self<span class="token punctuation">.</span>__w <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>uniform<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token punctuation">(</span>in_dim<span class="token punctuation">,</span> out_dim<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>__b <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>uniform<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token punctuation">(</span>out_dim<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>__act_func <span class="token operator">=</span> act_set<span class="token punctuation">[</span>activation<span class="token punctuation">]</span>        self<span class="token punctuation">.</span>__act_diff_func <span class="token operator">=</span> act_diff_set<span class="token punctuation">[</span>activation<span class="token punctuation">]</span>        self<span class="token punctuation">.</span>__rate <span class="token operator">=</span> <span class="token number">0.3</span>        self<span class="token punctuation">.</span>__input <span class="token operator">=</span> None        self<span class="token punctuation">.</span>__output <span class="token operator">=</span> None    <span class="token keyword">def</span> <span class="token function">feed_forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x_batch<span class="token punctuation">:</span> np<span class="token punctuation">.</span>ndarray<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>__input <span class="token operator">=</span> x_batch        self<span class="token punctuation">.</span>__output <span class="token operator">=</span> np<span class="token punctuation">.</span>matmul<span class="token punctuation">(</span>x_batch<span class="token punctuation">,</span> self<span class="token punctuation">.</span>__w<span class="token punctuation">)</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>x_batch<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>__output<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+=</span> self<span class="token punctuation">.</span>__b        <span class="token keyword">return</span> self<span class="token punctuation">.</span>__act_func<span class="token punctuation">(</span>self<span class="token punctuation">.</span>__output<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">back_propagation</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> grad_batch<span class="token punctuation">:</span> np<span class="token punctuation">.</span>ndarray<span class="token punctuation">,</span> after_act<span class="token punctuation">:</span> bool <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># Softmax + cross entropy = improved, where after_act = False</span>        <span class="token keyword">if</span> after_act<span class="token punctuation">:</span>            grad_batch <span class="token operator">*=</span> self<span class="token punctuation">.</span>__act_diff_func<span class="token punctuation">(</span>self<span class="token punctuation">.</span>__output<span class="token punctuation">)</span>        batch_size <span class="token operator">=</span> len<span class="token punctuation">(</span>grad_batch<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># Each row is grads for neurons in the layer</span>        res <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>self<span class="token punctuation">.</span>__input<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>batch_size<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>self<span class="token punctuation">.</span>__w<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                res<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>inner<span class="token punctuation">(</span>grad_batch<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>__w<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># mini-batch</span>        diff_w <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>self<span class="token punctuation">.</span>__w<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>        diff_b <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>self<span class="token punctuation">.</span>__b<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>batch_size<span class="token punctuation">)</span><span class="token punctuation">:</span>            diff_w <span class="token operator">+=</span> np<span class="token punctuation">.</span>outer<span class="token punctuation">(</span>self<span class="token punctuation">.</span>__input<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> grad_batch<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>            diff_b <span class="token operator">+=</span> grad_batch<span class="token punctuation">[</span>i<span class="token punctuation">]</span>        self<span class="token punctuation">.</span>__w <span class="token operator">-=</span> self<span class="token punctuation">.</span>__rate <span class="token operator">*</span> diff_w <span class="token operator">/</span> batch_size        self<span class="token punctuation">.</span>__b <span class="token operator">-=</span> self<span class="token punctuation">.</span>__rate <span class="token operator">*</span> diff_b <span class="token operator">/</span> batch_size        <span class="token keyword">return</span> res    @property    <span class="token keyword">def</span> <span class="token function">in_dim</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>__in_dim    @property    <span class="token keyword">def</span> <span class="token function">out_dim</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>__out_dim<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Model类"><a href="#Model类" class="headerlink" title="Model类"></a>Model类</h3><p>大体来说和第一代没有本质区别，除了稍微调整一下代码结构。</p><p>另外，我发现python的type hint并没有什么作用……</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Model</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>__layers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        self<span class="token punctuation">.</span>__depth <span class="token operator">=</span> <span class="token number">0</span>        self<span class="token punctuation">.</span>__in_dim <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span>        self<span class="token punctuation">.</span>__out_dim <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span>        self<span class="token punctuation">.</span>__loss_func <span class="token operator">=</span> None        self<span class="token punctuation">.</span>__loss_diff_func <span class="token operator">=</span> None        self<span class="token punctuation">.</span>__loss_name <span class="token operator">=</span> <span class="token string">''</span>    <span class="token keyword">def</span> <span class="token function">add_layer</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> out_dim<span class="token punctuation">:</span> int<span class="token punctuation">,</span> in_dim<span class="token punctuation">:</span> int <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> activation<span class="token punctuation">:</span> str <span class="token operator">=</span> <span class="token string">"none"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># Check validness of parameters</span>        <span class="token keyword">assert</span> out_dim <span class="token operator">></span> <span class="token number">0</span>        <span class="token keyword">if</span> self<span class="token punctuation">.</span>__depth <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>            <span class="token keyword">assert</span> in_dim <span class="token operator">></span> <span class="token number">0</span>            self<span class="token punctuation">.</span>__out_dim <span class="token operator">=</span> in_dim        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">assert</span> in_dim <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">or</span> in_dim <span class="token operator">==</span> self<span class="token punctuation">.</span>__out_dim        activation <span class="token operator">=</span> activation<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">assert</span> activation <span class="token keyword">in</span> act_set        self<span class="token punctuation">.</span>__depth <span class="token operator">+=</span> <span class="token number">1</span>        self<span class="token punctuation">.</span>__layers<span class="token punctuation">.</span>append<span class="token punctuation">(</span>Layer<span class="token punctuation">(</span>self<span class="token punctuation">.</span>__out_dim<span class="token punctuation">,</span> out_dim<span class="token punctuation">,</span> activation<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>__out_dim <span class="token operator">=</span> out_dim    <span class="token keyword">def</span> <span class="token function">remove_layer</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> index<span class="token punctuation">:</span> int<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># Check validness of index</span>        <span class="token keyword">assert</span> <span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">&lt;</span> index <span class="token operator">&lt;</span> self<span class="token punctuation">.</span>__depth<span class="token punctuation">)</span> <span class="token operator">or</span> <span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">></span> index <span class="token operator">>=</span> <span class="token operator">-</span>self<span class="token punctuation">.</span>__depth<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>__depth <span class="token operator">-=</span> <span class="token number">1</span>        <span class="token keyword">del</span> self<span class="token punctuation">.</span>__layers<span class="token punctuation">[</span>index<span class="token punctuation">]</span>        <span class="token comment" spellcheck="true"># Update input and output dim if necessary.</span>        <span class="token keyword">if</span> self<span class="token punctuation">.</span>__depth <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>__in_dim <span class="token operator">=</span> <span class="token number">0</span>            self<span class="token punctuation">.</span>__out_dim <span class="token operator">=</span> <span class="token number">0</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>__in_dim <span class="token operator">=</span> self<span class="token punctuation">.</span>__layers<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>in_dim            self<span class="token punctuation">.</span>__out_dim <span class="token operator">=</span> self<span class="token punctuation">.</span>__layers<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>out_dim    <span class="token keyword">def</span> <span class="token function">compile</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> loss<span class="token punctuation">:</span> str <span class="token operator">=</span> <span class="token string">"cross entropy"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">assert</span> loss <span class="token keyword">in</span> loss_set        self<span class="token punctuation">.</span>__loss_func <span class="token operator">=</span> loss_set<span class="token punctuation">[</span>loss<span class="token punctuation">]</span>        self<span class="token punctuation">.</span>__loss_diff_func <span class="token operator">=</span> loss_diff_set<span class="token punctuation">[</span>loss<span class="token punctuation">]</span>        self<span class="token punctuation">.</span>__loss_name <span class="token operator">=</span> loss    <span class="token keyword">def</span> <span class="token function">fit</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">:</span> np<span class="token punctuation">.</span>ndarray<span class="token punctuation">,</span> y<span class="token punctuation">:</span> np<span class="token punctuation">.</span>ndarray<span class="token punctuation">,</span> batch_size<span class="token punctuation">:</span> int <span class="token operator">=</span> <span class="token number">128</span><span class="token punctuation">,</span> epochs<span class="token punctuation">:</span> int <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># Check network parameters</span>        <span class="token keyword">assert</span> self<span class="token punctuation">.</span>__depth <span class="token operator">></span> <span class="token number">0</span>        <span class="token keyword">assert</span> self<span class="token punctuation">.</span>__loss_func <span class="token keyword">is</span> <span class="token operator">not</span> None        <span class="token keyword">assert</span> self<span class="token punctuation">.</span>__loss_diff_func <span class="token keyword">is</span> <span class="token operator">not</span> None        <span class="token comment" spellcheck="true"># Check input parameters</span>        <span class="token keyword">assert</span> len<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">and</span> len<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">==</span> len<span class="token punctuation">(</span>y<span class="token punctuation">)</span>        <span class="token keyword">assert</span> batch_size <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">and</span> epochs <span class="token operator">></span> <span class="token number">0</span>        <span class="token comment" spellcheck="true"># Train using mini-batch</span>        <span class="token keyword">for</span> epoch_i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> epochs <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>            loss_sum <span class="token operator">=</span> <span class="token number">0</span>            x<span class="token punctuation">,</span> y <span class="token operator">=</span> shuffle2<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>            <span class="token keyword">for</span> x_batch<span class="token punctuation">,</span> y_batch <span class="token keyword">in</span> batch<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> batch_size<span class="token punctuation">)</span><span class="token punctuation">:</span>                y_pred <span class="token operator">=</span> self<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>x_batch<span class="token punctuation">)</span>                loss_batch <span class="token operator">=</span> self<span class="token punctuation">.</span>__loss_func<span class="token punctuation">(</span>y_pred<span class="token punctuation">,</span> y_batch<span class="token punctuation">)</span>                loss_sum <span class="token operator">+=</span> loss_batch                <span class="token comment" spellcheck="true"># print("Loss for this batch is {}".format(loss_batch))</span>                <span class="token keyword">if</span> self<span class="token punctuation">.</span>__loss_name <span class="token operator">==</span> <span class="token string">'cross entropy'</span><span class="token punctuation">:</span>                    grad <span class="token operator">=</span> y_pred <span class="token operator">-</span> y_batch                    grad <span class="token operator">=</span> self<span class="token punctuation">.</span>__layers<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>back_propagation<span class="token punctuation">(</span>grad<span class="token punctuation">,</span> after_act<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>                <span class="token keyword">else</span><span class="token punctuation">:</span>                    grad <span class="token operator">=</span> self<span class="token punctuation">.</span>__loss_diff_func<span class="token punctuation">(</span>y_pred<span class="token punctuation">,</span> y<span class="token punctuation">)</span>                    grad <span class="token operator">=</span> self<span class="token punctuation">.</span>__layers<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>back_propagation<span class="token punctuation">(</span>grad<span class="token punctuation">)</span>                <span class="token keyword">for</span> layer <span class="token keyword">in</span> self<span class="token punctuation">.</span>__layers<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span>                    layer<span class="token punctuation">.</span>back_propagation<span class="token punctuation">(</span>grad<span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Total loss for epoch {}: {}, time cost: {} secs."</span>                  <span class="token punctuation">.</span>format<span class="token punctuation">(</span>epoch_i<span class="token punctuation">,</span> loss_sum<span class="token punctuation">,</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">predict</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">:</span> np<span class="token punctuation">.</span>ndarray<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> layer <span class="token keyword">in</span> self<span class="token punctuation">.</span>__layers<span class="token punctuation">:</span>            x <span class="token operator">=</span> layer<span class="token punctuation">.</span>feed_forward<span class="token punctuation">(</span>x<span class="token punctuation">)</span>        <span class="token keyword">return</span> x    <span class="token keyword">def</span> <span class="token function">evaluate</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">:</span> np<span class="token punctuation">.</span>ndarray<span class="token punctuation">,</span> y<span class="token punctuation">:</span> np<span class="token punctuation">.</span>ndarray<span class="token punctuation">)</span><span class="token punctuation">:</span>        y_pred <span class="token operator">=</span> self<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>x<span class="token punctuation">)</span>        index_pred <span class="token operator">=</span> y_pred<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>        compare <span class="token operator">=</span> y<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">-</span> index_pred        <span class="token keyword">return</span> self<span class="token punctuation">.</span>__loss_func<span class="token punctuation">(</span>y_pred<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>len<span class="token punctuation">(</span>y<span class="token punctuation">)</span> <span class="token operator">-</span> np<span class="token punctuation">.</span>count_nonzero<span class="token punctuation">(</span>compare<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> len<span class="token punctuation">(</span>x<span class="token punctuation">)</span>    @property    <span class="token keyword">def</span> <span class="token function">depth</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>__depth    @property    <span class="token keyword">def</span> <span class="token function">in_dim</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>__in_dim    @property    <span class="token keyword">def</span> <span class="token function">out_dim</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>__out_dim<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>说实话搞明白反向传播的逻辑花了我很长时间……终于能够做的差不多了。对mini-batch也有更深入的了解。</p><p>batch是全部梯度计算后用平均值更新一次，stochastic是随机取梯度更新，mini-batch是通用的操作，取一小个batch的结果进行平均后更新。</p><p>公式推导如果有时间再补上。</p><h3 id="待补充和修改的点"><a href="#待补充和修改的点" class="headerlink" title="待补充和修改的点"></a>待补充和修改的点</h3><ul><li>实现adam算法，自适应调整学习率</li></ul><p>（待续）</p>]]></content>
      
      
      <categories>
          
          <category> machine learning </category>
          
      </categories>
      
      
        <tags>
            
            <tag> deep learning </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>面试所感</title>
      <link href="/Thoughts-about-interview/"/>
      <url>/Thoughts-about-interview/</url>
      
        <content type="html"><![CDATA[<p>这些天经历了很多面试，另一方面自己也有很多事情要做，有点感想。</p><a id="more"></a><h3 id="集中精力"><a href="#集中精力" class="headerlink" title="集中精力"></a>集中精力</h3><p>下午又双错过了阿里的电话……我保证手机不设静音了。</p><p>闲话少说，最大的收获是一个警告：集中精力在最擅长的领域。</p><p>做过前端，做过后端，做过iOS，小程序也玩一下，确实有点说头；然而杂七杂八的项目还不如找一个钻得深入。目前来看，我的简历和技能确实没有什么亮点。</p><p>然后一问Java，一问Python，问点计网，数据库，操作系统，算法也考一下。</p><p>学过但是记不住，学过但是基础不扎实。</p><blockquote><p>过去没学会的东西，现在要付出代价了。</p></blockquote><p>还好现在提前体验了面试的强度和问题的难度，不至于在毕业校招的时候才开眼看世界。</p><p>于是最终下定决心读研了。</p><h3 id="戒骄戒躁"><a href="#戒骄戒躁" class="headerlink" title="戒骄戒躁"></a>戒骄戒躁</h3><p>另一方面，机会确实很多——在这个互联网的红利还没有被吃光的日子里，可以说程序员还是混的最不差的那批人之一。在学校里可以比赛，做研究，写点开源的项目，甚至博客，都是提升自己的方式。</p><p>但是盲目地抓取手边的机会以求证明自己的勇气，其实反而不是智慧的做法。</p><p>脚踏实地一点，认识和熟悉自己，找到自己的真正所长，然后做深入下去。静静地等待机会，然后毫不犹豫地抓住。认真应对生活吧。</p><p>要相信：活着就会有好事发生。就是看你是不是能够等到那一刻了。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ML学习日记7——自己实现一个神经网络（1）</title>
      <link href="/ML-7-My-Neuron-Network-Model/"/>
      <url>/ML-7-My-Neuron-Network-Model/</url>
      
        <content type="html"><![CDATA[<p>仿照keras的api，自己实现一个最简单的全连接神经网络。</p><p>支持特性：</p><ul><li>多种激活函数（sigmoid, tanh, relu, softmax）</li><li>多种损失函数（cross entropy, mean square error, mean absolute error）</li><li>小批量梯度下降</li></ul><h3 id="设计思路"><a href="#设计思路" class="headerlink" title="设计思路"></a>设计思路</h3><p>首先，按照基本定义将设计划分成3个类：Neuron，Layer以及Model，层层递进。</p><p>随机打乱并分成mini-batch的函数，几个常用的激活函数和损失函数以及其导数实现在Util.py中：</p><p>除了softmax比较麻烦以外，其余的激活函数和损失函数都能够简单应对一维输入（单个case）和多维输入（多个case，即一个batch）。</p><p>对softmax和cross entropy的求导为了简单起见就省略了——因为在实际使用中通常他们是连在一起求导的，这样做得出的公式非常方便（见__cross_entropy_improved函数）。</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span class="token keyword">from</span> tqdm <span class="token keyword">import</span> tqdm<span class="token comment" spellcheck="true"># Shuffle 2 arrays and return.</span><span class="token keyword">def</span> <span class="token function">shuffle2</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> np<span class="token punctuation">.</span>ndarray<span class="token punctuation">,</span> y<span class="token punctuation">:</span> np<span class="token punctuation">.</span>ndarray<span class="token punctuation">)</span><span class="token punctuation">:</span>    index <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> len<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>    np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>shuffle<span class="token punctuation">(</span>index<span class="token punctuation">)</span>    <span class="token keyword">return</span> x<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">,</span> y<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># Make batches.</span><span class="token comment" spellcheck="true"># Add a progress bar to visualize the process.</span><span class="token keyword">def</span> <span class="token function">batch</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> np<span class="token punctuation">.</span>ndarray<span class="token punctuation">,</span> y<span class="token punctuation">:</span> np<span class="token punctuation">.</span>ndarray<span class="token punctuation">,</span> size<span class="token punctuation">:</span> int<span class="token punctuation">)</span><span class="token punctuation">:</span>    start<span class="token punctuation">,</span> end <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> len<span class="token punctuation">(</span>x<span class="token punctuation">)</span>    p <span class="token operator">=</span> tqdm<span class="token punctuation">(</span>total<span class="token operator">=</span>end <span class="token operator">//</span> size <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>    <span class="token keyword">while</span> start <span class="token operator">&lt;</span> end<span class="token punctuation">:</span>        curr <span class="token operator">=</span> min<span class="token punctuation">(</span><span class="token punctuation">[</span>start <span class="token operator">+</span> size<span class="token punctuation">,</span> end<span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">yield</span> x<span class="token punctuation">[</span>start<span class="token punctuation">:</span>curr<span class="token punctuation">]</span><span class="token punctuation">,</span> y<span class="token punctuation">[</span>start<span class="token punctuation">:</span>curr<span class="token punctuation">]</span>        p<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>        start <span class="token operator">=</span> curr    p<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># Activation functions.</span><span class="token comment" spellcheck="true"># Input an array</span><span class="token comment" spellcheck="true"># Returns an array.</span><span class="token keyword">def</span> <span class="token function">__sigmoid</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> np<span class="token punctuation">.</span>ndarray<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment" spellcheck="true"># sigmoid</span>    <span class="token keyword">return</span> <span class="token number">1.0</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">1.0</span> <span class="token operator">+</span> np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">__tanh</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> np<span class="token punctuation">.</span>ndarray<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment" spellcheck="true"># tanh</span>    <span class="token keyword">return</span> <span class="token number">2</span> <span class="token operator">*</span> __sigmoid<span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> x<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token keyword">def</span> <span class="token function">__relu</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> np<span class="token punctuation">.</span>ndarray<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment" spellcheck="true"># relu</span>    <span class="token keyword">return</span> np<span class="token punctuation">.</span>where<span class="token punctuation">(</span>x <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">__softmax</span><span class="token punctuation">(</span>x<span class="token punctuation">:</span> np<span class="token punctuation">.</span>ndarray<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment" spellcheck="true"># softmax</span>    <span class="token keyword">if</span> len<span class="token punctuation">(</span>x<span class="token punctuation">.</span>shape<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">:</span>  <span class="token comment" spellcheck="true"># 2-d</span>        _max <span class="token operator">=</span> x<span class="token punctuation">.</span>max<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            x<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span>x<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> _max<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>            x<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">/=</span> np<span class="token punctuation">.</span>sum<span class="token punctuation">(</span>x<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> x    <span class="token keyword">else</span><span class="token punctuation">:</span>  <span class="token comment" spellcheck="true"># 1-d</span>        _max <span class="token operator">=</span> max<span class="token punctuation">(</span>x<span class="token punctuation">)</span>        x <span class="token operator">=</span> np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span>x <span class="token operator">-</span> _max<span class="token punctuation">)</span>        <span class="token keyword">return</span> x <span class="token operator">/</span> np<span class="token punctuation">.</span>sum<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># derivatives of activation functions.</span><span class="token comment" spellcheck="true"># Input an array.</span><span class="token comment" spellcheck="true"># Returns an array.</span><span class="token keyword">def</span> <span class="token function">__sigmoid_diff</span><span class="token punctuation">(</span>y<span class="token punctuation">:</span> np<span class="token punctuation">.</span>ndarray<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment" spellcheck="true"># derivative of sigmoid</span>    _tmp <span class="token operator">=</span> __sigmoid<span class="token punctuation">(</span>y<span class="token punctuation">)</span>    <span class="token keyword">return</span> _tmp <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> _tmp<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">__tanh_diff</span><span class="token punctuation">(</span>y<span class="token punctuation">:</span> np<span class="token punctuation">.</span>ndarray<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment" spellcheck="true"># derivative of tanh</span>    <span class="token keyword">return</span> <span class="token number">1</span> <span class="token operator">-</span> __tanh<span class="token punctuation">(</span>y<span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">2</span><span class="token keyword">def</span> <span class="token function">__relu_diff</span><span class="token punctuation">(</span>y<span class="token punctuation">:</span> np<span class="token punctuation">.</span>ndarray<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment" spellcheck="true"># derivative of relu</span>    <span class="token keyword">return</span> np<span class="token punctuation">.</span>where<span class="token punctuation">(</span>y <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># This part is a little different from other derivatives.</span><span class="token comment" spellcheck="true"># Use Jacobian method... actually this part of code won't be executed.</span><span class="token keyword">def</span> <span class="token function">__softmax_diff</span><span class="token punctuation">(</span>y<span class="token punctuation">:</span> np<span class="token punctuation">.</span>ndarray<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment" spellcheck="true"># derivative of softmax</span>    <span class="token keyword">pass</span>    <span class="token comment" spellcheck="true"># _tmp = y.reshape(-1, 1)</span>    <span class="token comment" spellcheck="true"># return np.diagflat(_tmp) - np.dot(_tmp, _tmp.T)</span><span class="token comment" spellcheck="true"># Loss functions.</span><span class="token comment" spellcheck="true"># Returns a float.</span><span class="token keyword">def</span> <span class="token function">__cross_entropy</span><span class="token punctuation">(</span>y_pred<span class="token punctuation">:</span> np<span class="token punctuation">.</span>ndarray<span class="token punctuation">,</span> y<span class="token punctuation">:</span> np<span class="token punctuation">.</span>ndarray<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment" spellcheck="true"># cross entropy</span>    <span class="token keyword">return</span> <span class="token operator">-</span>np<span class="token punctuation">.</span>sum<span class="token punctuation">(</span>y <span class="token operator">*</span> np<span class="token punctuation">.</span>log<span class="token punctuation">(</span>y_pred<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">__mean_square_error</span><span class="token punctuation">(</span>y_pred<span class="token punctuation">:</span> np<span class="token punctuation">.</span>ndarray<span class="token punctuation">,</span> y<span class="token punctuation">:</span> np<span class="token punctuation">.</span>ndarray<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment" spellcheck="true"># mean square err</span>    <span class="token keyword">return</span> np<span class="token punctuation">.</span>square<span class="token punctuation">(</span>y_pred <span class="token operator">-</span> y<span class="token punctuation">)</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">__mean_absolute_error</span><span class="token punctuation">(</span>y_pred<span class="token punctuation">:</span> np<span class="token punctuation">.</span>ndarray<span class="token punctuation">,</span> y<span class="token punctuation">:</span> np<span class="token punctuation">.</span>ndarray<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment" spellcheck="true"># mean abs err</span>    <span class="token keyword">return</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>np<span class="token punctuation">.</span>abs<span class="token punctuation">(</span>y_pred <span class="token operator">-</span> y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># Derivatives of loss functions.</span><span class="token comment" spellcheck="true"># I didn't do this part because it will be improved..</span><span class="token keyword">def</span> <span class="token function">__cross_entropy_diff</span><span class="token punctuation">(</span>y_pred<span class="token punctuation">:</span> np<span class="token punctuation">.</span>ndarray<span class="token punctuation">,</span> y<span class="token punctuation">:</span> np<span class="token punctuation">.</span>ndarray<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">pass</span><span class="token keyword">def</span> <span class="token function">__cross_entropy_improved</span><span class="token punctuation">(</span>y_pred<span class="token punctuation">:</span> np<span class="token punctuation">.</span>ndarray<span class="token punctuation">,</span> y<span class="token punctuation">:</span> np<span class="token punctuation">.</span>ndarray<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> y_pred <span class="token operator">-</span> y<span class="token keyword">def</span> <span class="token function">__mean_square_error_diff</span><span class="token punctuation">(</span>y_pred<span class="token punctuation">:</span> np<span class="token punctuation">.</span>ndarray<span class="token punctuation">,</span> y<span class="token punctuation">:</span> np<span class="token punctuation">.</span>ndarray<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token punctuation">(</span>y_pred <span class="token operator">-</span> y<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">__mean_absolute_error_diff</span><span class="token punctuation">(</span>y_pred<span class="token punctuation">:</span> np<span class="token punctuation">.</span>ndarray<span class="token punctuation">,</span> y<span class="token punctuation">:</span> np<span class="token punctuation">.</span>ndarray<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> np<span class="token punctuation">.</span>where<span class="token punctuation">(</span>y_pred <span class="token operator">></span> y<span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># Activation function set</span>act_set <span class="token operator">=</span> <span class="token punctuation">{</span>    <span class="token string">"sigmoid"</span><span class="token punctuation">:</span> __sigmoid<span class="token punctuation">,</span>    <span class="token string">"relu"</span><span class="token punctuation">:</span> __relu<span class="token punctuation">,</span>    <span class="token string">"tanh"</span><span class="token punctuation">:</span> __tanh<span class="token punctuation">,</span>    <span class="token string">"softmax"</span><span class="token punctuation">:</span> __softmax<span class="token punctuation">,</span>    <span class="token string">"none"</span><span class="token punctuation">:</span> <span class="token keyword">lambda</span> res<span class="token punctuation">:</span> res<span class="token punctuation">}</span><span class="token comment" spellcheck="true"># derivatives set of activation functions</span>act_diff_set <span class="token operator">=</span> <span class="token punctuation">{</span>    <span class="token string">"sigmoid"</span><span class="token punctuation">:</span> __sigmoid_diff<span class="token punctuation">,</span>    <span class="token string">"tanh"</span><span class="token punctuation">:</span> __tanh_diff<span class="token punctuation">,</span>    <span class="token string">"relu"</span><span class="token punctuation">:</span> __relu_diff<span class="token punctuation">,</span>    <span class="token string">"softmax"</span><span class="token punctuation">:</span> __softmax_diff<span class="token punctuation">,</span>    <span class="token string">"none"</span><span class="token punctuation">:</span> <span class="token keyword">lambda</span> res<span class="token punctuation">:</span> res<span class="token punctuation">}</span><span class="token comment" spellcheck="true"># Loss function set</span>loss_set <span class="token operator">=</span> <span class="token punctuation">{</span>    <span class="token string">"ce"</span><span class="token punctuation">:</span> __cross_entropy<span class="token punctuation">,</span>    <span class="token string">"mse"</span><span class="token punctuation">:</span> __mean_square_error<span class="token punctuation">,</span>    <span class="token string">"mae"</span><span class="token punctuation">:</span> __mean_absolute_error<span class="token punctuation">}</span><span class="token comment" spellcheck="true"># derivatives set of loss functions</span>loss_diff_set <span class="token operator">=</span> <span class="token punctuation">{</span>    <span class="token string">"ce"</span><span class="token punctuation">:</span> __cross_entropy_diff<span class="token punctuation">,</span>    <span class="token string">"ce_i"</span><span class="token punctuation">:</span> __cross_entropy_improved<span class="token punctuation">,</span>    <span class="token string">"mse"</span><span class="token punctuation">:</span> __mean_square_error_diff<span class="token punctuation">,</span>    <span class="token string">"mae"</span><span class="token punctuation">:</span> __mean_absolute_error_diff<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="神经元Neuron"><a href="#神经元Neuron" class="headerlink" title="神经元Neuron"></a>神经元Neuron</h4><ul><li><p>变量：线性参数w和b</p></li><li><p>方法：向前传播foward，和向后传播backward</p></li></ul><p>前向传播中，x是一整个batch的输入。</p><p>后向传播中，diff_w和diff_b取batch中所有的平均值；采用adagrad约束学习率大小（全局率为0.3）；</p><p>并返回当前梯度乘参数w（取<strong>更新前</strong>的w，才是准确梯度）</p><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># Class of a neuron.</span><span class="token comment" spellcheck="true"># Use adagrad in gradient discent.</span><span class="token keyword">class</span> <span class="token class-name">Neuron</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> n<span class="token punctuation">:</span> int<span class="token punctuation">,</span> learn_rate<span class="token punctuation">:</span> float <span class="token operator">=</span> <span class="token number">0.3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>__w <span class="token operator">=</span> np<span class="token punctuation">.</span>ones<span class="token punctuation">(</span>n<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>__b <span class="token operator">=</span> <span class="token number">1.0</span>        self<span class="token punctuation">.</span>__rate <span class="token operator">=</span> learn_rate        self<span class="token punctuation">.</span>__grad_sum <span class="token operator">=</span> <span class="token number">1.0</span>    <span class="token comment" spellcheck="true"># Calculate forward results for a batch.</span>    <span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">:</span> np<span class="token punctuation">.</span>ndarray<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> np<span class="token punctuation">.</span>matmul<span class="token punctuation">(</span>x<span class="token punctuation">,</span> self<span class="token punctuation">.</span>__w<span class="token punctuation">)</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>__b    <span class="token comment" spellcheck="true"># Update parameters for a batch.</span>    <span class="token comment" spellcheck="true"># Grad_batch: n * 1 array, grad for all case in a batch.</span>    <span class="token comment" spellcheck="true"># X: n * 1 array, mean of a mini-batch.</span>    <span class="token comment" spellcheck="true"># Returns grad for previous layer.</span>    <span class="token keyword">def</span> <span class="token function">backward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> grad_batch<span class="token punctuation">:</span> np<span class="token punctuation">.</span>ndarray<span class="token punctuation">,</span> x<span class="token punctuation">:</span> np<span class="token punctuation">.</span>ndarray<span class="token punctuation">)</span><span class="token punctuation">:</span>        m <span class="token operator">=</span> len<span class="token punctuation">(</span>x<span class="token punctuation">)</span>        res <span class="token operator">=</span> np<span class="token punctuation">.</span>outer<span class="token punctuation">(</span>grad_batch<span class="token punctuation">,</span> self<span class="token punctuation">.</span>__w<span class="token punctuation">)</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>__grad_sum <span class="token operator">+=</span> grad_batch<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">**</span> <span class="token number">2</span>            curr_rate <span class="token operator">=</span> self<span class="token punctuation">.</span>__rate <span class="token operator">/</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>self<span class="token punctuation">.</span>__grad_sum<span class="token punctuation">)</span>            self<span class="token punctuation">.</span>__w <span class="token operator">-=</span> curr_rate <span class="token operator">*</span> grad_batch<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> x<span class="token punctuation">[</span>i<span class="token punctuation">]</span>            self<span class="token punctuation">.</span>__b <span class="token operator">-=</span> curr_rate <span class="token operator">*</span> grad_batch<span class="token punctuation">[</span>i<span class="token punctuation">]</span>        <span class="token keyword">return</span> res        <span class="token comment" spellcheck="true"># m, diff_w = len(x), np.zeros(self.__w.shape)</span>        <span class="token comment" spellcheck="true"># res = np.outer(grad_batch, self.__w)</span>        <span class="token comment" spellcheck="true"># for i in range(m):</span>        <span class="token comment" spellcheck="true">#     diff_w -= grad_batch[i] * x[i]</span>        <span class="token comment" spellcheck="true">#</span>        <span class="token comment" spellcheck="true"># # diff_w is mean of grad * x for each case xi.</span>        <span class="token comment" spellcheck="true"># # diff_b is mean of grad * 2</span>        <span class="token comment" spellcheck="true"># diff_w /= m</span>        <span class="token comment" spellcheck="true"># diff_b = grad_batch.sum() * -1.0</span>        <span class="token comment" spellcheck="true">#</span>        <span class="token comment" spellcheck="true"># # Use mean of grad_batch as the grad for this batch.</span>        <span class="token comment" spellcheck="true"># grad = diff_b / m</span>        <span class="token comment" spellcheck="true"># diff_b = 2 * grad</span>        <span class="token comment" spellcheck="true">#</span>        <span class="token comment" spellcheck="true"># # Use adagrad to optimize learning rate.</span>        <span class="token comment" spellcheck="true"># self.__grad_sum += grad ** 2</span>        <span class="token comment" spellcheck="true"># curr_rate = self.__rate / np.sqrt(self.__grad_sum)</span>        <span class="token comment" spellcheck="true"># self.__w -= curr_rate * diff_w</span>        <span class="token comment" spellcheck="true"># self.__b -= curr_rate * diff_b</span>        <span class="token comment" spellcheck="true"># # Return grads for previous layer.</span>        <span class="token comment" spellcheck="true"># return res</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="层Layer"><a href="#层Layer" class="headerlink" title="层Layer"></a>层Layer</h4><ul><li>变量：存储神经元，输入和输出大小，当前输入的batch（用于计算后向传播梯度）</li><li>方法：前向传播和后向传播以外，还有一些属性（property），方便在Model类获取。</li></ul><p>在后向传播的时候，如果不是最后一层那么就先经过激活函数的导数，再传入各个神经元，获得前一层的梯度；</p><p>但是如果在最后一层且使用的激活函数和损失函数是softmax和cross entropy的组合，那么就设置参数improved=True，详见代码：</p><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># Class of a layer.</span><span class="token comment" spellcheck="true"># Stores neurons.</span><span class="token comment" spellcheck="true"># Activation functions: sigmoid(default), relu, tanh, softmax are supported.</span><span class="token comment" spellcheck="true"># Keep the mean of input data for mini-batch calculation.</span><span class="token keyword">class</span> <span class="token class-name">Layer</span><span class="token punctuation">:</span>    __input<span class="token punctuation">:</span> np<span class="token punctuation">.</span>ndarray    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> in_dim<span class="token punctuation">:</span> int<span class="token punctuation">,</span> out_dim<span class="token punctuation">:</span> int<span class="token punctuation">,</span> activation<span class="token punctuation">:</span> str<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>__in_dim<span class="token punctuation">,</span> self<span class="token punctuation">.</span>__out_dim<span class="token punctuation">,</span> self<span class="token punctuation">.</span>__input <span class="token operator">=</span> in_dim<span class="token punctuation">,</span> out_dim<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        self<span class="token punctuation">.</span>__neurons <span class="token operator">=</span> <span class="token punctuation">[</span>Neuron<span class="token punctuation">(</span>in_dim<span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> range<span class="token punctuation">(</span>out_dim<span class="token punctuation">)</span><span class="token punctuation">]</span>        <span class="token keyword">assert</span> activation <span class="token keyword">in</span> act_set        self<span class="token punctuation">.</span>__act <span class="token operator">=</span> act_set<span class="token punctuation">[</span>activation<span class="token punctuation">]</span>        self<span class="token punctuation">.</span>__act_diff <span class="token operator">=</span> act_diff_set<span class="token punctuation">[</span>activation<span class="token punctuation">]</span>    <span class="token comment" spellcheck="true"># Calculate the forward results for a batch.</span>    <span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">:</span> np<span class="token punctuation">.</span>ndarray<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>__input <span class="token operator">=</span> x        res <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>n<span class="token punctuation">.</span>forward<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">for</span> n <span class="token keyword">in</span> self<span class="token punctuation">.</span>__neurons<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>T        <span class="token keyword">return</span> self<span class="token punctuation">.</span>__act<span class="token punctuation">(</span>res<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># Update parameters for a batch.</span>    <span class="token comment" spellcheck="true"># Grad_batch: n * 1 array.</span>    <span class="token comment" spellcheck="true"># Returns grad_batch for previous layer.</span>    <span class="token keyword">def</span> <span class="token function">backward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> grad_batch<span class="token punctuation">:</span> np<span class="token punctuation">.</span>ndarray<span class="token punctuation">,</span> improved<span class="token punctuation">:</span> bool <span class="token operator">=</span> <span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># When improved = True, grad = softmax + ce, so we don't calculate act_diff</span>        <span class="token keyword">if</span> <span class="token operator">not</span> improved<span class="token punctuation">:</span>            grad_batch <span class="token operator">=</span> self<span class="token punctuation">.</span>__act_diff<span class="token punctuation">(</span>grad_batch<span class="token punctuation">)</span>        res <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>len<span class="token punctuation">(</span>grad_batch<span class="token punctuation">)</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>__in_dim<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># grad_batch: each row is the gradients for case xi.</span>        <span class="token comment" spellcheck="true"># After transpose, each row is the gradient for neuron i.</span>        grad_batch <span class="token operator">=</span> grad_batch<span class="token punctuation">.</span>T        <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>self<span class="token punctuation">.</span>__out_dim<span class="token punctuation">)</span><span class="token punctuation">:</span>            res <span class="token operator">+=</span> self<span class="token punctuation">.</span>__neurons<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>backward<span class="token punctuation">(</span>grad_batch<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>__input<span class="token punctuation">)</span>        <span class="token keyword">return</span> res    @property    <span class="token keyword">def</span> <span class="token function">in_dim</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>__in_dim    @property    <span class="token keyword">def</span> <span class="token function">out_dim</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>__out_dim    @property    <span class="token keyword">def</span> <span class="token function">activation</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>__act<span class="token punctuation">.</span>__name__<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="模型Model"><a href="#模型Model" class="headerlink" title="模型Model"></a>模型Model</h4><ul><li>变量：存储每一层，当前层数，以及模型的输入和输出大小。</li><li>方法：加入层、减少层，编译（其实是配置损失函数），拟合，预测 ，评估，以及几个只读属性的获取。</li></ul><p>拟合的时候，batch_size一般是2的倍数（因为GPU的核数如此）在16～256间不等；epochs选10～20会比较稳定。</p><p>但是我没有做多核优化，那其实随意了……反正都是一样慢。</p><p>参数校验使用了一堆assert，其余内容详见代码：</p><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># Class of a model.</span><span class="token comment" spellcheck="true"># Stores layers.</span><span class="token keyword">class</span> <span class="token class-name">Model</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>__layers<span class="token punctuation">,</span> self<span class="token punctuation">.</span>__depth <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">0</span>        self<span class="token punctuation">.</span>__loss<span class="token punctuation">,</span> self<span class="token punctuation">.</span>__loss_diff <span class="token operator">=</span> None<span class="token punctuation">,</span> None    <span class="token comment" spellcheck="true"># Add one layer.</span>    <span class="token comment" spellcheck="true"># Input dimension of first layer should be explicitly specified.</span>    <span class="token comment" spellcheck="true"># Input dimension of other layers may be omitted.</span>    <span class="token comment" spellcheck="true"># Activation function: see definition of Layer.</span>    <span class="token keyword">def</span> <span class="token function">add_layer</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> out_dim<span class="token punctuation">:</span> int<span class="token punctuation">,</span> in_dim<span class="token punctuation">:</span> int <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> activation<span class="token punctuation">:</span> str <span class="token operator">=</span> <span class="token string">"none"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># Input dimension for first layer should be specified.</span>        <span class="token keyword">if</span> self<span class="token punctuation">.</span>__depth <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>            <span class="token keyword">assert</span> in_dim <span class="token operator">></span> <span class="token number">0</span>            <span class="token comment" spellcheck="true"># Set current output dim = input dim of layer 0.</span>            self<span class="token punctuation">.</span>__out_dim <span class="token operator">=</span> in_dim            self<span class="token punctuation">.</span>__in_dim <span class="token operator">=</span> in_dim        <span class="token comment" spellcheck="true"># -1 means auto decide the input dimension.</span>        <span class="token keyword">if</span> in_dim <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>            in_dim <span class="token operator">=</span> self<span class="token punctuation">.</span>__out_dim        <span class="token comment" spellcheck="true"># Input dimension for other layers should be equal to out dim.</span>        <span class="token keyword">assert</span> in_dim <span class="token operator">==</span> self<span class="token punctuation">.</span>__out_dim        <span class="token comment" spellcheck="true"># Add layer.</span>        self<span class="token punctuation">.</span>__layers<span class="token punctuation">.</span>append<span class="token punctuation">(</span>Layer<span class="token punctuation">(</span>in_dim<span class="token punctuation">,</span> out_dim<span class="token punctuation">,</span> activation<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>__depth <span class="token operator">+=</span> <span class="token number">1</span>        self<span class="token punctuation">.</span>__out_dim <span class="token operator">=</span> out_dim    <span class="token comment" spellcheck="true"># Remove layer at a certain index.</span>    <span class="token keyword">def</span> <span class="token function">remove_layer</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> index<span class="token punctuation">:</span> int <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># Check whether there are layers to remove.</span>        <span class="token keyword">assert</span> self<span class="token punctuation">.</span>__depth <span class="token operator">></span> <span class="token number">0</span>        <span class="token keyword">assert</span> index <span class="token operator">&lt;</span> len<span class="token punctuation">(</span>self<span class="token punctuation">.</span>__layers<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>__depth <span class="token operator">-=</span> <span class="token number">1</span>        <span class="token keyword">del</span> self<span class="token punctuation">.</span>__layers<span class="token punctuation">[</span>index<span class="token punctuation">]</span>        self<span class="token punctuation">.</span>__out_dim <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">if</span> self<span class="token punctuation">.</span>__depth <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">else</span> self<span class="token punctuation">.</span>__layers<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>out_dim        self<span class="token punctuation">.</span>__in_dim <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">if</span> self<span class="token punctuation">.</span>__depth <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">else</span> self<span class="token punctuation">.</span>__layers<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>in_dim    <span class="token comment" spellcheck="true"># Configure the loss function: cross entropy, mean square / abs error, etc.</span>    <span class="token comment" spellcheck="true"># Configure the method: regression or classification (TODO)</span>    <span class="token keyword">def</span> <span class="token function">compile</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> loss<span class="token punctuation">:</span> str <span class="token operator">=</span> <span class="token string">"ce"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># Check name of loss function.</span>        <span class="token keyword">assert</span> loss <span class="token keyword">in</span> loss_set        <span class="token comment" spellcheck="true"># Configure the loss function</span>        self<span class="token punctuation">.</span>__loss <span class="token operator">=</span> loss_set<span class="token punctuation">[</span>loss<span class="token punctuation">]</span>        self<span class="token punctuation">.</span>__loss_diff <span class="token operator">=</span> loss_diff_set<span class="token punctuation">[</span>loss<span class="token punctuation">]</span>    <span class="token comment" spellcheck="true"># Train the data using Mini-Batch Gradient Descent:</span>    <span class="token comment" spellcheck="true"># update parameters for one time in a batch.</span>    <span class="token comment" spellcheck="true"># Batch-size and epochs may be specified.</span>    <span class="token keyword">def</span> <span class="token function">fit</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">:</span> np<span class="token punctuation">.</span>ndarray<span class="token punctuation">,</span> y<span class="token punctuation">:</span> np<span class="token punctuation">.</span>ndarray<span class="token punctuation">,</span> batch_size<span class="token punctuation">:</span> int <span class="token operator">=</span> <span class="token number">128</span><span class="token punctuation">,</span> epochs<span class="token punctuation">:</span> int <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># Check whether the loss function is configured for model.</span>        <span class="token keyword">assert</span> self<span class="token punctuation">.</span>__loss <span class="token keyword">is</span> <span class="token operator">not</span> None <span class="token operator">and</span> self<span class="token punctuation">.</span>__loss_diff <span class="token keyword">is</span> <span class="token operator">not</span> None        <span class="token comment" spellcheck="true"># Check if the model is empty.</span>        <span class="token keyword">assert</span> self<span class="token punctuation">.</span>__depth <span class="token operator">></span> <span class="token number">0</span>        <span class="token comment" spellcheck="true"># Check the validity of parameters.</span>        <span class="token keyword">assert</span> len<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">==</span> len<span class="token punctuation">(</span>y<span class="token punctuation">)</span>        <span class="token keyword">assert</span> self<span class="token punctuation">.</span>__out_dim <span class="token operator">==</span> len<span class="token punctuation">(</span>y<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">and</span> self<span class="token punctuation">.</span>__in_dim <span class="token operator">==</span> len<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">assert</span> batch_size <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">and</span> epochs <span class="token operator">></span> <span class="token number">0</span>        <span class="token comment" spellcheck="true"># Improve the process for ce after softmax.</span>        improved <span class="token operator">=</span> <span class="token boolean">False</span>        <span class="token keyword">if</span> self<span class="token punctuation">.</span>loss_name <span class="token operator">==</span> <span class="token string">"cross_entropy"</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> self<span class="token punctuation">.</span>__layers<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>activation <span class="token operator">==</span> <span class="token string">"softmax"</span><span class="token punctuation">:</span>                self<span class="token punctuation">.</span>__loss_diff <span class="token operator">=</span> loss_diff_set<span class="token punctuation">[</span><span class="token string">"ce_i"</span><span class="token punctuation">]</span>                improved <span class="token operator">=</span> <span class="token boolean">True</span>        <span class="token comment" spellcheck="true"># Use batches to fit: shuffle and split the data into mini batches.</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> epochs <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            x<span class="token punctuation">,</span> y <span class="token operator">=</span> shuffle2<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>            loss <span class="token operator">=</span> <span class="token number">0.0</span>            start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token keyword">for</span> x_batch<span class="token punctuation">,</span> y_batch <span class="token keyword">in</span> batch<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> batch_size<span class="token punctuation">)</span><span class="token punctuation">:</span>                y_pred <span class="token operator">=</span> self<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>x_batch<span class="token punctuation">)</span>                loss <span class="token operator">+=</span> self<span class="token punctuation">.</span>__loss<span class="token punctuation">(</span>y_pred<span class="token punctuation">,</span> y_batch<span class="token punctuation">)</span>                grad_batch <span class="token operator">=</span> self<span class="token punctuation">.</span>__loss_diff<span class="token punctuation">(</span>y_pred<span class="token punctuation">,</span> y_batch<span class="token punctuation">)</span>                <span class="token comment" spellcheck="true"># Improve the process for ce after softmax.</span>                grad_batch <span class="token operator">=</span> self<span class="token punctuation">.</span>__layers<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>backward<span class="token punctuation">(</span>grad_batch<span class="token punctuation">,</span> improved<span class="token operator">=</span>improved<span class="token punctuation">)</span>                <span class="token keyword">for</span> layer <span class="token keyword">in</span> self<span class="token punctuation">.</span>__layers<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span>                    grad_batch <span class="token operator">=</span> layer<span class="token punctuation">.</span>backward<span class="token punctuation">(</span>grad_batch<span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Total loss for epoch {}: {}, time cost: {} secs"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>i<span class="token punctuation">,</span> loss<span class="token punctuation">,</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># Calculate as a batch, not single values.</span>    <span class="token keyword">def</span> <span class="token function">predict</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">:</span> np<span class="token punctuation">.</span>ndarray<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> layer <span class="token keyword">in</span> self<span class="token punctuation">.</span>__layers<span class="token punctuation">:</span>            x <span class="token operator">=</span> layer<span class="token punctuation">.</span>forward<span class="token punctuation">(</span>x<span class="token punctuation">)</span>        <span class="token keyword">return</span> x    <span class="token comment" spellcheck="true"># Calculate accuracy.</span>    <span class="token keyword">def</span> <span class="token function">evaluate</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">:</span> np<span class="token punctuation">.</span>ndarray<span class="token punctuation">,</span> y<span class="token punctuation">:</span> np<span class="token punctuation">.</span>ndarray<span class="token punctuation">)</span><span class="token punctuation">:</span>        y_pred <span class="token operator">=</span> self<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>x<span class="token punctuation">)</span>        loss <span class="token operator">=</span> self<span class="token punctuation">.</span>__loss<span class="token punctuation">(</span>y_pred<span class="token punctuation">,</span> y<span class="token punctuation">)</span>        accuracy <span class="token operator">=</span> self<span class="token punctuation">.</span>__accuracy<span class="token punctuation">(</span>y_pred<span class="token punctuation">,</span> y<span class="token punctuation">)</span>        <span class="token keyword">return</span> loss<span class="token punctuation">,</span> accuracy    <span class="token comment" spellcheck="true"># Calculate ratio of correct predictions.</span>    <span class="token keyword">def</span> <span class="token function">__accuracy</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> y_pred<span class="token punctuation">:</span> np<span class="token punctuation">.</span>ndarray<span class="token punctuation">,</span> y<span class="token punctuation">:</span> np<span class="token punctuation">.</span>ndarray<span class="token punctuation">)</span><span class="token punctuation">:</span>        compare <span class="token operator">=</span> y_pred<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">-</span> y<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> np<span class="token punctuation">.</span>count_nonzero<span class="token punctuation">(</span>compare<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">/</span> len<span class="token punctuation">(</span>y<span class="token punctuation">)</span>    @property    <span class="token keyword">def</span> <span class="token function">depth</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>__depth    @property    <span class="token keyword">def</span> <span class="token function">in_dim</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>__in_dim    @property    <span class="token keyword">def</span> <span class="token function">out_dim</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>__out_dim    @property    <span class="token keyword">def</span> <span class="token function">loss_name</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>__loss<span class="token punctuation">.</span>__name__<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="如何运行"><a href="#如何运行" class="headerlink" title="如何运行"></a>如何运行</h4><p>以mnist为例运行一下代码。激动人心的时刻到了！</p><p>详见下文，和keras的写法差不多：</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> Model <span class="token keyword">import</span> Model<span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> mnist<span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>utils <span class="token keyword">import</span> to_categorical<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># Load data</span>    <span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>x_test<span class="token punctuation">,</span> y_test<span class="token punctuation">)</span> <span class="token operator">=</span> mnist<span class="token punctuation">.</span>load_data<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># Flatten input 28 * 28 matrix into a 784 vector</span>    x_train <span class="token operator">=</span> x_train<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>len<span class="token punctuation">(</span>x_train<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">28</span> <span class="token operator">*</span> <span class="token number">28</span><span class="token punctuation">)</span>    x_test <span class="token operator">=</span> x_test<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>len<span class="token punctuation">(</span>x_test<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">28</span> <span class="token operator">*</span> <span class="token number">28</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># Make y into one-hot encoding</span>    y_train <span class="token operator">=</span> to_categorical<span class="token punctuation">(</span>y_train<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>    y_test <span class="token operator">=</span> to_categorical<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># Build model</span>    model <span class="token operator">=</span> Model<span class="token punctuation">(</span><span class="token punctuation">)</span>    model<span class="token punctuation">.</span>add_layer<span class="token punctuation">(</span>in_dim<span class="token operator">=</span><span class="token number">28</span> <span class="token operator">*</span> <span class="token number">28</span><span class="token punctuation">,</span> out_dim<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">"sigmoid"</span><span class="token punctuation">)</span>    model<span class="token punctuation">.</span>add_layer<span class="token punctuation">(</span>out_dim<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">"sigmoid"</span><span class="token punctuation">)</span>    model<span class="token punctuation">.</span>add_layer<span class="token punctuation">(</span>out_dim<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">"softmax"</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># Compile model</span>    model<span class="token punctuation">.</span>compile<span class="token punctuation">(</span>loss<span class="token operator">=</span><span class="token string">"ce"</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># Train model</span>    model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> batch_size<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span> epochs<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># Predict and evaluate</span>    loss<span class="token punctuation">,</span> accuracy <span class="token operator">=</span> model<span class="token punctuation">.</span>evaluate<span class="token punctuation">(</span>x_test<span class="token punctuation">,</span> y_test<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Total loss for prediction: {}, accuracy: {}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>loss<span class="token punctuation">,</span> accuracy<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="加一个进度条看看"><a href="#加一个进度条看看" class="headerlink" title="加一个进度条看看"></a>加一个进度条看看</h4><p>为了明显显示出当前进度，不让人产生“这代码怎么一点反应都没有，风扇还死命转，是不是死循环了”的错觉，我决定在batch函数加一个进度条。</p><p>之所以在batch部分加进度条是为了避免其对主体部分逻辑的干扰——好吧我主体部分已经写的够乱了。</p><p>新的batch函数：（需要progressBar库）</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> Model <span class="token keyword">import</span> Model<span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> mnist<span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>utils <span class="token keyword">import</span> to_categorical<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># Load data</span>    <span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>x_test<span class="token punctuation">,</span> y_test<span class="token punctuation">)</span> <span class="token operator">=</span> mnist<span class="token punctuation">.</span>load_data<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># Flatten input 28 * 28 matrix into a 784 vector</span>    x_train <span class="token operator">=</span> x_train<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>len<span class="token punctuation">(</span>x_train<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">28</span> <span class="token operator">*</span> <span class="token number">28</span><span class="token punctuation">)</span>    x_test <span class="token operator">=</span> x_test<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>len<span class="token punctuation">(</span>x_test<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">28</span> <span class="token operator">*</span> <span class="token number">28</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># Make y into one-hot encoding</span>    y_train <span class="token operator">=</span> to_categorical<span class="token punctuation">(</span>y_train<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>    y_test <span class="token operator">=</span> to_categorical<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># Build model</span>    model <span class="token operator">=</span> Model<span class="token punctuation">(</span><span class="token punctuation">)</span>    model<span class="token punctuation">.</span>add_layer<span class="token punctuation">(</span>in_dim<span class="token operator">=</span><span class="token number">28</span> <span class="token operator">*</span> <span class="token number">28</span><span class="token punctuation">,</span> out_dim<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">"tanh"</span><span class="token punctuation">)</span>    model<span class="token punctuation">.</span>add_layer<span class="token punctuation">(</span>out_dim<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">"sigmoid"</span><span class="token punctuation">)</span>    model<span class="token punctuation">.</span>add_layer<span class="token punctuation">(</span>out_dim<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">"softmax"</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># Compile model</span>    model<span class="token punctuation">.</span>compile<span class="token punctuation">(</span>loss<span class="token operator">=</span><span class="token string">"ce"</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># Train model</span>    model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> batch_size<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span> epochs<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># Predict and evaluate</span>    loss<span class="token punctuation">,</span> accuracy <span class="token operator">=</span> model<span class="token punctuation">.</span>evaluate<span class="token punctuation">(</span>x_test<span class="token punctuation">,</span> y_test<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Total loss for prediction: {}, accuracy: {}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>loss<span class="token punctuation">,</span> accuracy<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>效果：</p><pre><code>36%|███▋      | 341/938 [03:45&lt;06:56,  1.43it/s]36%|███▋      | 342/938 [03:46&lt;06:59,  1.42it/s]</code></pre><p>需要注意在ide里面，这里的进度条不是在原地刷新显示而是在不断打印新的一行……但是在控制台执行就是原地刷新了。</p><h3 id="运行结果"><a href="#运行结果" class="headerlink" title="运行结果"></a>运行结果</h3><p>很遗憾，但目前为止都没有得到很好的结果，准确率只比初始值（10%）高一点。</p><p>可能是哪里出了什么bug，这个反向传播写的我心态不好了……</p><p>痛定思痛决定重写一次。详情看下一篇吧。</p><p>（待续）</p>]]></content>
      
      
      <categories>
          
          <category> machine learning </category>
          
      </categories>
      
      
        <tags>
            
            <tag> deep learning </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>计算机网络要点整理</title>
      <link href="/Network/"/>
      <url>/Network/</url>
      
        <content type="html"><![CDATA[<h3 id="TCP-IP——4层模型"><a href="#TCP-IP——4层模型" class="headerlink" title="TCP/IP——4层模型"></a>TCP/IP——4层模型</h3><table><thead><tr><th>应用层——数据段</th><th>FTP、TELNET、HTTP、DNS</th><th>SNMP、TFTP、NTP</th></tr></thead><tbody><tr><td>传输层——数据包</td><td>TCP</td><td>UDP</td></tr><tr><td>（核心）网络互联层——数据帧</td><td>IP、ICMP</td><td></td></tr><tr><td>主机到网络层——比特</td><td>以太网、令牌环网；ARP、RARP</td></tr></tbody></table><h3 id="OSI参考——7层模型"><a href="#OSI参考——7层模型" class="headerlink" title="OSI参考——7层模型"></a>OSI参考——7层模型</h3><p>【应用层、表示层、会话层】、【传输层】、【网络层】、【数据链路层、物理层】</p><p>【】表示对应四层协议的某一层</p><h3 id="为什么以太网层上要加一层IP网络层"><a href="#为什么以太网层上要加一层IP网络层" class="headerlink" title="为什么以太网层上要加一层IP网络层"></a>为什么以太网层上要加一层IP网络层</h3><ul><li><p>数据链路层不止是以太网——由于历史上出现多种令牌环网等，所以不一定采取MAC地址形式标示；</p></li><li><p>MAC是基于厂商而不是地理位置，所以不能缩短路由，实时更新20e的表成本很大；</p></li><li><p>历史包袱：现有的以太网只实现了点到点连接，网络层IP实现了端到端连接。</p></li></ul><p>现在基于IP的地址分配，采用了诸如子网、CIDR等等维护域间路由，减少更新成本。</p><p>或许IPv6协议之后，世界上每台机器都有唯一的编号，可能可以做到改进。</p><h3 id="为什么在IP层上加一层TCP层"><a href="#为什么在IP层上加一层TCP层" class="headerlink" title="为什么在IP层上加一层TCP层"></a>为什么在IP层上加一层TCP层</h3><ul><li>TCP提供可靠传输方式</li><li>标志主机不同进程</li></ul><p>Socket封装了TCP协议的接口可以调用。</p><h3 id="HTTP协议"><a href="#HTTP协议" class="headerlink" title="HTTP协议"></a>HTTP协议</h3><ul><li>get和post区别：内容写在请求头和请求主体；post更安全，可以避免跨站脚本攻击（CSRF）<ul><li>一般使用Token实现防御，就是关键请求需要使用特定的一次性加密Token标记。</li></ul></li><li>HEAD和BODY（可以没有body）之间有两个\r\n；可以包含多个HEAD，用一个\r\n分割。</li><li>Content-Length限制长度，或者是Transfer-Encoding: Chunked表示分块传输编码，每个块前标示块大小；而总长度未知，最后一个块长度是0，所以遇到0表示内容结束；块之间是两个\r\n。</li></ul><h4 id="MIME-TYPE"><a href="#MIME-TYPE" class="headerlink" title="MIME-TYPE"></a>MIME-TYPE</h4><pre class="line-numbers language-json"><code class="language-json">text/plaintext/htmltext/cssimage/jpegimage/pngimage/svg+xmlaudio/mp4video/mp4application/javascriptapplication/pdfapplication/zipapplication/atom+xml<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="HTTP1-0"><a href="#HTTP1-0" class="headerlink" title="HTTP1.0"></a>HTTP1.0</h4><ul><li>无状态短连接发完就关闭</li><li>声明Connection: keep-alive表示长连接</li></ul><h4 id="HTTP1-1（主流）"><a href="#HTTP1-1（主流）" class="headerlink" title="HTTP1.1（主流）"></a>HTTP1.1（主流）</h4><ul><li>HEAD编码用ASCII，BODY可以是ASCII也可以是二进制（图片视频等等）</li><li>默认长连接（主要是传输时允许复用），最后发送长度为0表示内容结束才会关闭连接。<ul><li>缺点是队头堵塞，需要服务器完全接受才能继续</li></ul></li></ul><h4 id="HTTP2-0（2015推出）"><a href="#HTTP2-0（2015推出）" class="headerlink" title="HTTP2.0（2015推出）"></a>HTTP2.0（2015推出）</h4><ul><li>多工通信，非阻塞。</li><li>HEAD加入信息压缩（Content-Encoding表示内容编码，一般是gzip）。</li><li>由于HTTP本质还是没有状态的，每次请求都会发送状态信息，所以修改成服务器和客户端共同维护cookies和user agent等重复字段的表，不需要每次都传相同信息，节约通信成本。</li><li>HTTP/2 允许服务器未经请求，主动向客户端发送资源，这叫做服务器推送（server push）。这一来就可以在空闲的时候预先把可能未来会需要的资源先发送到客户端，提高用户体验。</li></ul><h4 id="HTTPS：HTTP-over-TLS，是一种在加密信道进行-HTTP-内容传输的协议。"><a href="#HTTPS：HTTP-over-TLS，是一种在加密信道进行-HTTP-内容传输的协议。" class="headerlink" title="HTTPS：HTTP over TLS，是一种在加密信道进行 HTTP 内容传输的协议。"></a>HTTPS：HTTP over TLS，是一种在加密信道进行 HTTP 内容传输的协议。</h4><ul><li><p>TLS证书机制，CA信任链，根证书为最安全的</p></li><li><p>从上面的过程可以看到，TLS 的完整过程需要三个算法（协议），密钥交互算法，对称加密算法，和消息认证算法（TLS 的传输会使用 MAC(message authentication code) 进行完整性检查）。</p><p>我们以 Github 网站使用的 TLS 为例，使用浏览器可以看到它使用的加密为 <code>TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</code>。其中密钥交互算法是 <code>ECDHE_RSA</code>，对称加密算法是 <code>AES_128_GCM</code>，消息认证（MAC）算法为 <code>SHA256</code>。</p></li><li><p>HSTS：强制浏览器使用HTTPS协议</p></li><li><p>中间人攻击、伪造证书攻击</p></li></ul><h3 id="Socket与TCP、UDP"><a href="#Socket与TCP、UDP" class="headerlink" title="Socket与TCP、UDP"></a>Socket与TCP、UDP</h3><h4 id="Socket编程："><a href="#Socket编程：" class="headerlink" title="Socket编程："></a>Socket编程：</h4><ul><li>服务原语作为函数名，不追究底层实现：<ul><li>socket()创建套接字</li><li>bind()分配套接字地址</li><li>listen()声明接受连接和队列长度</li><li>accept()被动连接，connect()主动连接请求</li><li>read()/write()数据交换</li><li>close()关闭连接</li></ul></li><li>服务器在不断等待连接请求，如果遇到接入，那么就开一个线程处理通信；</li><li>键盘输入可以中断，pthread_cancel，取消点机制可以在循环的accept阶段（阻塞式IO）终止。</li></ul><h4 id="TCP三次握手"><a href="#TCP三次握手" class="headerlink" title="TCP三次握手"></a>TCP三次握手</h4><ul><li><p>第一次握手(SYN=1, seq=x):</p><p>客户端发送一个 TCP 的 SYN 标志位置1的包，指明客户端打算连接的服务器的端口，以及初始序号 X,保存在包头的序列号(Sequence Number)字段里。</p><p>发送完毕后，客户端进入 <code>SYN_SEND</code> 状态。</p></li><li><p>第二次握手(SYN=1, ACK=1, seq=y, ACKnum=x+1):</p><p>服务器发回确认包(ACK)应答。即 SYN 标志位和 ACK 标志位均为1。服务器端选择自己 ISN 序列号，放到 Seq 域里，同时将确认序号(Acknowledgement Number)设置为客户的 ISN 加1，即X+1。 发送完毕后，服务器端进入 <code>SYN_RCVD</code> 状态。</p></li><li><p>第三次握手(ACK=1，ACKnum=y+1)</p><p>客户端再次发送确认包(ACK)，SYN 标志位为0，ACK 标志位为1，并且把服务器发来 ACK 的序号字段+1，放在确定字段中发送给对方，并且在数据段放写ISN的+1</p><p>发送完毕后，客户端进入 <code>ESTABLISHED</code> 状态，当服务器端接收到这个包时，也进入 <code>ESTABLISHED</code>状态，TCP 握手结束。</p></li></ul><h4 id="少见的情况：四次握手"><a href="#少见的情况：四次握手" class="headerlink" title="少见的情况：四次握手"></a>少见的情况：四次握手</h4><ul><li>请求连接的时候，多发送一个SYN包。</li><li>发生在双方对等，P2P的情况，双方都请求连接，两次syn和两次seq</li></ul><h4 id="TCP四次挥手"><a href="#TCP四次挥手" class="headerlink" title="TCP四次挥手"></a>TCP四次挥手</h4><ul><li><p>第一次挥手(FIN=1，seq=x)</p><p>假设客户端想要关闭连接，客户端发送一个 FIN 标志位置为1的包，表示自己已经没有数据可以发送了，但是仍然可以接受数据。</p><p>发送完毕后，客户端进入 <code>FIN_WAIT_1</code> 状态。</p></li><li><p>第二次挥手(ACK=1，ACKnum=x+1)</p><p>服务器端确认客户端的 FIN 包，发送一个确认包，表明自己接受到了客户端关闭连接的请求，但还没有准备好关闭连接。</p><p>发送完毕后，服务器端进入 <code>CLOSE_WAIT</code> 状态，客户端接收到这个确认包之后，进入 <code>FIN_WAIT_2</code> 状态，等待服务器端关闭连接。</p></li><li><p>第三次挥手(FIN=1，seq=y)</p><p>服务器端准备好关闭连接时，向客户端发送结束连接请求，FIN 置为1。</p><p>发送完毕后，服务器端进入 <code>LAST_ACK</code> 状态，等待来自客户端的最后一个ACK。</p></li><li><p>第四次挥手(ACK=1，ACKnum=y+1)</p><p>客户端接收到来自服务器端的关闭请求，发送一个确认包，并进入 <code>TIME_WAIT</code>状态，等待可能出现的要求重传的 ACK 包。</p><p>服务器端接收到这个确认包之后，关闭连接，进入 <code>CLOSED</code> 状态。</p><p>客户端等待了某个固定时间（两个最大段生命周期，2MSL，2 Maximum Segment Lifetime）之后，没有收到服务器端的 ACK ，认为服务器端已经正常关闭连接，于是自己也关闭连接，进入 <code>CLOSED</code> 状态。</p><ul><li>为什么要等待2MSL：为了避免本次会话的包在会话结束后出现，影响下次会话。需要把这一次的包都接受完毕再关闭连接。</li></ul></li></ul><h4 id="SYN攻击"><a href="#SYN攻击" class="headerlink" title="SYN攻击"></a>SYN攻击</h4><ul><li>在三次握手过程中，服务器发送 SYN-ACK 之后，收到客户端的 ACK 之前的 TCP 连接称为半连接(half-open connect)。此时服务器处于 SYN_RCVD 状态。当收到 ACK 后，服务器才能转入 ESTABLISHED 状态.</li><li>SYN 攻击指的是，攻击客户端在短时间内伪造大量不存在的IP地址，向服务器不断地发送SYN包，服务器回复确认包，并等待客户的确认。由于源地址是不存在的，服务器需要不断的重发直至超时，这些伪造的SYN包将长时间占用未连接队列，正常的SYN请求被丢弃，导致目标系统运行缓慢，严重者会引起网络堵塞甚至系统瘫痪。</li><li>SYN 攻击是一种典型的 DoS/DDoS 攻击。</li></ul><h4 id="TCP心跳检测（Keep-Alive）"><a href="#TCP心跳检测（Keep-Alive）" class="headerlink" title="TCP心跳检测（Keep Alive）"></a>TCP心跳检测（Keep Alive）</h4><ul><li>在交互过程中 ，双方都有可能因为物理原因或者故障而掉线，这个时候需要检测对方是否还在不然无法close释放进程。</li><li>TCP KeepAlive 的基本原理是，隔一段时间给连接对端发送一个探测包，如果收到对方回应的 ACK，则认为连接还是存活的，在超过一定重试次数之后还是没有收到对方的回应，则丢弃该 TCP 连接。</li></ul><h4 id="UDP协议"><a href="#UDP协议" class="headerlink" title="UDP协议"></a>UDP协议</h4><ul><li>只管发不管收，直播流等数据些微损失影响不大，传输速率比较重要的场景。</li><li>无连接，不必握手，直接发就可以；支持广播和多播。</li></ul>]]></content>
      
      
      <categories>
          
          <category> interview </category>
          
      </categories>
      
      
        <tags>
            
            <tag> network </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>数据库知识要点整理</title>
      <link href="/Database/"/>
      <url>/Database/</url>
      
        <content type="html"><![CDATA[<h3 id="数据库管理系统原则——ACID"><a href="#数据库管理系统原则——ACID" class="headerlink" title="数据库管理系统原则——ACID"></a>数据库管理系统原则——ACID</h3><p><strong>ACID</strong>，是指<a href="https://zh.wikipedia.org/wiki/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F">数据库管理系统</a>（<a href="https://zh.wikipedia.org/wiki/DBMS">DBMS</a>）在写入或更新资料的过程中，为保证<a href="https://zh.wikipedia.org/wiki/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BA%8B%E5%8A%A1">事务</a>（transaction）是正确可靠的，所必须具备的四个特性：<a href="https://zh.wikipedia.org/w/index.php?title=%E5%8E%9F%E5%AD%90%E6%80%A7&amp;action=edit&amp;redlink=1">原子性</a>（atomicity，或称不可分割性）、<a href="https://zh.wikipedia.org/w/index.php?title=%E4%B8%80%E8%87%B4%E6%80%A7_(%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F">一致性</a>&amp;action=edit&amp;redlink=1)（consistency）、<a href="https://zh.wikipedia.org/wiki/%E9%9A%94%E9%9B%A2%E6%80%A7">隔离性</a>（isolation，又称独立性）、<a href="https://zh.wikipedia.org/w/index.php?title=%E6%8C%81%E4%B9%85%E6%80%A7&amp;action=edit&amp;redlink=1">持久性</a>（durability）。</p><h4 id="Atomicity（原子性）："><a href="#Atomicity（原子性）：" class="headerlink" title="Atomicity（原子性）："></a>Atomicity（原子性）：</h4><p>一个事务（transaction）中的所有操作，或者全部完成，或者全部不完成，不会结束在中间某个环节。事务在执行过程中发生错误，会被<a href="https://zh.wikipedia.org/wiki/%E5%9B%9E%E6%BB%9A_(%E6%95%B0%E6%8D%AE%E7%AE%A1%E7%90%86">回滚</a>)（Rollback）到事务开始前的状态，就像这个事务从来没有执行过一样。即，事务不可分割、不可约简。</p><h4 id="Consistency（一致性）："><a href="#Consistency（一致性）：" class="headerlink" title="Consistency（一致性）："></a>Consistency（一致性）：</h4><p>在事务开始之前和事务结束以后，数据库的完整性没有被破坏。这表示写入的资料必须完全符合所有的预设<a href="https://zh.wikipedia.org/wiki/%E6%95%B0%E6%8D%AE%E5%AE%8C%E6%95%B4%E6%80%A7">约束</a>、<a href="https://zh.wikipedia.org/wiki/%E8%A7%A6%E5%8F%91%E5%99%A8_(%E6%95%B0%E6%8D%AE%E5%BA%93">触发器</a>)、<a href="https://zh.wikipedia.org/w/index.php?title=%E7%BA%A7%E8%81%94%E5%9B%9E%E6%BB%9A&amp;action=edit&amp;redlink=1">级联回滚</a>等。</p><p>事务是维护数据一致性的基本单位。要么全部执行，要么全都不执行。</p><h4 id="Isolation（隔离性）："><a href="#Isolation（隔离性）：" class="headerlink" title="Isolation（隔离性）："></a>Isolation（隔离性）：</h4><p>数据库允许多个并发事务同时对其数据进行读写和修改的能力，隔离性可以防止多个事务并发执行时由于交叉执行而导致数据的不一致。事务隔离分为不同级别，包括读未提交（Read uncommitted）、读提交（read committed）、可重复读（repeatable read）和串行化（Serializable）。</p><h4 id="Durability（持久性）："><a href="#Durability（持久性）：" class="headerlink" title="Durability（持久性）："></a>Durability（持久性）：</h4><p>事务处理结束后，对数据的修改就是永久的，即便系统故障也不会丢失。（结果一定会写入内存）</p><h3 id="数据库表设计原则"><a href="#数据库表设计原则" class="headerlink" title="数据库表设计原则"></a>数据库表设计原则</h3><ul><li>明确实体和表的对应关系：一对一还是一对多，还是多对多</li><li>对第一、第三、第三范式（三个范式不能生搬硬套，因为适当降低标准可以提高性能）：<ul><li>第一范式：1NF是对属性的原子性约束，要求<strong>属性具有原子性，不可再分解</strong>；</li><li>第二范式：2NF是对记录的惟一性约束，要求<strong>记录有惟一标识，即实体的惟一性</strong>；</li><li>第三范式：3NF是对字段冗余性的约束，即任何字段不能由其他字段派生出来，它要求字段没有冗余。 <ul><li>实际操作我们应当如何减少数据冗余：<ul><li>冗余本质是用空间换时间，比如极端情况我把两张表合并到一起，就可以操作更简单，提高性能；但是代价就是存储开销比较大，完全没有必要这么做。</li><li><strong>支持派生冗余，反对重复冗余</strong>。派生冗余就是比如单价和数量属性计算得到总金额，这个是常用的数据所以引入可以提高性能；重复就是两个表没有必要的重复性。</li></ul></li></ul></li></ul></li><li>完整性约束：<ul><li>最基本的主键不能缺失</li><li>外键定义约束表不发生冲突</li></ul></li><li>一些经验，比如：<ul><li>表较少、字段较少、组成主键的子段少，性能高。</li><li>复杂计算在查询外执行，不要在数据库做。</li><li>表的内容过多就应该分割一些，做子表。</li></ul></li></ul><h3 id="查询优化"><a href="#查询优化" class="headerlink" title="查询优化"></a>查询优化</h3><h4 id="数据库内部实现："><a href="#数据库内部实现：" class="headerlink" title="数据库内部实现："></a>数据库内部实现：</h4><ul><li>对常用结果进行缓存；命中缓存则不需要进行下一步操作。</li><li>解析sql语句之后进行语法树的优化：尝试预测不同方案的查询代价，选择代价最小的那一个查询计划。</li></ul><h4 id="表设计："><a href="#表设计：" class="headerlink" title="表设计："></a>表设计：</h4><ul><li>数据类型优化，单张表的属性少一点之类的，不要用枚举什么的；固定字段长度比可变字段长度效率高。</li><li>建立索引，提高搜索效率</li></ul><h4 id="写查询语句："><a href="#写查询语句：" class="headerlink" title="写查询语句："></a>写查询语句：</h4><ul><li>写的时候估算一下？</li><li>有索引的时候尽量使用</li><li>避免<code>select *</code>，用到什么就取什么</li></ul><h3 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h3><h4 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h4><ul><li>使用B树或者B+树实现，指向记录的物理地址的位置。<ul><li>两种树的区别：<ul><li>B树是二叉树的直接变体，节点存数据指针和下一层的指针；</li><li>B+树的非叶子结点不存数据指针，所以每个节点能够存放的指针更多，更扁平</li></ul></li><li>优缺点：<ul><li>B+树查询速度稳定，因为都要查到叶子结点；</li><li>B+树更方便排序，因为叶子结点是链表串；</li><li>使用B+树做全表遍历更快，因为只涉及最后一层（当然，有索引你还全表遍历，不是直接遍历表就可以了嘛——除非有排序的需求）；</li><li>如果访问数据离根节点快，那么B树更好。</li></ul></li></ul></li><li>通常把节点加载到内存之后，根据查找得到的位置去访问物理空间。</li><li>between范围查询、like的右模糊查询会使用索引，而两侧模糊查询不会</li></ul><h4 id="建立索引原则"><a href="#建立索引原则" class="headerlink" title="建立索引原则"></a>建立索引原则</h4><ul><li>尽量选择主键这种区分度高的字段建立索引</li><li>需要经常范围搜索或者排序的位置，则建立索引</li><li>修改次数远大于检索次数的时候，建索引不好</li><li>如果使用的是多键索引，进行从左到右的匹配，“最左匹配特性”</li></ul><h4 id="索引的坏处"><a href="#索引的坏处" class="headerlink" title="索引的坏处"></a>索引的坏处</h4><ul><li>建立索引的时候内存开销大，容易宕机</li><li>物理空间占用较大，应该适当删除</li><li>修改数据的时候需要较高的维护成本</li></ul><h4 id="有了索引但是查询并不变快的场景"><a href="#有了索引但是查询并不变快的场景" class="headerlink" title="有了索引但是查询并不变快的场景"></a>有了索引但是查询并不变快的场景</h4><p>可能没有走索引。当数据库评估代价的时候，索引并不能帮助提高效率（索引基数较低的情况等等），那它还不如直接遍历全表。</p><h4 id="联合索引"><a href="#联合索引" class="headerlink" title="联合索引"></a>联合索引</h4><h5 id="最左匹配原则"><a href="#最左匹配原则" class="headerlink" title="最左匹配原则"></a>最左匹配原则</h5><ul><li>在mysql建立联合索引时会遵循最左前缀匹配的原则，即最左优先，在检索数据时从联合索引的最左边开始匹配，示例：对列col1、列col2和列col3建一个联合索引<code>(col1, col2)</code>，对查询语句会按照索引的顺序来检查，首先看<code>col1</code>的限制条件，再看<code>col2</code>。</li><li><p>所以在写查询的时候不必在意列的查询顺序。比如，<code>where col1 = &#39;1&#39; and col2 = &#39;2&#39;</code>和<code>where col2 = &#39;2&#39; and col1 = &#39;1&#39;</code>这两个查询语句都会用到索引(col1,col2)，mysql创建联合索引的规则是首先会对联合合索引的最左边的，也就是第一个字段col1的数据进行排序，在第一个字段的排序基础上，然后再对后面第二个字段col2进行排序。其实就相当于实现了类似 order by col1 col2这样一种排序规则。</p></li><li><p>借助mysql查询优化器explain，explain会纠正sql语句该以什么样的顺序执行效率最高，最后才生成真正的执行计划。</p><ul><li><p>具体：<code>EXPLAIN SELECT * FROM test WHERE col2=2\G</code>（\G是为了以列的形式显示出来，不然行来看的话会很长，展不开）</p></li><li><p>例如，我在自己之前用来做你画我猜的数据库测试了一下：</p></li><li><pre class="line-numbers language-mysql"><code class="language-mysql">mysql> explain select * from topics\G*************************** 1. row ***************************           id: 1  select_type: SIMPLE        table: topics   partitions: NULL         type: ALLpossible_keys: NULL          key: NULL      key_len: NULL          ref: NULL         rows: 1     filtered: 100.00        Extra: NULL1 row in set, 1 warning (0.01 sec)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>type字段：ALL全表扫描,通常是不好的，其他的如index、range、const、ref、system则是较好的。</p></li><li><p>possible_keys：可能被用到的索引。</p></li><li><p>key_len：索引基数，也就是不同的键值一共有几种。</p><ul><li><blockquote><p>索引的基数相对于数据表行数较高（也就是说，列中包含很多不同的值，重复的值很少）的时候，它的工作效果最好。如果某数据列含有很多不同的年龄，索引会很快地分辨数据行。如果某个数据列用于记录性别（只有”M”和”F”两种值），那么索引的用处就不大。如果值出现的几率几乎相等，那么无论搜索哪个值都可能得到一半的数据行。在这些情况下，最好根本不要使用索引，因为查询优化器发现某个值出现在表的数据行中的百分比很高的时候，它一般会忽略索引，进行全表扫描。惯用的百分比界线是”30%”。（匹配的数据量超过一定限制的时候查询器会放弃使用索引。尽量不使用会导致索引失效的条件，比如in，用exists子查询代替，或者in的条件少时可以用union all来代替）。</p></blockquote></li></ul></li><li><p>key：按照现在的语句，实际搜索用到的索引，如果是NULL表示没有用到索引。</p></li><li><p>rows：估计要扫描的行数。</p></li></ul></li></ul><h5 id="为什么要使用联合索引？"><a href="#为什么要使用联合索引？" class="headerlink" title="为什么要使用联合索引？"></a>为什么要使用联合索引？</h5><ul><li>减少开销。建一个联合索引(col1,col2,col3)，实际相当于建了(col1),(col1,col2),(col1,col2,col3)三个索引。每多一个索引，都会增加写操作的开销和磁盘空间的开销。对于大量数据的表，使用联合索引会大大的减少开销！</li><li>覆盖索引。对联合索引(col1,col2,col3)，如果有如下的sql: select col1,col2,col3 from test where col1=1 and col2=2。那么MySQL可以直接通过遍历索引取得数据，而无需回表，这减少了很多的随机io操作。减少io操作，特别的随机io其实是dba主要的优化策略。所以，在真正的实际应用中，覆盖索引是主要的提升性能的优化手段之一。</li><li>效率高。索引列越多，通过索引筛选出的数据越少。有1000W条数据的表，有如下sql:select <em>from table where col1=1 and col2=2 and col3=3,假设假设每个条件可以筛选出10%的数据，如果只有单值索引，那么通过该索引能筛选出1000W</em>10%=100w条数据，然后再回表从100w条数据中找到符合col2=2 and col3= 3的数据，然后再排序，再分页；如果是联合索引，通过索引筛选出1000w<em>10%</em> 10% *10%=1w，效率提升可想而知！</li></ul><h3 id="其他散的知识点"><a href="#其他散的知识点" class="headerlink" title="其他散的知识点"></a>其他散的知识点</h3><h4 id="悲观锁和乐观锁"><a href="#悲观锁和乐观锁" class="headerlink" title="悲观锁和乐观锁"></a>悲观锁和乐观锁</h4><p>乐观并发控制(乐观锁)和悲观并发控制（悲观锁）是并发控制主要采用的技术手段。</p><p>乐观锁用于多读——冲突较少，悲观锁用于多写——冲突较多。</p><ul><li>悲观锁：假定会发生并发冲突，屏蔽一切可能违反数据完整性的操作<ul><li>synchronized的底层实现主要依靠 <strong>Lock-Free</strong> 的队列，基本思路是 <strong>自旋后阻塞</strong>，<strong>竞争切换后继续竞争锁</strong>，<strong>稍微牺牲了公平性，但获得了高吞吐量</strong>。在线程冲突较少的情况下，可以获得和CAS类似的性能；而线程冲突严重的情况下，性能远高于CAS。</li></ul></li><li>乐观锁：假设不会发生并发冲突，只在提交操作时检查是否违反数据完整性<ul><li>CAS（将比较并修改值作为原子过程，无锁编程，自旋操作），缺点在于值一样的时候无法检查是否有更新过；自旋机制反复比较开销大。适用于较轻、竞争少的情况。</li><li>版本号机制（提交时比较读时版本号与当前版本号区别，提交版本号必须比记录版本号大才允许更新）</li></ul></li></ul><h4 id="drop、delete与truncate分别在什么场景之下使用？"><a href="#drop、delete与truncate分别在什么场景之下使用？" class="headerlink" title="drop、delete与truncate分别在什么场景之下使用？"></a><strong>drop、delete</strong>与<strong>truncate</strong>分别在什么场景之下使用？</h4><ul><li>不再需要一张表的时候，用<strong>drop</strong></li><li>想删除部分数据行时候，用<strong>delete</strong>，并且带上where子句</li><li>保留表而删除所有数据的时候用<strong>truncate</strong></li></ul><h4 id="什么是视图？以及视图的使用场景有哪些？"><a href="#什么是视图？以及视图的使用场景有哪些？" class="headerlink" title="什么是视图？以及视图的使用场景有哪些？"></a>什么是视图？以及视图的使用场景有哪些？</h4><p>视图是一种虚拟的表，具有和物理表相同的功能。可以对视图进行增，改，查，操作，试图通常是有一个表或者多个表的行或列的子集。对视图的修改不影响基本表。它使得我们获取数据更容易，相比多表查询。</p><ul><li>只暴露部分字段给访问者，所以就建一个虚表，就是视图。</li><li>查询的数据来源于不同的表，而查询者希望以统一的方式查询，这样也可以建立一个视图，把多个表查询结果联合起来，查询者只需要直接从视图中获取数据，不必考虑数据来源于不同表所带来的差异</li></ul>]]></content>
      
      
      <categories>
          
          <category> interview </category>
          
      </categories>
      
      
        <tags>
            
            <tag> database </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NLP学习日记2——Skip-Gram模型</title>
      <link href="/NLP-2-Skip-Gram/"/>
      <url>/NLP-2-Skip-Gram/</url>
      
        <content type="html"><![CDATA[<p>在第一篇日记中提到的<code>Skip-gram</code>模型，它来自<code>word2vec</code>模型，这里补充它的说明。</p><h3 id="前置概念介绍"><a href="#前置概念介绍" class="headerlink" title="前置概念介绍"></a>前置概念介绍</h3><h4 id="词向量"><a href="#词向量" class="headerlink" title="词向量"></a>词向量</h4><p>考虑一下这件事：有些单词之间长得很像，意思和用法也很像；有些单词长得不像，但是意思差不多，比如dog和puppy，kitty和cat，或者说存在比较强的联系。</p><p>另外我们需要表示两个单词的距离，比如上文的dog和puppy之间的关系，cat和kitty的关系其实是一致的——一个是狗和小狗，另一个是猫和小猫。可以说他们彼此的距离是差不多的。但是这样的概念对于非结构化的文本来说，要怎么表示？</p><p>这个时候就需要词向量。我们知道，两个向量之间的距离是可以用公式求出来的（欧式距离、切比雪夫距离、曼哈顿距离等等）。假如每个单词使用一定的特征，如词性、词义等等表示，然后向量之间的距离就能够表示单词之间“语义”的差距的话，岂不是美滋滋？</p><h4 id="Word2Vec"><a href="#Word2Vec" class="headerlink" title="Word2Vec"></a>Word2Vec</h4><p>这个模型是谷歌搞出来训练词向量的模型集合。主要包括有两种模型：</p><ul><li><p>Skip-Gram模型主要用于给定input词语，预测上下文词语。</p></li><li><p>CBOW模型主要用于给定上下文填空。哈哈做出一个完形填空的算法，从此英语高考再也不用担心啦！</p></li></ul><p>⚠️需要注意的是，因为我们的目的在于获得词向量，所以最终得到的结果并不是这个用于输出的模型，而是这整个语料库的词向量表。另外我们确实无法通过这个模型准确预测下一个单词是什么：（，它只不过是用来获得词向量的手段。</p><h4 id="one-hot编码"><a href="#one-hot编码" class="headerlink" title="one-hot编码"></a>one-hot编码</h4><p>算法需要结构化的数值而非一个字符串。所以我们把单词通过one-hot编码转化为一个初始向量。</p><p>具体来说非常简单粗暴：</p><p>比如，基于“The dog barked at the mailman”可以构建一个大小为5的词汇表（忽略大小写和标点符号）：(“the”, “dog”, “barked”, “at”, “mailman”)，我们对这个词汇表的单词进行编号0-4。那么”dog“就可以被表示为一个5维向量[0, 1, 0, 0, 0]。</p><h3 id="Skip-Gram"><a href="#Skip-Gram" class="headerlink" title="Skip-Gram"></a>Skip-Gram</h3><p>终于到今天的正文部分了。</p><p>为了训练，我们需要把单词和它的上下文单词联系起来。</p><ul><li>我们设定两个参数，<code>skip_window</code>表示窗口大小，即从单词左侧和右侧分别取一定的个数个单词；<code>num_skips</code>表示选取几个单词作为输出。</li><li>比如：对一句话”<strong>The dog barked at the mailman</strong>“。在这个例子中，如果两个参数都是2，那么用于训练的是两组数据：<strong>(‘dog’, ‘barked’)，(‘dog’, ‘the’)</strong>。</li><li>下图是另一个例子，<code>skip_window=2,num_skips=2</code>：</li></ul><p><img src="/NLP-2-Skip-Gram/skip_gram.png" alt></p><h4 id="模型细节"><a href="#模型细节" class="headerlink" title="模型细节"></a>模型细节</h4><p>首先贴出模型的结构图：</p><p><img src="/NLP-2-Skip-Gram/skip-gram1.png" alt></p><p>假设语料库的单词集合大小为n。</p><p>首先，模型的输入就是一个<code>one-hot</code>编码后的单词，是一个n维的向量。</p><p>然后，模型的输出可以使用一个n维的向量表示单词表的概率分布。当然，为了保证最后所有单词概率和为1，我们需要加一层<code>softmax</code>函数，把结果指数归一化。</p><p>需要关注的是中间的hidden layer。</p><p>我们可以把隐层理解成一个巨大的矩阵，里面有每个单词和它在各个特征的值，使用某个单词对应的one-hot矩阵与它相乘就会得到这个单词的嵌入向量。</p><p><img src="/NLP-2-Skip-Gram/lookuptable.png" alt></p><p>所以我们需要求出的就是一个矩阵——这个隐层网络本身就是一个n*m维的矩阵（m是单词个数，n是特征维度）</p><p>接下来经过归一化，可以得到和所需要的单词最接近的单词。</p><h4 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h4><p>这样我们能够得出结论：如果两个不同的单词有着非常相似的上下文，那么通过模型训练，这两个单词的嵌入向量将非常相似。</p><p>对于这样一个矩阵来说，n*m个参数的训练的非常低效和麻烦的。</p><blockquote><p>Word2Vec的作者在它的第二篇论文中强调了这些问题，下面是作者在第二篇论文中的三个创新：</p><ol><li>将常见的单词组合（word pairs）或者词组作为单个“words”来处理。</li><li>对高频次单词进行抽样来减少训练样本的个数。</li><li>对优化目标采用“negative sampling”方法，这样每个训练样本的训练只会更新一小部分的模型权重，从而降低计算负担。</li></ol><p>事实证明，对常用词抽样并且对优化目标采用“negative sampling”不仅降低了训练过程中的计算负担，还提高了训练的词向量的质量。</p></blockquote><p>那么按照这一思路，我们需要：</p><h4 id="对高频词进行抽样"><a href="#对高频词进行抽样" class="headerlink" title="对高频词进行抽样"></a>对高频词进行抽样</h4>]]></content>
      
      
      <categories>
          
          <category> machine learning </category>
          
      </categories>
      
      
        <tags>
            
            <tag> NLP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>41.Trapping Rain Water</title>
      <link href="/42-Trapping-Rain-Water/"/>
      <url>/42-Trapping-Rain-Water/</url>
      
        <content type="html"><![CDATA[<h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p>Given <em>n</em> non-negative integers representing an elevation map where the width of each bar is 1, compute how much water it is able to trap after raining.</p><p><img src="https://assets.leetcode.com/uploads/2018/10/22/rainwatertrap.png" alt><br>The above elevation map is represented by array [0,1,0,2,1,0,1,3,2,1,2,1]. In this case, 6 units of rain water (blue section) are being trapped. <strong>Thanks Marcos</strong> for contributing this image!</p><a id="more"></a><p><strong>Example:</strong></p><pre><code>Input: [0,1,0,2,1,0,1,3,2,1,2,1]Output: 6</code></pre><h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><p>待补充。</p>]]></content>
      
      
      <categories>
          
          <category> leetcode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> array </tag>
            
            <tag> hard </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>软件架构扫盲</title>
      <link href="/Software-architecture/"/>
      <url>/Software-architecture/</url>
      
        <content type="html"><![CDATA[<p>面试被问到对架构的理解。老实说，我对这一块本来没有深入思考过。</p><p>之前常常集中精力在一些具体理论或者工具上，对架构这一块的了解仅限于感性意识——即，我知道有这样的理论和结构，但是无法清晰地描述它。</p><p>所以借此机会，在网上找了一些资料，了解了一下现代主流的软件架构。</p><p>本文主要基于O’Relly出版的一本介绍软件架构的<a href="https://www.oreilly.com/programming/free/files/software-architecture-patterns.pdf">免费小册子</a>。</p><a id="more"></a><p>在介绍架构之前，首先引入评价架构的指标：</p><h3 id="架构评价指标"><a href="#架构评价指标" class="headerlink" title="架构评价指标"></a>架构评价指标</h3><ul><li>是否易于部署</li><li>是否易于拓展和修改功能</li><li>是否易于测试</li><li>是否易于伸缩</li><li>是否易于开发</li></ul><p>下面介绍5种架构，并且会针对这些指标，给出关于这些架构的评价。</p><h3 id="分层架构LA"><a href="#分层架构LA" class="headerlink" title="分层架构LA"></a>分层架构LA</h3><p>这是最常见的软件架构，常见分层为4层：展示层，业务层，持久层，和数据库层。</p><p>每一层之间通过接口相连接。比如，用户访问网页并登陆，经过登陆逻辑，继续往下验证输入的用户名和密码，在数据库层获取数据后在后台验证，返回验证结果并显示在前端界面。用户请求将会被每一层处理。</p><p><img src="/Software-architecture/layer.jpg" alt></p><p>这个结构的特性很好理解，就如神经网络每一层之间的关系，上一层的输出被当作下一层的输入。缺陷也是显而易见的：耦合度比较高，层与层之间必须接口一致（像神经网络，的层间的输入输出维度必须一致）。</p><p>有些分层模型会适当地开放一些层，使得层与层之间可以跨越式访问，但是这样做会让层次之间联系变得更为复杂，提高了耦合度。</p><h4 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h4><ul><li>每层可以单独测试，因为有完整的接口。</li><li>分工简单，因为每个团队（个人）只需要做和他关系最大的那一块就可以。主流的”前端”、”后端”都是根据层来划分技术人员的。</li><li>开发比较容易，只需要面向接口编程就可以了。</li></ul><h4 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h4><ul><li>性能比较差。每个用户请求都需要穿越所有的层。</li><li>维护困难。当我修改数据库层或者展现层的时候，就意味着可能上一层或者下一层需要变动，而发生变动的时候需要将服务停止运行。过高的耦合度使得软件变得牵一发而动全身。</li><li>拓展性不好。同上一点，需要添加或者删减一个功能的时候，都会带来所有层的影响。</li><li>部署不灵活。因为分层架构缺一不可，需要完整地部署整个项目，确保每个层都完成部署才能上线。</li></ul><h4 id="举例"><a href="#举例" class="headerlink" title="举例"></a>举例</h4><p>常见的网页开发（如普通的课程项目<em>图书管理系统</em>）=前端+后端+数据库。</p><h3 id="事件驱动架构EDA"><a href="#事件驱动架构EDA" class="headerlink" title="事件驱动架构EDA"></a>事件驱动架构EDA</h3><p>高度解耦合的架构，适应性很高。包括中介拓扑结构和代理拓扑结构。</p><h4 id="中介拓扑结构Mediator"><a href="#中介拓扑结构Mediator" class="headerlink" title="中介拓扑结构Mediator"></a>中介拓扑结构Mediator</h4><p>处理事件主要包含的环节：</p><ul><li>事件队列Event Queue：所有事件发生之后会进入队列。队列可以有多个。</li><li>事件调停器Event Mediator：调停器通过拓扑排序等手段确定事件的执行顺序并进行处理（以及并行or串行）</li><li>事件管道Event Channel：调停器运输经过处理后的事件到处理器的路径</li><li>事件处理器Event Processor：事件的终点，负责响应事件。负责独立运作，完成单一的工作。</li></ul><p>⚠️注意，事件处理器收到的事件和在消息队列的事件不是同一个概念。它们有关联，但是后者是调停器生成的，和初始事件不完全一样。</p><p>以搬家举例，搬家是初始事件，当调停器通过事件队列收到事件之后，将其分解为多个子事件（搬家当然有很多事情需要做，比如联系方式、通知保险公司等等）。</p><p>此时，这些新的子事件就会被分配到相应的处理器进行响应。</p><p><img src="/Software-architecture/2-2.png" alt></p><h4 id="代理拓扑结构Broker"><a href="#代理拓扑结构Broker" class="headerlink" title="代理拓扑结构Broker"></a>代理拓扑结构Broker</h4><p>在代理拓扑结构中，核心的调停器被去除，而是由事件处理器代为转发给下一个事件处理器（如同接力赛跑）。如果这一块不是分内之事，就不操作，转发就可以。</p><p>这一个架构的场景是需要处理的事件逻辑都比较简单，没有很复杂的依赖关系（这是我的理解）。</p><p>由于没有中间的过程，效率会高一些。相当于把分解过程由处理器代劳了，有点去中心化的味道。</p><p>还是以搬家的事件为例说明：</p><p><img src="/Software-architecture/2-4.png" alt></p><h4 id="另一种架构：Proxy"><a href="#另一种架构：Proxy" class="headerlink" title="另一种架构：Proxy"></a>另一种架构：Proxy</h4><p>这一个说实话我本来没注意到，以为是和代理broker差不多（毕竟proxy也是代理的意思）。</p><p>看到描述，引用在这里。暂时看不明白。<a href="https://github.com/hehonghui/android-tech-frontier/blob/master/software-architecture-patterns/%E8%BD%AF%E4%BB%B6%E6%9E%B6%E6%9E%84%E6%A8%A1%E5%BC%8F.md#appendix">出处</a></p><blockquote><ul><li>如果我们使用 proxy，那就意味着我自己对需要处理的事件进行了分解，然后把不同的子事件一一委托给不同的 proxy，由被委托的 proxy 帮我完成子事件，从而完成我要做的事件。</li></ul></blockquote><h4 id="优点-1"><a href="#优点-1" class="headerlink" title="优点"></a>优点</h4><ul><li>便于部署。因为每个处理器是独立的，可以单独部署。当然，如果使用的是中介拓扑结构，那会稍微麻烦一些——修改处理器的同时需要同时修改中介，即调度器。</li><li>性能高。异步处理事件（交付后不必等待其完成处理即可返回），相当于并行操作，提高效率。</li><li>可拓展性强。相比层级结构，易于添加功能。</li></ul><h4 id="缺点-1"><a href="#缺点-1" class="headerlink" title="缺点"></a>缺点</h4><ul><li>实现比较复杂。事件是异步分发处理的。</li><li>难以测试。主要来自其异步的特点。</li></ul><blockquote><p>使用事件驱动架构模式最困难的地方就在于架构的创建、维护、以及对事件处理器的管理。通常每一个事件都拥有其指定的事件处理协议（例如：传递给事件处理器的数据类型、数据格式），这就使得设下标准的数据格式成为使用事件驱动架构模式中至关重要的一环（例如：XML，JSON，Java 对象，等等……），并在架构创建之初就为这些数据格式授权，以便处理。</p></blockquote><h3 id="微核架构MKA"><a href="#微核架构MKA" class="headerlink" title="微核架构MKA"></a>微核架构MKA</h3><p>看到这个就想起操作系统的位内核架构，其实两个差不多——不如说微内核的操作系统也属于一种微核架构的实践？hhh。</p><p>如同微内核操作系统的结构，内核部分只需要提供一个最基本功能的实现即可；而需要什么功能，做相应插件就能够实现。原则上插件相互独立，不应过于依赖彼此，通信也应该少一些。</p><p><img src="/Software-architecture/microKernal.png" alt></p><blockquote><p>微内核架构是可以被嵌入到其他架构（如层级架构）中间的。</p></blockquote><h4 id="优点-2"><a href="#优点-2" class="headerlink" title="优点"></a>优点</h4><ul><li>功能拓展性好，需要什么功能开发插件就可以。</li><li>部署较方便，同样是因为插件的特性，可以独立加载或者卸载。</li><li>可定制性高，需要什么就加什么。</li><li>可以渐进式开发。</li></ul><h4 id="缺点-2"><a href="#缺点-2" class="headerlink" title="缺点"></a>缺点</h4><ul><li>内核系统难以做成分布式，只能以独立单元存在。</li><li>开发难度较高。需要设计插件的注册机制，插件与内核通信等等（其实应该是因为这一个领域做的不多？）。</li></ul><h4 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h4><p>说到插件，就自然联想到常见的各种IDE、浏览器了。</p><h3 id="微服务架构MSA"><a href="#微服务架构MSA" class="headerlink" title="微服务架构MSA"></a>微服务架构MSA</h3><p>这一个架构是从SOA（面向服务的架构）发展而来的——SOA也是一种架构，和微服务架构大体相似，也是将功能独立成各种单元，通过良好的接口定义连接起来。与原先的宏模式相比，强调了松耦合和组件化的特征。</p><p>微服务架构将应用的服务分解成不同模块，以管道和用户界面通信。微服务架构模式的另一个关键概念是它是一个<em>分布式</em>的架构，所以所有组件之间是完全解耦的，用户界面层通过某种远程访问协议（如，JMS, AMQP, REST, SOAP, RMI等）进行访问。</p><p>REST、SOAP比较常见，在这里简单介绍一下：</p><ul><li>REST是基于http+json格式传输信息的协议。</li><li>SOAP是基于http+XML格式传输信息的协议。</li></ul><p><img src="/Software-architecture/4-1.png" alt></p><h4 id="模式的拓扑结构"><a href="#模式的拓扑结构" class="headerlink" title="模式的拓扑结构"></a>模式的拓扑结构</h4><ol><li>基于REST的API拓扑，使用者多为网站，采用粒度非常小的服务分解，每一个小的服务对应一个极小的API。</li><li>基于REST的拓扑，类似上一类，但是将多个REST的API结构进行整合成一个大的REST服务组件。</li><li>集中式拓扑，采用一个代理层分析请求并实现操作。主要是用在控制逻辑比较复杂的场合。</li></ol><p>⚠️注意，使用REST的时候需要合理划分粒度和服务，减少耦合依赖和重复。</p><h4 id="优点-3"><a href="#优点-3" class="headerlink" title="优点"></a>优点</h4><ul><li>易于部署。由于服务比较独立，一般采用分布式组件，可以单独部署。由于改变某个组件被隔离，所以避免了月末的爆炸性增长部署工作。</li><li>易于测试。由于服务独立，所以可以分开测试。</li><li>伸缩性好，也就是可以适应不同规模。</li><li>易于开发，因为单个组件功能简单且不会互相影响，所以协调工作减少。</li></ul><h4 id="缺点-3"><a href="#缺点-3" class="headerlink" title="缺点"></a>缺点</h4><ul><li>性能较低。分布式特性不适合高性能要求的程序。</li></ul><h3 id="基于空间的架构——云架构SBA"><a href="#基于空间的架构——云架构SBA" class="headerlink" title="基于空间的架构——云架构SBA"></a>基于空间的架构——云架构SBA</h3><blockquote><p>大多数基于网站的商务应用都遵循相同的请求流程：一个请求从浏览器发到web服务器，然后到应用服务器，然后到数据库服务器。虽然这个模式在用户数不大的时候工作良好，但随着用户负载的增加,瓶颈会开始出现，首先出现在web服务器层，然后应用服务器层，最后数据库服务器层。</p><p>通常的解决办法就是<strong>向外扩展</strong>，也就是增加web服务器数量。这个方法相对来说简单和廉价，并能够解决问题。然而扩展应用服务器会更复杂，而且成本更高，并且又只是把问题移动到了数据库服务器，那会更复杂，更贵。</p><p>就算你能扩展数据库服务器，你最终会陷入一个金字塔式的情形，在金字塔最下面是web服务器，它会出现最多的问题，但也最好伸缩。金字塔顶部是数据库服务器，问题不多，但最难伸缩。</p></blockquote><p>从上述描述看来，高并发系统需要解决的主要问题在于数据库服务器较差的伸缩性。</p><p>基于空间的架构模型是专门为了<strong>解决伸缩性和并发问题</strong>而设计的。它对于用户数量不可预测且数量级经常变化的情况同样适用。在架构级别来解决这个伸缩性问题通常是比增加服务器数量或者提高缓存技术更好的解决办法。</p><p>主要包括处理单元和虚拟中间件。</p><p>说实话，从这里开始我已经看不懂了。先贴图，日后看懂了再解释吧……</p><ul><li>处理单元</li><li>虚拟中间件<ul><li><strong>消息中间件</strong>（Messaging Grid）：管理用户请求和session，当一个请求进来以后，决定分配给哪一个处理单元。</li><li><strong>数据中间件</strong>（Data Grid）：将数据复制到每一个处理单元，即数据同步。保证某个处理单元都得到同样的数据。</li><li><strong>处理中间件</strong>（Processing Grid）：可选，如果一个请求涉及不同类型的处理单元，该中间件负责协调处理单元</li><li><strong>部署中间件</strong>（Deployment Manager）：负责处理单元的启动和关闭，监控负载和响应时间，当负载增加，就新启动处理单元，负载减少，就关闭处理单元。</li></ul></li></ul><p><img src="/Software-architecture/5-1.png" alt></p><h3 id="一图流总结"><a href="#一图流总结" class="headerlink" title="一图流总结"></a>一图流总结</h3><p>把所有5种架构的6个维度的特征用图表概括，就是这样：</p><p><img src="/Software-architecture/a-1.png" alt></p><p>联系其定义，这些特征也比较好理解。</p><p>当然，纸上得来终觉浅，架构的理论没有具体实践经验的支撑，难以深入理解。</p><p>这一篇就属于扫盲文章了。</p>]]></content>
      
      
      <categories>
          
          <category> interview </category>
          
      </categories>
      
      
        <tags>
            
            <tag> software theory </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LuckyMoney——红包分配算法</title>
      <link href="/LuckyMoney/"/>
      <url>/LuckyMoney/</url>
      
        <content type="html"><![CDATA[<p>面试被问到这题，记录一下思路～从一开始的复杂算法到后面的简化和优化过程。</p><h3 id="要点"><a href="#要点" class="headerlink" title="要点"></a>要点</h3><ul><li>保证每人有一个金额下限（0.01），以及一个金额上限（占总金额的比重不能超过90%）</li><li>保证结果有2位小数（精确到分），需要考虑浮点数计算误差。</li></ul><a id="more"></a><h3 id="初步思路"><a href="#初步思路" class="headerlink" title="初步思路"></a>初步思路</h3><ol><li>分割法：每次把最大的红包分割成两个小的，进行<code>n-1</code>次操作。<ul><li>注意随机的上界和下界；最后顺序还要shuffle。</li><li>时间复杂度：O(nlogn)​，代码也长，逻辑比较复杂+可读性差。</li></ul></li></ol><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LuckyMoney</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">double</span> min <span class="token operator">=</span> <span class="token number">0.01</span><span class="token punctuation">,</span> maxRate <span class="token operator">=</span> <span class="token number">0.9</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">double</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">distribute</span><span class="token punctuation">(</span><span class="token keyword">double</span> total<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// Corner case: cases with 1 people, or invalid cases.</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;=</span> <span class="token number">0</span> <span class="token operator">||</span> total <span class="token operator">&lt;=</span> min <span class="token operator">*</span> n <span class="token operator">||</span> maxRate <span class="token operator">*</span> n <span class="token operator">&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">double</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token operator">-</span><span class="token number">1.0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">double</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span>total<span class="token punctuation">}</span><span class="token punctuation">;</span>        Random rand <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">double</span><span class="token punctuation">[</span><span class="token punctuation">]</span> res <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">double</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> totalCents <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>total <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> maxCents <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>maxRate <span class="token operator">*</span> totalCents<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// Maximum heap, stores the largest Lucky on the peek.</span>        PriorityQueue<span class="token operator">&lt;</span>Integer<span class="token operator">></span> money <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PriorityQueue</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">(</span>o1<span class="token punctuation">,</span> o2<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> o2 <span class="token operator">-</span> o1<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// Split the max Lucky for n - 1 times.</span>        money<span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span>totalCents<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">int</span> maxMoney <span class="token operator">=</span> money<span class="token punctuation">.</span><span class="token function">poll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lowerBound <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> min <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">,</span> totalCents <span class="token operator">-</span> <span class="token punctuation">(</span>n <span class="token operator">-</span> i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> maxCents<span class="token punctuation">)</span><span class="token punctuation">,</span> upperBound <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>maxCents<span class="token punctuation">,</span> maxMoney<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">int</span> curr <span class="token operator">=</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span>upperBound <span class="token operator">-</span> lowerBound<span class="token punctuation">)</span> <span class="token operator">+</span> lowerBound<span class="token punctuation">;</span>            money<span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span>curr<span class="token punctuation">)</span><span class="token punctuation">;</span>            money<span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span>maxMoney <span class="token operator">-</span> curr<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">// Shuffle the values.</span>        List<span class="token operator">&lt;</span>Integer<span class="token operator">></span> tmpValues <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span>money<span class="token punctuation">)</span><span class="token punctuation">;</span>        Collections<span class="token punctuation">.</span><span class="token function">shuffle</span><span class="token punctuation">(</span>tmpValues<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// Calculate the money.</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>            res<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> tmpValues<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">100.0</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// This part can also be used for all methods below.</span>    <span class="token comment" spellcheck="true">// Check the results.</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">boolean</span> <span class="token function">validate</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">[</span><span class="token punctuation">]</span> res<span class="token punctuation">,</span> <span class="token keyword">double</span> total<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>res <span class="token operator">==</span> null <span class="token operator">||</span> res<span class="token punctuation">.</span>length <span class="token operator">!=</span> n<span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token keyword">double</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>            sum <span class="token operator">+=</span> res<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// Check sum.</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>sum <span class="token operator">-</span> total <span class="token operator">&lt;</span> <span class="token number">1e-6</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// Check each.</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">/</span> sum <span class="token operator">>=</span> maxRate <span class="token operator">||</span> res<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> min<span class="token punctuation">)</span>                <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// test 100.00</span>        <span class="token keyword">double</span><span class="token punctuation">[</span><span class="token punctuation">]</span> test <span class="token operator">=</span> <span class="token function">distribute</span><span class="token punctuation">(</span><span class="token number">100.00</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>Arrays<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token function">validate</span><span class="token punctuation">(</span>test<span class="token punctuation">,</span> <span class="token number">100.00</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="2"><li>直接随机求每次的值，定好每次上界和下界即可。<ul><li>结果上看，存在前面分钱多，后面分钱少的问题。可以考虑使用shuffle；</li><li>另外，由于使用的是平均分布的随机函数，所以导致大或者小红包出现概率比较大，比较”不公平”。</li><li>时间复杂度：O(n)</li></ul></li></ol><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LuckyMoney</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">double</span> min <span class="token operator">=</span> <span class="token number">0.01</span><span class="token punctuation">,</span> maxRate <span class="token operator">=</span> <span class="token number">0.9</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">double</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">distribute</span><span class="token punctuation">(</span><span class="token keyword">double</span> total<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> remainCents <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>total <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> minCents <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>min <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> maxCents <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>maxRate <span class="token operator">*</span> remainCents<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">double</span><span class="token punctuation">[</span><span class="token punctuation">]</span> res <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">double</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>        Random rand <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">int</span> lowerBound <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>minCents<span class="token punctuation">,</span> remainCents <span class="token operator">-</span> <span class="token punctuation">(</span>n <span class="token operator">-</span> i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> maxCents<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">int</span> upperBound <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>maxCents<span class="token punctuation">,</span> remainCents <span class="token operator">-</span> <span class="token punctuation">(</span>n <span class="token operator">-</span> i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> minCents<span class="token punctuation">)</span><span class="token punctuation">;</span>            res<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> rand<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span>upperBound <span class="token operator">-</span> lowerBound<span class="token punctuation">)</span> <span class="token operator">+</span> lowerBound<span class="token punctuation">;</span>            remainCents <span class="token operator">-=</span> res<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>            res<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">/=</span> <span class="token number">100.0</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="调整思路"><a href="#调整思路" class="headerlink" title="调整思路"></a>调整思路</h3><p>在上面的实现过程中，我遇到了两个问题：</p><ol><li>大小红包出现概率过大，导致不公平；</li><li>前面红包普遍比后面红包大，不够随机。</li></ol><p>经过一些资料查阅，看到一些针对微信红包的测试实验结果：</p><ul><li>在比较靠后抽取的红包金额方差较大，其分布接近指数，容易抽到手气最佳；</li><li>在比较靠前抽取的红包方差较小，平均值差不多。</li></ul><p>此外，我了解到使用正态分布可以使大家的金额数接近平均值，使得大红包和小红包都不容易出现。</p><p>有一些文章推测，微信红包使用的是截尾正态分布算法，即保留部分正态分布图像在指定区间，而区间以外的概率密度为0；当然，为保证所需区间概率密度和为1，需要拔高整体图像，这在公式上通过乘一个系数得到。</p><p>经过一番思考后写下的代码：</p><ol><li>调整平均分布为截尾正态分布，每个人获得的是以当前余额的平均为均值，并明确上下限的截尾正态分布随机获得的值。<ul><li>结果较好，避免了红包金额不公和前后分布不均问题。</li><li>截尾正态分布实现比较粗暴（如果随机结果不在里面就舍弃重来）。</li><li>在正态分布参数的选择上，直接以均值作为方差的开方，不知是否有更好的参数？</li></ul></li></ol><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LuckyMoney</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">double</span> min <span class="token operator">=</span> <span class="token number">0.01</span><span class="token punctuation">,</span> maxRate <span class="token operator">=</span> <span class="token number">0.9</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">double</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">distribute</span><span class="token punctuation">(</span><span class="token keyword">double</span> total<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> remainCents <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>total <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> minCents <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>min <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> maxCents <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>maxRate <span class="token operator">*</span> remainCents<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">double</span><span class="token punctuation">[</span><span class="token punctuation">]</span> res <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">double</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">int</span> lowerBound <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>minCents<span class="token punctuation">,</span> remainCents <span class="token operator">-</span> <span class="token punctuation">(</span>n <span class="token operator">-</span> i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> maxCents<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">int</span> upperBound <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>maxCents<span class="token punctuation">,</span> remainCents <span class="token operator">-</span> <span class="token punctuation">(</span>n <span class="token operator">-</span> i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> minCents<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">int</span> mean <span class="token operator">=</span> remainCents <span class="token operator">/</span> <span class="token punctuation">(</span>n <span class="token operator">-</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>            res<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">truncatedNorm</span><span class="token punctuation">(</span>mean<span class="token punctuation">,</span> mean<span class="token punctuation">,</span> lowerBound<span class="token punctuation">,</span> upperBound<span class="token punctuation">)</span><span class="token punctuation">;</span>            remainCents <span class="token operator">-=</span> res<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>            res<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">/=</span> <span class="token number">100.0</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// A naive implementation of truncated normal distribution.</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">truncatedNorm</span><span class="token punctuation">(</span><span class="token keyword">int</span> m<span class="token punctuation">,</span> <span class="token keyword">int</span> sqrtv<span class="token punctuation">,</span> <span class="token keyword">int</span> lo<span class="token punctuation">,</span> <span class="token keyword">int</span> hi<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>lo <span class="token operator">==</span> hi<span class="token punctuation">)</span>            <span class="token keyword">return</span> lo<span class="token punctuation">;</span>        <span class="token keyword">int</span> res<span class="token punctuation">;</span>        Random rand <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">do</span> <span class="token punctuation">{</span>            res <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>rand<span class="token punctuation">.</span><span class="token function">nextGaussian</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> sqrtv<span class="token punctuation">)</span> <span class="token operator">+</span> m<span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span>res <span class="token operator">&lt;</span> lo <span class="token operator">||</span> res <span class="token operator">></span> hi<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="4"><li>修改成实时分配（用性能换空间）</li></ol><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LuckyMoney</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">double</span> min <span class="token operator">=</span> <span class="token number">0.01</span><span class="token punctuation">,</span> maxRate <span class="token operator">=</span> <span class="token number">0.9</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// Index = 1, 2, 3, ..., n</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">double</span> <span class="token function">nextMoney</span><span class="token punctuation">(</span><span class="token keyword">double</span> remain<span class="token punctuation">,</span> <span class="token keyword">double</span> total<span class="token punctuation">,</span> <span class="token keyword">int</span> index<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">==</span> n<span class="token punctuation">)</span>            <span class="token keyword">return</span> remain<span class="token punctuation">;</span>        <span class="token keyword">int</span> remainCents <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>remain <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> minCents <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>min <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> maxCents <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>total <span class="token operator">*</span> <span class="token number">100</span> <span class="token operator">*</span> maxRate<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> lowerBound <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>minCents<span class="token punctuation">,</span> remainCents <span class="token operator">-</span> <span class="token punctuation">(</span>n <span class="token operator">-</span> index<span class="token punctuation">)</span> <span class="token operator">*</span> maxCents<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> upperBound <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>maxCents<span class="token punctuation">,</span> remainCents <span class="token operator">-</span> <span class="token punctuation">(</span>n <span class="token operator">-</span> index<span class="token punctuation">)</span> <span class="token operator">*</span> minCents<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> mean <span class="token operator">=</span> remainCents <span class="token operator">/</span> <span class="token punctuation">(</span>n <span class="token operator">-</span> index <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token function">truncatedNorm</span><span class="token punctuation">(</span>mean<span class="token punctuation">,</span> mean<span class="token punctuation">,</span> lowerBound<span class="token punctuation">,</span> upperBound<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">100.0</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// Truncated normalize distribution function: omitted.</span>    <span class="token comment" spellcheck="true">// main function.</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">double</span> total <span class="token operator">=</span> <span class="token number">100.0</span><span class="token punctuation">,</span> remain <span class="token operator">=</span> total<span class="token punctuation">;</span>        <span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">double</span> curr <span class="token operator">=</span> <span class="token function">nextMoney</span><span class="token punctuation">(</span>remain<span class="token punctuation">,</span> total<span class="token punctuation">,</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>            remain <span class="token operator">-=</span> curr<span class="token punctuation">;</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>curr<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="5"><li>（网传）微信红包算法实现及分析<ul><li>实时分配金额，最小值为0.01，最大值为当前剩余平均值的两倍</li><li>使用红包类，思路清晰；避免了正态计算，时间效率较好。</li><li>当然，这里没有涉及最大红包的数值限制。</li></ul></li></ol><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">double</span> <span class="token function">getRandomMoney</span><span class="token punctuation">(</span>LeftMoneyPackage _leftMoneyPackage<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// remainSize 剩余的红包数量</span>    <span class="token comment" spellcheck="true">// remainMoney 剩余的钱</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>_leftMoneyPackage<span class="token punctuation">.</span>remainSize <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        _leftMoneyPackage<span class="token punctuation">.</span>remainSize<span class="token operator">--</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span> Math<span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span>_leftMoneyPackage<span class="token punctuation">.</span>remainMoney <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">100</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    Random r     <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">double</span> min   <span class="token operator">=</span> <span class="token number">0.01</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//</span>    <span class="token keyword">double</span> max   <span class="token operator">=</span> _leftMoneyPackage<span class="token punctuation">.</span>remainMoney <span class="token operator">/</span> _leftMoneyPackage<span class="token punctuation">.</span>remainSize <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>    <span class="token keyword">double</span> money <span class="token operator">=</span> r<span class="token punctuation">.</span><span class="token function">nextDouble</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> max<span class="token punctuation">;</span>    money <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>money<span class="token punctuation">,</span> min<span class="token punctuation">)</span><span class="token punctuation">;</span>    money <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>money <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">100</span><span class="token punctuation">;</span>    _leftMoneyPackage<span class="token punctuation">.</span>remainSize<span class="token operator">--</span><span class="token punctuation">;</span>    _leftMoneyPackage<span class="token punctuation">.</span>remainMoney <span class="token operator">-=</span> money<span class="token punctuation">;</span>    <span class="token keyword">return</span> money<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="浮点数精度问题"><a href="#浮点数精度问题" class="headerlink" title="浮点数精度问题"></a>浮点数精度问题</h3><ul><li>使用<code>BigDecimal</code>确保精度，商业运算常规做法。具体用法同<code>BigInteger</code>。</li></ul><h3 id="多人抢红包实例"><a href="#多人抢红包实例" class="headerlink" title="多人抢红包实例"></a>多人抢红包实例</h3><ul><li>注意<code>synchronized</code>关键字的使用。</li></ul><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Random<span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">LuckyMoney</span> <span class="token punctuation">{</span>    <span class="token keyword">int</span> totalSize<span class="token punctuation">,</span> remainSize<span class="token punctuation">;</span>    <span class="token keyword">double</span> totalMoney<span class="token punctuation">,</span> remainMoney<span class="token punctuation">,</span> minMoney <span class="token operator">=</span> <span class="token number">0.01</span><span class="token punctuation">,</span> maxRate <span class="token operator">=</span> <span class="token number">0.9</span><span class="token punctuation">,</span> maxMoney<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token function">LuckyMoney</span><span class="token punctuation">(</span><span class="token keyword">double</span> money<span class="token punctuation">,</span> <span class="token keyword">int</span> people<span class="token punctuation">)</span> <span class="token punctuation">{</span>        totalSize <span class="token operator">=</span> remainSize <span class="token operator">=</span> people<span class="token punctuation">;</span>        totalMoney <span class="token operator">=</span> remainMoney <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span> Math<span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span>money <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">100</span><span class="token punctuation">;</span>        maxMoney <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span> Math<span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span>totalMoney <span class="token operator">*</span> maxRate <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">100</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GetLuckyMoney</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> LuckyMoney money<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">int</span> index<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token function">GetLuckyMoney</span><span class="token punctuation">(</span>LuckyMoney _money<span class="token punctuation">)</span> <span class="token punctuation">{</span>        money <span class="token operator">=</span> _money<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token operator">++</span>index<span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Man "</span> <span class="token operator">+</span> index <span class="token operator">+</span> <span class="token string">" get "</span> <span class="token operator">+</span> <span class="token function">getMoney</span><span class="token punctuation">(</span>money<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">private</span> <span class="token keyword">double</span> <span class="token function">getMoney</span><span class="token punctuation">(</span>LuckyMoney money<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">double</span> res<span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>money<span class="token punctuation">.</span>remainSize <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            money<span class="token punctuation">.</span>remainSize<span class="token operator">--</span><span class="token punctuation">;</span>            res <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span> Math<span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span>money<span class="token punctuation">.</span>remainMoney <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">100</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> res<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">double</span> lowerBound <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>money<span class="token punctuation">.</span>minMoney<span class="token punctuation">,</span> money<span class="token punctuation">.</span>remainMoney <span class="token operator">-</span> <span class="token punctuation">(</span>money<span class="token punctuation">.</span>remainSize <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> money<span class="token punctuation">.</span>maxMoney<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">double</span> upperBound <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>money<span class="token punctuation">.</span>maxMoney<span class="token punctuation">,</span> money<span class="token punctuation">.</span>remainMoney <span class="token operator">-</span> <span class="token punctuation">(</span>money<span class="token punctuation">.</span>remainSize <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> money<span class="token punctuation">.</span>minMoney<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">double</span> mean <span class="token operator">=</span> money<span class="token punctuation">.</span>remainMoney <span class="token operator">/</span> money<span class="token punctuation">.</span>remainSize<span class="token punctuation">;</span>        res <span class="token operator">=</span> <span class="token function">truncatedNorm</span><span class="token punctuation">(</span>mean<span class="token punctuation">,</span> mean<span class="token punctuation">,</span> lowerBound<span class="token punctuation">,</span> upperBound<span class="token punctuation">)</span><span class="token punctuation">;</span>        res <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span> Math<span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span>res <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">100</span><span class="token punctuation">;</span>        money<span class="token punctuation">.</span>remainSize<span class="token operator">--</span><span class="token punctuation">;</span>        money<span class="token punctuation">.</span>remainMoney <span class="token operator">-=</span> res<span class="token punctuation">;</span>        <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">private</span> <span class="token keyword">double</span> <span class="token function">truncatedNorm</span><span class="token punctuation">(</span><span class="token keyword">double</span> m<span class="token punctuation">,</span> <span class="token keyword">double</span> sqrtV<span class="token punctuation">,</span> <span class="token keyword">double</span> lo<span class="token punctuation">,</span> <span class="token keyword">double</span> hi<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>lo <span class="token operator">==</span> hi<span class="token punctuation">)</span>            <span class="token keyword">return</span> lo<span class="token punctuation">;</span>        <span class="token keyword">double</span> res<span class="token punctuation">;</span>        Random rand <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">do</span> <span class="token punctuation">{</span>            res <span class="token operator">=</span> rand<span class="token punctuation">.</span><span class="token function">nextGaussian</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> sqrtV <span class="token operator">+</span> m<span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span>res <span class="token operator">&lt;</span> lo <span class="token operator">||</span> res <span class="token operator">></span> hi<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        LuckyMoney money <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LuckyMoney</span><span class="token punctuation">(</span><span class="token number">100.0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Start to distribute "</span> <span class="token operator">+</span> money<span class="token punctuation">.</span>totalMoney <span class="token operator">+</span> <span class="token string">" to "</span> <span class="token operator">+</span> money<span class="token punctuation">.</span>totalSize <span class="token operator">+</span> <span class="token string">" people."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        GetLuckyMoney test <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GetLuckyMoney</span><span class="token punctuation">(</span>money<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>            <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>输出：</p><pre class="line-numbers language-java"><code class="language-java">Start to distribute <span class="token number">100.0</span> to <span class="token number">10</span> people<span class="token punctuation">.</span>Man <span class="token number">1</span> get <span class="token number">7.58</span>Man <span class="token number">2</span> get <span class="token number">3.19</span>Man <span class="token number">3</span> get <span class="token number">16.73</span>Man <span class="token number">4</span> get <span class="token number">11.79</span>Man <span class="token number">5</span> get <span class="token number">6.53</span>Man <span class="token number">6</span> get <span class="token number">7.53</span>Man <span class="token number">7</span> get <span class="token number">13.45</span>Man <span class="token number">8</span> get <span class="token number">1.92</span>Man <span class="token number">9</span> get <span class="token number">3.62</span>Man <span class="token number">10</span> get <span class="token number">27.66</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="关于提高代码可读性的建议"><a href="#关于提高代码可读性的建议" class="headerlink" title="关于提高代码可读性的建议"></a>关于提高代码可读性的建议</h3><ul><li>避免一行一注释，减少注释冗余。</li><li>命名方案一致。</li><li>不重复写相同代码。</li><li>避免层数过深的逻辑。</li><li>限制每行长度。</li><li>一致的临时变量命名。比如都用<code>i</code>。</li><li>加入块注释，例如：</li></ul><pre class="line-numbers language-java"><code class="language-java">    <span class="token comment" spellcheck="true">/**     * Return a truncated normal distribution N(m, v) between [lo, hi].     * @param m:            mean of normal distribution     * @param sqrtV:    square of variance of normal distribution     * @param lo:            lower bound of truncation     * @param hi:         upper bound of truncation     * @return round value of truncated normal distribution.     */</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">truncatedNorm</span><span class="token punctuation">(</span><span class="token keyword">int</span> m<span class="token punctuation">,</span> <span class="token keyword">int</span> sqrtV<span class="token punctuation">,</span> <span class="token keyword">int</span> lo<span class="token punctuation">,</span> <span class="token keyword">int</span> hi<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>lo <span class="token operator">==</span> hi<span class="token punctuation">)</span>            <span class="token keyword">return</span> lo<span class="token punctuation">;</span>        <span class="token keyword">int</span> res<span class="token punctuation">;</span>        Random rand <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">do</span> <span class="token punctuation">{</span>            res <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>rand<span class="token punctuation">.</span><span class="token function">nextGaussian</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> sqrtV<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span>res <span class="token operator">&lt;</span> lo <span class="token operator">||</span> res <span class="token operator">></span> hi<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token comment" spellcheck="true">// ...</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> interview </category>
          
      </categories>
      
      
        <tags>
            
            <tag> array </tag>
            
            <tag> random </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>19届图森杯划水经历</title>
      <link href="/19%E5%B1%8A%E5%9B%BE%E6%A3%AE%E6%9D%AF%E5%88%92%E6%B0%B4%E7%BB%8F%E5%8E%86/"/>
      <url>/19%E5%B1%8A%E5%9B%BE%E6%A3%AE%E6%9D%AF%E5%88%92%E6%B0%B4%E7%BB%8F%E5%8E%86/</url>
      
        <content type="html"><![CDATA[<p>⚠️流水账警告⚠️</p><p>因为大三时间比较自由，我和两个关系比较好的同学报了图森杯（acm校赛选拔），然后因为没有准备所以变成了丢人现场……另外两个同学不想去，最后变成我一个人单刷(´･ω･`)喵喵喵？</p><p>不过单刷也有单刷的好处嘛，至少我划水不用有心里负担。体验体验这种感觉也是不错滴。</p><p>于是我愉快地睡过了上午的签到……（其实是前一天<s>打铁</s>只狼太晚了，唉破罐子破摔）好在让一个学长帮忙签到了，除了没有试机以外问题不大。</p><p>于是下午我佛系地到考场，结果还遇到些麻烦——平时刷oj用的都是java，intelliJ美滋滋，但是在这里只有eclipse能用，机房的intellij竟然连java环境都没有配好。想了想写c++还要用dev-c++那种手感，还是拿eclipse凑活。</p><p>（事实证明c++才是刷oj的王道啊）</p><h3 id="以下正式开始做题："><a href="#以下正式开始做题：" class="headerlink" title="以下正式开始做题："></a>以下正式开始做题：</h3><p>我慢悠悠地调试了一会，感觉ok了，于是看了一下提交界面，找了一下最简单的题——怎么看呢，就是提交人数最多的题——然后看了下是题E：portion（<a href="http://acm.zju.edu.cn/onlinejudge/showContestProblem.do?problemId=5973），嗯没什么好说的，正经签到题，写完就ac。其实我更好奇一些单词的意思，奈何机房的win7没法像mac一样查字典。">http://acm.zju.edu.cn/onlinejudge/showContestProblem.do?problemId=5973），嗯没什么好说的，正经签到题，写完就ac。其实我更好奇一些单词的意思，奈何机房的win7没法像mac一样查字典。</a></p><p>接下来嘛，继续看大家做什么，我就跟着做什么。接下来的题也没啥意思，甚至很迷：</p><p>J题：Extended Twin Composite Number（<a href="http://acm.zju.edu.cn/onlinejudge/showContestProblem.do?problemId=5977），讲的是给定整数n，要求两个合数x和y，x+n=y。第一反应，让x=2*n就行了呗，一看x和y范围是1e18，n范围是1e9，这么做应该没问题。半信半疑地提交了，这么简单？？">http://acm.zju.edu.cn/onlinejudge/showContestProblem.do?problemId=5977），讲的是给定整数n，要求两个合数x和y，x+n=y。第一反应，让x=2*n就行了呗，一看x和y范围是1e18，n范围是1e9，这么做应该没问题。半信半疑地提交了，这么简单？？</a></p><p>结果wa。我就纳闷了，什么？这难道不对嘛？立刻回去找答案看是不是我忽略了什么要求，看了一下sample，难道x要比n小？也没说呀。</p><p>emmm想了一会之后，决定先不管它，去做另一个热度很高的题：</p><p>G题：Postman（<a href="http://acm.zju.edu.cn/onlinejudge/showContestProblem.do?problemId=5975）。这题讲的是邮差在数轴上走，从邮局（坐标0）出发，到指定n个目的地送信的最短距离。每次最多携带k封信。">http://acm.zju.edu.cn/onlinejudge/showContestProblem.do?problemId=5975）。这题讲的是邮差在数轴上走，从邮局（坐标0）出发，到指定n个目的地送信的最短距离。每次最多携带k封信。</a></p><p>这题真心不难。看了一下样例就心里有数，首先排序目的地，把正负分开算，然后从每一极向0分割出送信个数为k的区间，算作一次送信（即从绝对值大的一侧往里数k个而不是反过来），每个块最大的距离乘2就是这一个块送信的距离。</p><p>然后最后结果减去最大的那一极的绝对值，因为最后不需要回到邮局所以走到最远的地方就不用回来了，把刚才考虑的来回去掉一半。</p><p>满心欢喜地提交想着这下也差不多算不亏了，结果TLE。(´･ω･`)喵喵喵？</p><p>不会吧？排个序就超时？难道目标算法是线性的？可我看那么多人都过了这题呀……</p><h3 id="可达鸭眉头一皱发现事情并不简单。"><a href="#可达鸭眉头一皱发现事情并不简单。" class="headerlink" title="可达鸭眉头一皱发现事情并不简单。"></a>可达鸭眉头一皱发现事情并不简单。</h3><p>苦思冥想没有线性方案，我开始慌了。周围环境十分吵闹，开场已经一个多小时，我一度有退场的打算——太丢人了，我现在也才一个气球。</p><p>对面的小哥也是单刷，拿到一个气球之后默默地离开了。可能也是来体验一下的吧……</p><p>我又刷新了一下排行榜，没怎么变，做A题的人稍有增加。粗粗一看是二分图匹配，打扰了打扰了。匈牙利算法没背过呀，况且也不知道怎么套求权函数，不然大概要用dp？我只想到dfs+回溯的方法，怕是和八皇后一样复杂。害怕TLE就没做下去……也许这是本场比赛最大的失误吧。</p><p>转了一圈还是想从这两个简单题入手。</p><p>回到J题，我心里想的是可能真的有限制吧，虽然说是1e18但是限制1e9这样子，所以wa了？</p><p>那我不妨优化一下。</p><p>其实，如果n是偶数，那么我只要也取偶数，很容易就能达到目标。所以取x=4，y=n+4。</p><p>那么……奇数？</p><p>奇数不妨凑3的倍数？对三取余，剩下0那我就用6加，剩下1我就用8加，剩下2我就用4加，这样y肯定是三的倍数。</p><p>这样一写一提交，竟然ac了！这个是个振奋的信号，让我恢复精神继续怼G题了。</p><p>这个时候大概两个小时过去了。</p><p>然而，我接下来不管怎么怼G，始终发现：</p><h3 id="它就是没法改进了。"><a href="#它就是没法改进了。" class="headerlink" title="它就是没法改进了。"></a>它就是没法改进了。</h3><p>然而始终是TLE，心态又不好了。这个时候，周围有人的讨论、欢呼，此起彼伏的键盘声，以及换座位的响动，无一不在干扰心神。我佛了。。只好转战其他题目。</p><p>转了半天，发现这个B题：Even Number Theory（<a href="http://acm.zju.edu.cn/onlinejudge/showContestProblem.do?problemId=5970）还有点思路，于是开始写数字找规律。">http://acm.zju.edu.cn/onlinejudge/showContestProblem.do?problemId=5970）还有点思路，于是开始写数字找规律。</a></p><p>问题是求偶数n的双阶乘的偶质数分解——偶质数分解是我自己口胡的词，就是一个由2和某奇数相乘的到的数——这样的最大分解有几个。n可达1e1000，看来肯定是数学优化问题，估计有公式。</p><p>双阶乘进行质因数分解，自然就是所有不大于它的偶数的偶质数因子个数相加咯。</p><p>我写了一下，找到初步规律：</p><p>偶数序列：2，4，6，8，10，12，14，16，18，20，22，24，26，28，30，……</p><p>分解个数：1，2，1，3，1，2，1，4，1，2，1，3，1，2，1，……</p><p>我立刻看到一个循环节，12131214……没多想就写了一个简单公式，每16就增加（1+2+1+3+1+2+1+4）个数，而不足16再加单独的和。</p><p>然后因为是1e1000，所以用BigInteger类来操作。幸运的是在code jam早就接触了这个类所以遇到的时候自然而然就想到了。</p><p>一切都看起来很完美，于是提交，wa！</p><p>我有些困惑，于是继续写数字——哇，32对应的不是4而是5诶（16对应的是4，而32=2*16，对所以应5），那就不是循环了。有些挫败的我安慰自己说，没关系反正提交次数不太重要，做出来就可以了。</p><p>于是我开始找规律。结果这个规律还真不明显……循环又不是，但是说它增长有规律我也是不信的。</p><p>干脆采取O(n)递推？可以，但是这么做……你确定不会爆栈？？时间复杂度肯定也会超的吧……</p><p>绝望……</p><p>后来又切了几道，然并卵。</p><p>就这样僵持到了结束也没有A出下一题……</p><h3 id="我好菜呀……"><a href="#我好菜呀……" class="headerlink" title="我好菜呀……"></a>我好菜呀……</h3><p>事后和咕咕的队友讨论了一下，队友拿着逻辑完全一致，但是用cpp写的代码一次就ac了，啥玩意……</p><p>有人说，java读输入要用这个：</p><p><code>Scanner sc = new Scanner (new BufferedInputStream(System.in));</code></p><p>然而当我想起要测试一下的时候，已经out of contest time了，于是TLE变成了永远的谜……</p><p>啥都别说了，我也太菜了……这样下去怎么打code jam呀……</p>]]></content>
      
      
      <categories>
          
          <category> competition </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>bash自动化部署脚本</title>
      <link href="/bash%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2%E8%84%9A%E6%9C%AC/"/>
      <url>/bash%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2%E8%84%9A%E6%9C%AC/</url>
      
        <content type="html"><![CDATA[<p>这是18年部署战争游戏时，写自动化部署脚本的一点经验。</p><p>感觉<code>shell</code>写起来和<code>python</code>有点像……</p><h3 id="登录服务器"><a href="#登录服务器" class="headerlink" title="登录服务器"></a>登录服务器</h3><p>开头需要指明使用<code>expect</code>执行脚本，因为这些指令不是<code>bash</code>自带的；</p><p>使用的是<code>spawn</code>指令发送<code>ssh</code>连接请求，然后用<code>expect</code>表示等待对方输出后再做反馈，是一个灵活的指令；</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true">#! /usr/bin/expect</span><span class="token comment" spellcheck="true"># 如果不想明文写在脚本里，可以设置为命令行参数</span><span class="token keyword">set</span> ipaddr <span class="token punctuation">[</span>lindex <span class="token variable">$argv</span> 0<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">set</span> username <span class="token punctuation">[</span>lindex <span class="token variable">$argv</span> 1<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">set</span> password <span class="token punctuation">[</span>lindex <span class="token variable">$argv</span> 2<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">set</span> <span class="token function">timeout</span> 30 <span class="token comment" spellcheck="true"># 超时等待时间</span><span class="token keyword">set</span> prompt <span class="token string">"#"</span> <span class="token comment" spellcheck="true"># 这里是登陆成功的输出，linux简单用#匹配最后一个字符就可以</span>spawn <span class="token function">ssh</span> <span class="token variable">$username@</span><span class="token variable">$ipaddr</span><span class="token function">expect</span> <span class="token punctuation">{</span>    <span class="token string">"yes/no"</span> <span class="token punctuation">{</span> send <span class="token string">"yes\r"</span><span class="token punctuation">;</span> exp_continue <span class="token punctuation">}</span> <span class="token comment" spellcheck="true"># 继续执行expect语句</span>    <span class="token string">"*assword"</span> <span class="token punctuation">{</span> send <span class="token string">"<span class="token variable">$password</span>\r"</span> <span class="token punctuation">}</span> <span class="token comment" spellcheck="true"># 密码输入提示，忽略p大小写</span>    <span class="token string">"Permission denied*"</span> <span class="token punctuation">{</span> <span class="token keyword">exit</span> <span class="token punctuation">}</span> <span class="token comment" spellcheck="true"># 密码错误</span>    <span class="token function">timeout</span> <span class="token punctuation">{</span> puts <span class="token string">"Timed out during login"</span><span class="token punctuation">;</span> <span class="token keyword">exit</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token function">expect</span> <span class="token string">"<span class="token variable">$prompt</span>"</span>interact <span class="token comment" spellcheck="true"># 交还控制权</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>进入服务器后执行指令要用<code>send</code>指令。</p><p>结束时，如果把权限交还用户则需要用<code>interact</code>。</p><pre class="line-numbers language-shell"><code class="language-shell"># ...# 结束连接send "exit\r"<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="文件指令"><a href="#文件指令" class="headerlink" title="文件指令"></a>文件指令</h3><p>文件主要使用<code>scp</code>指令进行本地和远程的传输。它是<code>seccure copy</code>的缩写，和<code>cp</code>比较区别在于，前者可以远程传输，而且是加密的；后者只能本机移动。</p><p>以文件上传到远程服务器为例，展示具体使用格式（下一步要输入密码）：</p><pre class="line-numbers language-shell"><code class="language-shell"># 复制单个文件scp $file $username@$ipaddr:$remote_folder# 递归复制整个目录scp -r $folder $username@$ipaddr:$remote_folder<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>在脚本中，我们使用<code>expect</code>模块执行<code>scp</code>指令：</p><pre class="line-numbers language-shell"><code class="language-shell">#! /usr/bin/expect# 复制文件spawn scp $file $username@$ipaddr:$remote_folderexpect {  "yes/no" { send "yes\r"; exp_continue }  "*assword" { send "$password\r" }  timeout { exit }}# 等待传输结束expect "100%"expect eof<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>对文件夹，只需要把上面<code>spawn scp $file $username…</code>改成<code>spawn scp -r $folder $username…</code>即可。</p><h3 id="启动服务"><a href="#启动服务" class="headerlink" title="启动服务"></a>启动服务</h3><p>需要提前在服务器修改nginx配置，并配置好本地python环境（gunicorn+flask等等）。</p><p>这个没什么好说的，常规启动服务即可。</p><pre class="line-numbers language-shell"><code class="language-shell">send "kill -9 $(pidof gunicorn)"send "nginx -s restart && nohup gunicorn -w 1 -b 127.0.0.1:8080 main:app -D"<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>有关部署的细节，详见<a href="https://riroaki.github.io/2019/03/28/Linux%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%EF%BC%9AFlask-gunicorn-nginx/">另一篇文章</a>。</p><p>总体代码：</p><pre class="line-numbers language-shell"><code class="language-shell">#! /usr/bin/expect# 如果不想明文写在脚本里，可以设置为命令行参数set ipaddr [lindex $argv 0];set username [lindex $argv 1];set password [lindex $argv 2];set folder "./war"set remote_folder "~/war"set timeout 30# 复制文件spawn scp $file $username@$ipaddr:$remote_folderexpect {  "yes/no" { send "yes\r"; exp_continue }  "*assword" { send "$password\r" }  timeout { exit }}# 等待传输结束expect "100%"expect eofspawn ssh $username@$ipaddrexpect {    "yes/no" { send "yes\r"; exp_continue } # 继续执行expect语句    "*assword" { send "$password\r" } # 密码输入提示，忽略p大小写    "Permission denied*" { exit } # 密码错误    timeout { puts "Timed out during login"; exit }}expect "#"# 运行send "kill -9 $(pidof gunicorn)\r"send "nginx -s restart && cd ~/war/ && nohup gunicorn -w 1 -b 127.0.0.1:8080 main:app -D\r"<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> back end </category>
          
      </categories>
      
      
        <tags>
            
            <tag> shell </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Easy Painter-iOS绘图实例</title>
      <link href="/EasyPainter-iOS%E7%BB%98%E5%9B%BE%E5%AE%9E%E4%BE%8B/"/>
      <url>/EasyPainter-iOS%E7%BB%98%E5%9B%BE%E5%AE%9E%E4%BE%8B/</url>
      
        <content type="html"><![CDATA[<p>这是去年刚接触iOS编程的时候，入门做的一点小项目——第一个是一个支持多种颜色的画板，第二个是玩纪念碑谷2之后，模仿每一关最后的部分实现的画画功能。</p><a id="more"></a><p>先看一下效果图：</p><h3 id="画板"><a href="#画板" class="headerlink" title="画板"></a>画板</h3><p>可以实现多种颜色和阴影，清空画版、分享绘画等等。</p><p><img src="/EasyPainter-iOS绘图实例/board.JPG" alt></p><h3 id="纪念碑谷"><a href="#纪念碑谷" class="headerlink" title="纪念碑谷"></a>纪念碑谷</h3><p>很直观的效果，画笔有多种样式：</p><ul><li>直接绘制，表现为对称的白色线条（这是纪念碑谷中的效果——除了没有发光以外）</li></ul><p><img src="/EasyPainter-iOS绘图实例/white.png" alt></p><ul><li>后来觉得线条太单调，于是增加了绘制树叶</li></ul><p><img src="/EasyPainter-iOS绘图实例/tree.png" alt></p><ul><li>我又加入了多种颜色～</li></ul><p><img src="/EasyPainter-iOS绘图实例/colorful.png" alt></p><h2 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h2><p>占坑，待补充。</p>]]></content>
      
      
      <categories>
          
          <category> front end </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NLP学习日记1——Set Expan</title>
      <link href="/NLP-1-Set-Expan/"/>
      <url>/NLP-1-Set-Expan/</url>
      
        <content type="html"><![CDATA[<p>说来惭愧，其实这是上个学期初实验室的老师布置下来的任务，直到今天才开始认真接触。</p><p>NLP应当是未来大势之一——在视觉、语音等方面已经能够做到炉火纯青的ML和DL，在NLP领域进展却比较慢，可以说是在日渐饱和的AI领域为数不多的未被探索完全的领域了。</p><p>词集拓展的概念和做法来自一篇论文：《SetExpan- Corpus-Based Set Expansion via Context Feature Selection and Rank Ensemble》，指的是根据一些词集种子，从语料库中摘取同一类的词语。作者采用的是英文词语，源代码在<a href="https://github.com/mickeystroller/SetExpan">这里</a>。</p><p>这个方法说来简单，但是实际做起来并不容易。简单的上下文提取和匹配如果做不好，很容易出现语义漂移的现象，即同一个上下文抽取的词却不一样。</p><p>此外，中文本身的分词难度也为项目带来困难。</p><p>而且分类是重要的一步，为之后建立知识图谱、挖掘联系等等都具有基础性意义。</p><p>那么首先我们来分析一下论文讲的方法。</p><h2 id="理论部分"><a href="#理论部分" class="headerlink" title="理论部分"></a>理论部分</h2><p>所谓词集拓展，就是将一个小的词语集合（如几个国家名称），从语料库拓展到文章中所有的国家名称。</p><p>目前现有的基于小初始集的无监督词集拓展主要包括两种：</p><ol><li>基于和已有实体的分布相似性，一次性提取全部实体<ul><li>盲目地使用所有这些特征可能将不期望的实体引入扩展集合中，因为许多上下文特征不代表用于定义目标语义类，尽管它们确实与一些种子实体具有连接。比如国家和地区都可以接在“位于”之后，容易混为一谈。</li></ul></li><li>迭代性提取模式，用每次带来的新模式进行提取，不断加入词集<ul><li>依靠每次迭代得到的词集质量。由于文本的非结构化以及噪声存在，很难有完美的评分机制。</li><li>需要注意：实体入侵（实体质量不佳）、语义漂移（模式质量不佳）</li></ul></li></ol><p>还有一种取巧的办法，Google Set，即每次从谷歌搜索引擎中搜索关键词，然后提取前面几页搜索结果的关联关键词。这种办法质量不错但是需要在线连接，成本较高。在这里我们实现一种离线的词集拓展。</p><p>这里需要描述的工作是：</p><ol><li>一种迭代集扩展框架，采用新颖的上下文特征选择方法，处理实体入侵和语义漂移问题; </li><li>一种基于无监督排序的集成算法，用于实体选择，使我们的系统具有鲁棒性，进一步降低了语义漂移的影响。</li></ol><p>好，开始描述具体过程：</p><h3 id="模式建立"><a href="#模式建立" class="headerlink" title="模式建立"></a>模式建立</h3><p>针对单词集中的每个单词构建一个模式。</p><p>（待续）</p><h3 id="模式评估"><a href="#模式评估" class="headerlink" title="模式评估"></a>模式评估</h3><p>（待续）</p>]]></content>
      
      
      <categories>
          
          <category> machine learning </category>
          
      </categories>
      
      
        <tags>
            
            <tag> NLP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>41.First Missing Positive</title>
      <link href="/41-First-Missing-Positive/"/>
      <url>/41-First-Missing-Positive/</url>
      
        <content type="html"><![CDATA[<h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p>Given an unsorted integer array, find the smallest missing positive integer.</p><a id="more"></a><p><strong>Example 1:</strong></p><pre><code>Input: [1,2,0]Output: 3</code></pre><p><strong>Example 2:</strong></p><pre><code>Input: [3,4,-1,1]Output: 2</code></pre><p><strong>Example 3:</strong></p><pre><code>Input: [7,8,9,11,12]Output: 1</code></pre><p><strong>Note:</strong></p><p>Your algorithm should run in <em>O</em>(<em>n</em>) time and uses constant extra space.</p><h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><h4 id="联想merge-interval"><a href="#联想merge-interval" class="headerlink" title="联想merge interval"></a>联想merge interval</h4><p>虽然不是常数空间的算法，但是时间复杂度是线性的。</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">{</span>    <span class="token keyword">class</span> <span class="token class-name">Interval</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> left<span class="token punctuation">,</span> right<span class="token punctuation">;</span>        <span class="token function">Interval</span><span class="token punctuation">(</span><span class="token keyword">int</span> l<span class="token punctuation">,</span> <span class="token keyword">int</span> r<span class="token punctuation">)</span> <span class="token punctuation">{</span>            left <span class="token operator">=</span> l<span class="token punctuation">;</span>            right <span class="token operator">=</span> r<span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">firstMissingPositive</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">)</span> <span class="token punctuation">{</span>        Arrays<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span>nums<span class="token punctuation">)</span><span class="token punctuation">;</span>        List<span class="token operator">&lt;</span>Interval<span class="token operator">></span> intervalList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> num <span class="token operator">:</span> nums<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>num <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span>                <span class="token keyword">continue</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>intervalList<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                intervalList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Interval</span><span class="token punctuation">(</span>num<span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">else</span> <span class="token punctuation">{</span>                Interval tmp <span class="token operator">=</span> intervalList<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>intervalList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>tmp<span class="token punctuation">.</span>right <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">==</span> num<span class="token punctuation">)</span> <span class="token punctuation">{</span>                    tmp<span class="token punctuation">.</span>right<span class="token operator">++</span><span class="token punctuation">;</span>                    intervalList<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>intervalList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> tmp<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>tmp<span class="token punctuation">.</span>right <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">&lt;</span> num<span class="token punctuation">)</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>intervalList<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">||</span> intervalList<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>left <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> intervalList<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>intervalList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>right <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(n)$</li><li>空间复杂度：$O(n)$</li></ul><h4 id="常数空间的做法：交换"><a href="#常数空间的做法：交换" class="headerlink" title="常数空间的做法：交换"></a>常数空间的做法：交换</h4><p>首先，总共有n个数 ，那么缺失的数最大也是<code>n+1</code>，不然就是<code>1-n</code>中间的数。</p><p>假如我们让所有数归位（即，尽量让所有的数满足<code>a[i] = i + 1</code>）</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">firstMissingPositive</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">int</span> n <span class="token operator">=</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">,</span> res <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>          <span class="token comment" spellcheck="true">// 注意这个是循环不是一次判断！</span>          <span class="token comment" spellcheck="true">// 最后一个判断条件是必要的，在[1, 1]情况下就会死循环</span>        <span class="token keyword">while</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;=</span> n               <span class="token operator">&amp;&amp;</span> nums<span class="token punctuation">[</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">!=</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">int</span> tmp <span class="token operator">=</span> nums<span class="token punctuation">[</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            nums<span class="token punctuation">[</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>            nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> tmp<span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(n)$，别看是两层循环，但是每一次交换都能够保证至少一个数归位，所以总共最多只需要交换n次。</li><li>空间复杂度：$O(1)$</li></ul>]]></content>
      
      
      <categories>
          
          <category> leetcode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> array </tag>
            
            <tag> interval </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>40.Combination Sum II</title>
      <link href="/40-Combination-Sum-II/"/>
      <url>/40-Combination-Sum-II/</url>
      
        <content type="html"><![CDATA[<h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p>Given a collection of candidate numbers (<code>candidates</code>) and a target number (<code>target</code>), find all unique combinations in <code>candidates</code> where the candidate numbers sums to <code>target</code>.</p><p>Each number in <code>candidates</code> may only be used <strong>once</strong> in the combination.</p><p><strong>Note:</strong></p><ul><li>All numbers (including <code>target</code>) will be positive integers.</li><li>The solution set must not contain duplicate combinations.</li></ul><a id="more"></a><p><strong>Example 1:</strong></p><pre><code>Input: candidates = [10,1,2,7,6,1,5], target = 8,A solution set is:[  [1, 7],  [1, 2, 5],  [2, 6],  [1, 1, 6]]</code></pre><p><strong>Example 2:</strong></p><pre><code>Input: candidates = [2,5,2,1,2], target = 5,A solution set is:[  [1,2,2],  [5]]</code></pre><h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><h4 id="回溯-dfs"><a href="#回溯-dfs" class="headerlink" title="回溯+dfs"></a>回溯+dfs</h4><p>和上题类似但是允许重复元素使用。</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> List<span class="token operator">&lt;</span>List<span class="token operator">&lt;</span>Integer<span class="token operator">>></span> res<span class="token punctuation">;</span>    <span class="token keyword">public</span> List<span class="token operator">&lt;</span>List<span class="token operator">&lt;</span>Integer<span class="token operator">>></span> <span class="token function">combinationSum2</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">,</span> <span class="token keyword">int</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>        Arrays<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span>nums<span class="token punctuation">)</span><span class="token punctuation">;</span>        res <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">backTrack</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nums<span class="token punctuation">,</span> target<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">backTrack</span><span class="token punctuation">(</span>List<span class="token operator">&lt;</span>Integer<span class="token operator">></span> curr<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">,</span> <span class="token keyword">int</span> target<span class="token punctuation">,</span> <span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>target <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>            <span class="token keyword">return</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>target <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            res<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span>curr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> index<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">></span> index <span class="token operator">&amp;&amp;</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> nums<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>                <span class="token keyword">continue</span><span class="token punctuation">;</span>            curr<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">backTrack</span><span class="token punctuation">(</span>curr<span class="token punctuation">,</span> nums<span class="token punctuation">,</span> target <span class="token operator">-</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            curr<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>curr<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(n^{m/avg(n)})$</li><li>空间复杂度：$O(mn^{m/avg(n)})$</li></ul>]]></content>
      
      
      <categories>
          
          <category> leetcode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> array </tag>
            
            <tag> backtracking </tag>
            
            <tag> dfs </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>39.Combination Sum</title>
      <link href="/39-Combination-Sum/"/>
      <url>/39-Combination-Sum/</url>
      
        <content type="html"><![CDATA[<h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p>Given a <strong>set</strong> of candidate numbers (<code>candidates</code>) <strong>(without duplicates)</strong> and a target number (<code>target</code>), find all unique combinations in <code>candidates</code> where the candidate numbers sums to <code>target</code>.</p><p>The <strong>same</strong> repeated number may be chosen from <code>candidates</code> unlimited number of times.</p><p><strong>Note:</strong></p><ul><li>All numbers (including <code>target</code>) will be positive integers.</li><li>The solution set must not contain duplicate combinations.</li></ul><a id="more"></a><p><strong>Example 1:</strong></p><pre><code>Input: candidates = [2,3,6,7], target = 7,A solution set is:[  [7],  [2,2,3]]</code></pre><p><strong>Example 2:</strong></p><pre><code>Input: candidates = [2,3,5], target = 8,A solution set is:[  [2,2,2,2],  [2,3,3],  [3,5]]</code></pre><h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><h4 id="回溯-dfs"><a href="#回溯-dfs" class="headerlink" title="回溯+dfs"></a>回溯+dfs</h4><p>理论上有2的n种可能；</p><p>排序保证unique。</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> List<span class="token operator">&lt;</span>List<span class="token operator">&lt;</span>Integer<span class="token operator">>></span> <span class="token function">combinationSum</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> candidates<span class="token punctuation">,</span> <span class="token keyword">int</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>candidates <span class="token operator">==</span> null <span class="token operator">||</span> candidates<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>          <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token function">helper</span><span class="token punctuation">(</span>candidates<span class="token punctuation">,</span> target<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">private</span> List<span class="token operator">&lt;</span>List<span class="token operator">&lt;</span>Integer<span class="token operator">>></span> <span class="token function">helper</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> candidates<span class="token punctuation">,</span> <span class="token keyword">int</span> target<span class="token punctuation">,</span> <span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span>    List<span class="token operator">&lt;</span>List<span class="token operator">&lt;</span>Integer<span class="token operator">>></span> res <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>target <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>          <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> index<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> candidates<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>candidates<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>            List<span class="token operator">&lt;</span>Integer<span class="token operator">></span> tmp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            tmp<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>candidates<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            res<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>candidates<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>            List<span class="token operator">&lt;</span>List<span class="token operator">&lt;</span>Integer<span class="token operator">>></span> tmp <span class="token operator">=</span> <span class="token function">helper</span><span class="token punctuation">(</span>candidates<span class="token punctuation">,</span> target <span class="token operator">-</span> candidates<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>tmp<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">for</span> <span class="token punctuation">(</span>List<span class="token operator">&lt;</span>Integer<span class="token operator">></span> vec <span class="token operator">:</span> tmp<span class="token punctuation">)</span>                      vec<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>candidates<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                res<span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> res<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(2^n)$</li><li>空间复杂度：$O(2^n)$</li></ul>]]></content>
      
      
      <categories>
          
          <category> leetcode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> array </tag>
            
            <tag> backtracking </tag>
            
            <tag> dfs </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>38.Count and Say</title>
      <link href="/38-Count-and-Say/"/>
      <url>/38-Count-and-Say/</url>
      
        <content type="html"><![CDATA[<h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p>The count-and-say sequence is the sequence of integers with the first five terms as following:</p><pre><code>1.     12.     113.     214.     12115.     111221</code></pre><p><code>1</code> is read off as <code>&quot;one 1&quot;</code> or <code>11</code>.<br><code>11</code> is read off as <code>&quot;two 1s&quot;</code> or <code>21</code>.<br><code>21</code> is read off as <code>&quot;one 2</code>, then <code>one 1&quot;</code> or <code>1211</code>.</p><p>Given an integer <em>n</em> where 1 ≤ <em>n</em> ≤ 30, generate the <em>n</em>th term of the count-and-say sequence.</p><p>Note: Each term of the sequence of integers will be represented as a string.</p> <a id="more"></a><p><strong>Example 1:</strong></p><pre><code>Input: 1Output: &quot;1&quot;</code></pre><p><strong>Example 2:</strong></p><pre><code>Input: 4Output: &quot;1211&quot;</code></pre><h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><h4 id="常规做法"><a href="#常规做法" class="headerlink" title="常规做法"></a>常规做法</h4><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> String <span class="token function">countAndSay</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>    String s <span class="token operator">=</span> <span class="token string">"1"</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        StringBuilder sb <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">char</span> count <span class="token operator">=</span> <span class="token string">'1'</span><span class="token punctuation">;</span>            <span class="token keyword">while</span><span class="token punctuation">(</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token operator">&lt;</span>s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token operator">==</span>s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                count<span class="token operator">++</span><span class="token punctuation">;</span>                j<span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>            sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        s <span class="token operator">=</span> sb<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// System.out.println(s);</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> s<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(n^2)$</li><li>空间复杂度：$O(n)$</li></ul>]]></content>
      
      
      <categories>
          
          <category> leetcode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> easy </tag>
            
            <tag> string </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>36.Valid Sudoku</title>
      <link href="/36-Valid-Sudoku/"/>
      <url>/36-Valid-Sudoku/</url>
      
        <content type="html"><![CDATA[<h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p>Determine if a 9x9 Sudoku board is valid. Only the filled cells need to be validated <strong>according to the following rules</strong>:</p><ol><li>Each row must contain the digits <code>1-9</code> without repetition.</li><li>Each column must contain the digits <code>1-9</code> without repetition.</li><li>Each of the 9 <code>3x3</code> sub-boxes of the grid must contain the digits <code>1-9</code> without repetition.</li></ol><p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/ff/Sudoku-by-L2G-20050714.svg/250px-Sudoku-by-L2G-20050714.svg.png" alt="img"><br>A partially filled sudoku which is valid.</p><p>The Sudoku board could be partially filled, where empty cells are filled with the character <code>&#39;.&#39;</code>.</p><a id="more"></a><p><strong>Example 1:</strong></p><pre><code>Input:[  [&quot;5&quot;,&quot;3&quot;,&quot;.&quot;,&quot;.&quot;,&quot;7&quot;,&quot;.&quot;,&quot;.&quot;,&quot;.&quot;,&quot;.&quot;],  [&quot;6&quot;,&quot;.&quot;,&quot;.&quot;,&quot;1&quot;,&quot;9&quot;,&quot;5&quot;,&quot;.&quot;,&quot;.&quot;,&quot;.&quot;],  [&quot;.&quot;,&quot;9&quot;,&quot;8&quot;,&quot;.&quot;,&quot;.&quot;,&quot;.&quot;,&quot;.&quot;,&quot;6&quot;,&quot;.&quot;],  [&quot;8&quot;,&quot;.&quot;,&quot;.&quot;,&quot;.&quot;,&quot;6&quot;,&quot;.&quot;,&quot;.&quot;,&quot;.&quot;,&quot;3&quot;],  [&quot;4&quot;,&quot;.&quot;,&quot;.&quot;,&quot;8&quot;,&quot;.&quot;,&quot;3&quot;,&quot;.&quot;,&quot;.&quot;,&quot;1&quot;],  [&quot;7&quot;,&quot;.&quot;,&quot;.&quot;,&quot;.&quot;,&quot;2&quot;,&quot;.&quot;,&quot;.&quot;,&quot;.&quot;,&quot;6&quot;],  [&quot;.&quot;,&quot;6&quot;,&quot;.&quot;,&quot;.&quot;,&quot;.&quot;,&quot;.&quot;,&quot;2&quot;,&quot;8&quot;,&quot;.&quot;],  [&quot;.&quot;,&quot;.&quot;,&quot;.&quot;,&quot;4&quot;,&quot;1&quot;,&quot;9&quot;,&quot;.&quot;,&quot;.&quot;,&quot;5&quot;],  [&quot;.&quot;,&quot;.&quot;,&quot;.&quot;,&quot;.&quot;,&quot;8&quot;,&quot;.&quot;,&quot;.&quot;,&quot;7&quot;,&quot;9&quot;]]Output: true</code></pre><p><strong>Example 2:</strong></p><pre><code>Input:[  [&quot;8&quot;,&quot;3&quot;,&quot;.&quot;,&quot;.&quot;,&quot;7&quot;,&quot;.&quot;,&quot;.&quot;,&quot;.&quot;,&quot;.&quot;],  [&quot;6&quot;,&quot;.&quot;,&quot;.&quot;,&quot;1&quot;,&quot;9&quot;,&quot;5&quot;,&quot;.&quot;,&quot;.&quot;,&quot;.&quot;],  [&quot;.&quot;,&quot;9&quot;,&quot;8&quot;,&quot;.&quot;,&quot;.&quot;,&quot;.&quot;,&quot;.&quot;,&quot;6&quot;,&quot;.&quot;],  [&quot;8&quot;,&quot;.&quot;,&quot;.&quot;,&quot;.&quot;,&quot;6&quot;,&quot;.&quot;,&quot;.&quot;,&quot;.&quot;,&quot;3&quot;],  [&quot;4&quot;,&quot;.&quot;,&quot;.&quot;,&quot;8&quot;,&quot;.&quot;,&quot;3&quot;,&quot;.&quot;,&quot;.&quot;,&quot;1&quot;],  [&quot;7&quot;,&quot;.&quot;,&quot;.&quot;,&quot;.&quot;,&quot;2&quot;,&quot;.&quot;,&quot;.&quot;,&quot;.&quot;,&quot;6&quot;],  [&quot;.&quot;,&quot;6&quot;,&quot;.&quot;,&quot;.&quot;,&quot;.&quot;,&quot;.&quot;,&quot;2&quot;,&quot;8&quot;,&quot;.&quot;],  [&quot;.&quot;,&quot;.&quot;,&quot;.&quot;,&quot;4&quot;,&quot;1&quot;,&quot;9&quot;,&quot;.&quot;,&quot;.&quot;,&quot;5&quot;],  [&quot;.&quot;,&quot;.&quot;,&quot;.&quot;,&quot;.&quot;,&quot;8&quot;,&quot;.&quot;,&quot;.&quot;,&quot;7&quot;,&quot;9&quot;]]Output: falseExplanation: Same as Example 1, except with the 5 in the top left corner being     modified to 8. Since there are two 8&#39;s in the top left 3x3 sub-box, it is invalid.</code></pre><p><strong>Note:</strong></p><ul><li>A Sudoku board (partially filled) could be valid but is not necessarily solvable.</li><li>Only the filled cells need to be validated according to the mentioned rules.</li><li>The given board contain only digits <code>1-9</code> and the character <code>&#39;.&#39;</code>.</li><li>The given board size is always <code>9x9</code>.</li></ul><h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><h4 id="分批验证"><a href="#分批验证" class="headerlink" title="分批验证"></a>分批验证</h4><p>按行、列、九宫格验证1～9有且仅有一个即可。</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isValidSudoku</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> board<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> row <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">int</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span> col <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">int</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span> grid <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">int</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">9</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// 分批验证9行，9列以及九宫格块</span>        Arrays<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Arrays<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span>col<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Arrays<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span>grid<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> tmpRowStart <span class="token operator">=</span> i <span class="token operator">-</span> i <span class="token operator">%</span> <span class="token number">3</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> tmpColStart <span class="token operator">=</span> i <span class="token operator">%</span> <span class="token number">3</span> <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">9</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>board<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">'.'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>row<span class="token punctuation">[</span>board<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token string">'0'</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>                      <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>                row<span class="token punctuation">[</span>board<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token string">'0'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>board<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">'.'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>col<span class="token punctuation">[</span>board<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token string">'0'</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>                      <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>                col<span class="token punctuation">[</span>board<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token string">'0'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>board<span class="token punctuation">[</span>tmpRowStart <span class="token operator">+</span> j <span class="token operator">/</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span>tmpColStart <span class="token operator">+</span> j <span class="token operator">%</span> <span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">'.'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>grid<span class="token punctuation">[</span>board<span class="token punctuation">[</span>tmpRowStart <span class="token operator">+</span> j <span class="token operator">/</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span>tmpColStart <span class="token operator">+</span> j <span class="token operator">%</span> <span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token string">'0'</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>                       <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>                grid<span class="token punctuation">[</span>board<span class="token punctuation">[</span>tmpRowStart <span class="token operator">+</span> j <span class="token operator">/</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span>tmpColStart <span class="token operator">+</span> j <span class="token operator">%</span> <span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token string">'0'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(n^2)$</li><li>空间复杂度：$O(n)$</li></ul>]]></content>
      
      
      <categories>
          
          <category> leetcode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> array </tag>
            
            <tag> medium </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>35.Search Insert Position</title>
      <link href="/35-Search-Insert-Position/"/>
      <url>/35-Search-Insert-Position/</url>
      
        <content type="html"><![CDATA[<h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p>Given a sorted array and a target value, return the index if the target is found. If not, return the index where it would be if it were inserted in order.</p><p>You may assume no duplicates in the array.</p><a id="more"></a><p><strong>Example 1:</strong></p><pre><code>Input: [1,3,5,6], 5Output: 2</code></pre><p><strong>Example 2:</strong></p><pre><code>Input: [1,3,5,6], 2Output: 1</code></pre><p><strong>Example 3:</strong></p><pre><code>Input: [1,3,5,6], 7Output: 4</code></pre><p><strong>Example 4:</strong></p><pre><code>Input: [1,3,5,6], 0Output: 0</code></pre><h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><h3 id="二分"><a href="#二分" class="headerlink" title="二分"></a>二分</h3><p>啥也别说了，就这样。</p><pre class="line-numbers language-python"><code class="language-python">public int searchInsert<span class="token punctuation">(</span>int<span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">,</span> int target<span class="token punctuation">)</span> <span class="token punctuation">{</span>    int lo <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> hi <span class="token operator">=</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>lo <span class="token operator">&lt;</span> hi<span class="token punctuation">)</span> <span class="token punctuation">{</span>        int mi <span class="token operator">=</span> lo <span class="token operator">+</span> <span class="token punctuation">(</span>hi <span class="token operator">-</span> lo<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>nums<span class="token punctuation">[</span>mi<span class="token punctuation">]</span> <span class="token operator">&lt;</span> target<span class="token punctuation">)</span>            lo <span class="token operator">=</span> mi <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">else</span>            hi <span class="token operator">=</span> mi<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> lo<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(log(n))​$</li><li>空间复杂度：$O(1)$</li></ul>]]></content>
      
      
      <categories>
          
          <category> leetcode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> array </tag>
            
            <tag> easy </tag>
            
            <tag> binary search </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>34.Find First and Last Position of Element in Sorted Array</title>
      <link href="/34-Find-First-and-Last-Position-of-Element-in-Sorted-Array/"/>
      <url>/34-Find-First-and-Last-Position-of-Element-in-Sorted-Array/</url>
      
        <content type="html"><![CDATA[<h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p>Given an array of integers <code>nums</code> sorted in ascending order, find the starting and ending position of a given <code>target</code> value.</p><p>Your algorithm’s runtime complexity must be in the order of <em>O</em>(log <em>n</em>).</p><p>If the target is not found in the array, return <code>[-1, -1]</code>.</p><a id="more"></a><p><strong>Example 1:</strong></p><pre><code>Input: nums = [5,7,7,8,8,10], target = 8Output: [3,4]</code></pre><p><strong>Example 2:</strong></p><pre><code>Input: nums = [5,7,7,8,8,10], target = 6Output: [-1,-1]</code></pre><h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><h4 id="二分查找"><a href="#二分查找" class="headerlink" title="二分查找"></a>二分查找</h4><p>找<code>target + 1</code>的下标，再减1即为<code>target</code>的最后一个下标。</p><ol><li>元素可能不存在。</li><li>找到的元素可能和<code>target</code>相等。</li></ol><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">searchRange</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">,</span> <span class="token keyword">int</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> res <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>nums <span class="token operator">==</span> null <span class="token operator">||</span> nums<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token keyword">int</span> first <span class="token operator">=</span> <span class="token function">bs</span><span class="token punctuation">(</span>nums<span class="token punctuation">,</span> target<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>nums<span class="token punctuation">[</span>first<span class="token punctuation">]</span> <span class="token operator">!=</span> target<span class="token punctuation">)</span>        <span class="token keyword">return</span> res<span class="token punctuation">;</span>    res<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">bs</span><span class="token punctuation">(</span>nums<span class="token punctuation">,</span> target<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> second <span class="token operator">=</span> <span class="token function">bs</span><span class="token punctuation">(</span>nums<span class="token punctuation">,</span> target <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    res<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> nums<span class="token punctuation">[</span>second<span class="token punctuation">]</span> <span class="token operator">==</span> target <span class="token operator">?</span> second <span class="token operator">:</span> second <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> res<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">private</span> <span class="token keyword">int</span> <span class="token function">bs</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">,</span> <span class="token keyword">int</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">int</span> lo <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> hi <span class="token operator">=</span> nums<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>lo <span class="token operator">&lt;</span> hi<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> mi <span class="token operator">=</span> lo <span class="token operator">+</span> <span class="token punctuation">(</span>hi <span class="token operator">-</span> lo<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>nums<span class="token punctuation">[</span>mi<span class="token punctuation">]</span> <span class="token operator">&lt;</span> target<span class="token punctuation">)</span>            lo <span class="token operator">=</span> mi <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">else</span>            hi <span class="token operator">=</span> mi<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> lo<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(log(n))$</li><li>空间复杂度：$O(1)$</li></ul>]]></content>
      
      
      <categories>
          
          <category> leetcode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> array </tag>
            
            <tag> medium </tag>
            
            <tag> binary serch </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ML学习日记6——深度学习入门</title>
      <link href="/ML-6-Intro-to-Deep-Learning/"/>
      <url>/ML-6-Intro-to-Deep-Learning/</url>
      
        <content type="html"><![CDATA[<p>这一课前半部分是在吹水……</p><a id="more"></a><h2 id="DL的前世今生"><a href="#DL的前世今生" class="headerlink" title="DL的前世今生"></a>DL的前世今生</h2><p>1958到1980年dl的发展。1980年的多层网络其实和现在的DNN已经差不多了。区别在于RBM initialization。</p><p>然而过去的研究表示dl并没有很好的效果……层数多的时候可能效果反而差。</p><p>这个模型，当时看来只是石头汤的石头罢了——其实并无大用，甚至还炒作出来许多虚假人工智能的搞笑的故事（和现在似曾相识？哈哈）。</p><p>2009年GPU是一个关键突破，因为加速了deep learning的过程。</p><p>11年语音辨识使用了这项技术，得到了比较好的结果；12年用在图像识别。这项技术终于火了起来。</p><h2 id="正片开始"><a href="#正片开始" class="headerlink" title="正片开始"></a>正片开始</h2><p>回到上一次的内容，DL其实是把许多小的神经通过sigmoid、softmax等等方法连接起来。</p><p>每一层都有自己的bias和weight。</p><p>最简单的连接方式是全连接前向传播神经网络（<em>Fully Connected FeedForward Network</em>）。</p><p>给定了一个网络结构，而没有确定具体参数，那么就是一个<em>function set</em>；假如参数和结构都确定了，那它就是一个函数。</p><p>我们在一般机器学习过程中，所做的事情也是先确定结构——<em>function set</em>，然后通过梯度下降找到最好的参数。</p><p>神经网络结构：</p><p>input layer、deep layer（指的是中间的许多隐层）、output layer</p><p>network具体做的事情其实就是矩阵运算，如图：</p><p><img src="/ML-6-Intro-to-Deep-Learning/matrix.png" alt></p><p>写成矩阵运算的形式，这样就可以可以使用GPU执行并行计算加速计算过程。</p><p><img src="/ML-6-Intro-to-Deep-Learning/matrix2.png" alt></p><h3 id="mnist——手写数字辨识"><a href="#mnist——手写数字辨识" class="headerlink" title="mnist——手写数字辨识"></a>mnist——手写数字辨识</h3><p>input：每个图片的矩阵</p><p>output：10维的one-hot向量</p><ol><li><p>首先，需要决定一个好的<em>function set</em>，即神经网络的结构：</p><ul><li>这一步需要trial&amp;error+intuition</li><li>有一些技巧可以让机器自己确定层数，但是应用暂时不广泛。</li></ul></li><li><p>接下来，找到好的<em>feature</em>，即<em>feature engineering</em>：</p><ul><li>有很多特征不是那么直觉，所以也很难。</li></ul></li><li><p>评估：计算交叉熵</p></li><li>调整：使用梯度下降</li></ol><h3 id="backpropagation反向传播（参数更新过程）"><a href="#backpropagation反向传播（参数更新过程）" class="headerlink" title="backpropagation反向传播（参数更新过程）"></a>backpropagation反向传播（参数更新过程）</h3><p>原理：微分的链式法则。</p><ul><li>每一个神经元更新参数的时候，需要计算<em>loss</em>函数对它的偏微分；</li><li>计算的时候，根据链式法则，继续向下一层寻找与本神经元输出有关的变量的偏微分；</li><li>每一项都依赖下一层，所以计算时从最后向前进行，相当于建立了反向的神经网络进行计算。</li></ul><p><img src="/ML-6-Intro-to-Deep-Learning/backpropagation.png" alt></p><p>总结图如下：</p><p><img src="/ML-6-Intro-to-Deep-Learning/summary.png" alt></p><h2 id="Keras实战——mnist"><a href="#Keras实战——mnist" class="headerlink" title="Keras实战——mnist"></a>Keras实战——mnist</h2><p>Keras集成了tensorflow和theano的库，是在这两个基础库上的更好用的接口。</p><p>在希腊语里面，Keras意味着horn——牛角～</p><p>而mnist作为深度学习界的hello world，自然在这里要写一下：</p><p>记住，深度学习和机器学习一样，分成三个步骤：</p><ul><li>确定模型（网络结构）、评估模型（损失函数）、改进模型（挑出最优）</li></ul><p>需要注意的是，tensorflow和keras经过这两年的时间已经有所变化，视频里面的api已经不能用了。</p><p>现在的2.0版本tf和keras竟然会有冲突（<code>AttributeError: module &#39;tensorflow&#39; has no attribute &#39;get_default_graph&#39;</code>），让人很是无语。</p><h3 id="处理输入"><a href="#处理输入" class="headerlink" title="处理输入"></a>处理输入</h3><p>这里需要注意，首先x的data是60000个28*28的0/1矩阵，表示这个格子有没有上色；y的data是60000个0～9的数字，训练前需要变动：</p><ul><li>把x的每个case展平成一个vector（因为特征是一维的）</li><li>把y变成one-hot格式，每个case用一个10维向量表示，原来值对应位置的那一维是1，其余为0。这在NLP中也很常见，主要是用来区分不同的类 ，而原来的数值表示类会有不好的影响（之前在讨论分类器时有涉及到）</li></ul><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras <span class="token keyword">import</span> Sequential<span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> mnist<span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>layers <span class="token keyword">import</span> Dense<span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>utils <span class="token keyword">import</span> to_categorical<span class="token comment" spellcheck="true"># Load data</span><span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>x_test<span class="token punctuation">,</span> y_test<span class="token punctuation">)</span> <span class="token operator">=</span> mnist<span class="token punctuation">.</span>load_data<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># Flatten input 28 * 28 matrix into a 784 vector</span>x_train <span class="token operator">=</span> x_train<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>len<span class="token punctuation">(</span>x_train<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">28</span> <span class="token operator">*</span> <span class="token number">28</span><span class="token punctuation">)</span>x_test<span class="token operator">=</span> x_test<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>len<span class="token punctuation">(</span>x_test<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">28</span> <span class="token operator">*</span> <span class="token number">28</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># Make y into one-hot encoding</span>y_train <span class="token operator">=</span> to_categorical<span class="token punctuation">(</span>y_train<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>y_test <span class="token operator">=</span> to_categorical<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="设计模型"><a href="#设计模型" class="headerlink" title="设计模型"></a>设计模型</h3><p>这里模型是参考视频中的定义，用了最基本的<em>Sequential</em>模型。</p><p><em>units</em>表示输出的尺寸，和<em>input_dim</em>对应；除了第一层需要定义输入尺寸以外，后面都不需要声明（和上一层的输出尺寸是一样的）。</p><p>使用了<em>sigmoid</em>和<em>softmax</em>用来做层间整合，交叉熵作为<em>loss</em>函数，梯度下降方法的学习率调整使用<em>adam</em>方法，<em>accuracy</em>表示度量方式——一般都会使用这一个选项。</p><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># Build model</span>model <span class="token operator">=</span> Sequential<span class="token punctuation">(</span><span class="token punctuation">)</span>model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Dense<span class="token punctuation">(</span>input_dim<span class="token operator">=</span><span class="token number">28</span><span class="token operator">*</span><span class="token number">28</span><span class="token punctuation">,</span> units<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'sigmoid'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># Activation function could also be:</span><span class="token comment" spellcheck="true"># softplus, softsign, relu, tanhm hard_sigmoid, linear</span>model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Dense<span class="token punctuation">(</span>units<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'sigmoid'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>model<span class="token punctuation">.</span>add<span class="token punctuation">(</span>Dense<span class="token punctuation">(</span>units<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'softmax'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># Config loss function and gradient descent method</span>model<span class="token punctuation">.</span>compile<span class="token punctuation">(</span>loss<span class="token operator">=</span><span class="token string">'categorical_crossentropy'</span><span class="token punctuation">,</span>             optimizer<span class="token operator">=</span><span class="token string">'adam'</span><span class="token punctuation">,</span>             metrics<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'accuracy'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="训练"><a href="#训练" class="headerlink" title="训练"></a>训练</h3><p><code>batch-size</code>表示每次随机选取用于梯度下降的样本数，<code>epochs</code>表示所有样本的迭代次数。</p><h4 id="为什么不计算全部的样本进行迭代？"><a href="#为什么不计算全部的样本进行迭代？" class="headerlink" title="为什么不计算全部的样本进行迭代？"></a>为什么不计算全部的样本进行迭代？</h4><p>这个和之前讨论的BGD与SGD之争如出一辙，其实还是效率和质量的考虑。</p><p>“天下武功，唯快不破”，虽然BGD更为稳定，但是架不住SGD快呀！但是SGD每次只选一个case，随机性太大；所以就使用折衷方案，把所有case分成几个小批量（<em>mini-batch</em>），每次进行一个<em>batch</em>的<em>loss</em>计算，进行一次update。</p><p>另一方面，小批量的梯度下降能够保证一定的随机性，比批量的方法更容易跳出局部极小值。</p><p>而当所有的<em>mini-batch</em>都被计算完，就叫做一个<em>epoch</em>。</p><blockquote><p>虽然一个<em>epoch</em>里面计算<em>loss</em>的次数是一样的，但是可以实现并行计算的加速（也就是说可以同时计算多个case的loss），所以选择适中的<code>batch-size</code>实际效果比<code>batch-size</code>等于1的情况要好。</p><p>具体并行计算加速其实并没有那么复杂：把多个x的向量合并成一个matrix再一起运算，在GPU中矩阵运算得到较好的优化，所以得到了加速。</p></blockquote><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># Train model</span>model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> batch_size<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> epochs<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="预测结果"><a href="#预测结果" class="headerlink" title="预测结果"></a>预测结果</h3><p>可以直接计算准确率：</p><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># Loss and accuraty</span>score <span class="token operator">=</span> model<span class="token punctuation">.</span>evaluate<span class="token punctuation">(</span>x_test<span class="token punctuation">,</span> y_test<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Total loss on testing set:'</span><span class="token punctuation">,</span> score<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Accuracy of testing set:'</span><span class="token punctuation">,</span> score<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre><code>10000/10000 [==============================] - 0s 40us/sample - loss: 0.1367 - accuracy: 0.9589Total loss on testing set: 0.13666086520701648Accuracy of testing set: 0.9589</code></pre><p>也可以选择导出结果（不知道正确答案是多少的场景）：</p><pre class="line-numbers language-python"><code class="language-python">result <span class="token operator">=</span> model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>x_test<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>因为采取的小批量梯度下降具有一定的随机性，所以准确率和结果每次都会有一点差别。</li></ul><p>～本文完～</p>]]></content>
      
      
      <categories>
          
          <category> machine learning </category>
          
      </categories>
      
      
        <tags>
            
            <tag> deep learning </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ML学习日记5——从贝叶斯到逻辑回归</title>
      <link href="/ML-5-Logistic-Regression/"/>
      <url>/ML-5-Logistic-Regression/</url>
      
        <content type="html"><![CDATA[<p>继续上一部分讲解贝叶斯算法的内容，这一次研究一下逻辑回归的分类算法。</p><p>虽然是叫做回归，但是本质是分类，只不过这里的分类方法和线性回归非常相似。</p><p>⚠️前方多图杀猫⚠️    ⚠️前方数学警告⚠️</p><a id="more"></a><h3 id="从二元贝叶斯模型说起"><a href="#从二元贝叶斯模型说起" class="headerlink" title="从二元贝叶斯模型说起"></a>从二元贝叶斯模型说起</h3><p>我们首先看一下如果是<strong>二分类问题</strong>，使用贝叶斯模型的做法：</p><p><img src="/ML-5-Logistic-Regression/1.PNG" alt></p><p>可以顺着途中的公式变形，得到$P(C1|x)=\sigma(z)$，z是一个比较复杂的变量，而这个函数又叫<em>sigmoid</em>函数，特点是对正的输入，返回的值在0.5到1之间，对负数返回的值在0到0.5之间，而且单调递增。</p><p>中间过程略去，我们可以用x和其他参数表示z（上面部分）：</p><p><img src="/ML-5-Logistic-Regression/2.PNG" alt></p><p>当我们让协方差矩阵相等的时候（为什么要这么做？一方面是效率的考虑，另一方面就是在某些地方测试得到的结果比原来的好（<strong>这又是为什么？</strong>那我就真的不知道了）），可以化简这个式子，从而得到$z=wx+b$这样一个简洁的形式。</p><p>是不是很眼熟？这不就是线性回归的模型嘛！</p><p>事实上，我们这么操作之后就会发现，之前我们所求的贝叶斯的各个参数其实不过是为了得到概率的线性拟合参数w和b——既然如此，为什么不直接求这些参数？那样做岂不是更加简洁。</p><p>既然如此，我们就顺着这条路探究下去。</p><h3 id="有了新模型，如何评价模型的好坏？"><a href="#有了新模型，如何评价模型的好坏？" class="headerlink" title="有了新模型，如何评价模型的好坏？"></a>有了新模型，如何评价模型的好坏？</h3><p>依然是对训练样本做最大似然估计，即选择使得现有数据的分类可能性最大的模型，如下图。</p><p><img src="/ML-5-Logistic-Regression/3.PNG" alt></p><p>这里实现两个等价的变换：</p><ul><li><p>做符号的等价变化：当我们要求l的值最大，等价于求$-ln(l)$的值最小——取对数是一个技巧，用于将乘法转化为加法。</p></li><li><p>令$\hat{y}^n$表示分类结果，用1表示A类，用0表示B类</p><ul><li><p>这样做和<em>sigmoid</em>函数产生联系，使用A的函数估计A类产生x的概率密度，概率接近1的时候就是A类，概率接近0的时候就是B类</p></li><li><p>另外可以简化函数的形式，把条件改写成数学化的表达。我们原来的形式是这样的：</p><ul><li>如果x属于A类，那就加算A类产生它的概率的负对数；</li><li>否则加算B产生它的概率的负对数；</li></ul><p>当x属于A类的时候，第二项是0；否则第一项是0。所以原式改写成：$\hat{y}^nlnf_{w,b}(x^n)+(1-\hat{y}^nln(1-f_{w,b}(x^n)))$</p></li></ul></li></ul><p>如此一来，变换可得到：</p><p><img src="/ML-5-Logistic-Regression/4.PNG" alt></p><p>而根据信息论的表述，这一函数的形式就很像我们的估计函数和实际函数的交叉熵。</p><blockquote><p>交叉熵可以估计两个概率分布的相似情况，假如交叉熵越大，那么说明两个分布的值越接近。</p></blockquote><p>我们通过这一形式化的解释，侧面说明了这一个公式的正确性——我们需要求最小的函数值，那么就需要求最大的交叉熵（注意前面的负号），所以此时模型的概率分布和真实数据是最接近的！</p><h3 id="有了评估方法，如何找到最优模型参数？"><a href="#有了评估方法，如何找到最优模型参数？" class="headerlink" title="有了评估方法，如何找到最优模型参数？"></a>有了评估方法，如何找到最优模型参数？</h3><p>老办法，梯度下降。</p><p>不确定这个交叉熵函数L是不是凸函数，我们先对w和b各自求个微分。</p><p>对w求微分化简过程如下图，左右侧同理；</p><p><img src="/ML-5-Logistic-Regression/6.png" alt></p><p><img src="/ML-5-Logistic-Regression/7.png" alt></p><p>最终化简结果相当简洁，也就是$\frac{\partial{L}}{\partial{w}}=-\sum_1^n(\hat{y}^i-f_{w,b}(x^i))x^i$，这个形式和线形回归的学习率其实是一样的！</p><ul><li>注意这里w和x都是向量。</li></ul><p><img src="/ML-5-Logistic-Regression/8.png" alt></p><p>这里b的梯度下降可以并入w，多出一个$x0 = 1$的维度。</p><h2 id="线性回归与逻辑回归的联系与区别"><a href="#线性回归与逻辑回归的联系与区别" class="headerlink" title="线性回归与逻辑回归的联系与区别"></a>线性回归与逻辑回归的联系与区别</h2><p>看下图，模型三步走：选取模型、评估模型、调整模型过程中，两个模型都是十分相似的。</p><p><img src="/ML-5-Logistic-Regression/compare.png" alt></p><h3 id="为什么不用平方损失（square-error）评估逻辑回归模型？"><a href="#为什么不用平方损失（square-error）评估逻辑回归模型？" class="headerlink" title="为什么不用平方损失（square error）评估逻辑回归模型？"></a>为什么不用平方损失（square error）评估逻辑回归模型？</h3><p>这个事情不是很直观，我们需要计算一下。</p><p>如果采用的是平方损失函数，那么得到的梯度是：</p><p>可以看出，采用平方差的时候，假如模型的估计概率很接近分类的一端（接近1，或者接近0），它的梯度都会接近0；这说明，在远离目标和接近目标的地方，梯度都很小，我们很难获得好的结果。</p><p><img src="/ML-5-Logistic-Regression/whyNOTsquare.png" alt></p><p>更直观的图例在这里：</p><ul><li>在图片中可以看到，<em>cross entropy</em>作为损失函数，在离目标比较远的地方梯度较大；在接近目标的地方梯度比较小。</li><li>而使用<em>square error</em>作为损失函数的时候，在离目标比较远和比较近的地方梯度都很小。</li></ul><p><img src="/ML-5-Logistic-Regression/squareANDCrossEntropy.png" alt></p><h2 id="Discriminative-VS-Generative"><a href="#Discriminative-VS-Generative" class="headerlink" title="Discriminative VS Generative"></a>Discriminative VS Generative</h2><p>现在回头看看，我们从贝叶斯的生成模型走了这么远，到了逻辑回归的判别模型，产生的结果参数是一样的嘛？</p><p>也就是说，我们在这里获得的w和b，和本文一开始把$\sum$统一之后得到的模型是不是同一个？</p><p>答案是：<strong>不是同一个</strong>。</p><p>其实模型的最终表述形式是一样的（即，相同的<em>function set</em>），而最终得到的模型之所以不同，是因为我们一开始做出的假设不同。</p><p>我们在贝叶斯的生成模型的时候，做出了诸如”高斯分布”、”独立概率”等等假设。这些假设其实对模型进行了限制。但是在寻找逻辑回归模型的时候，我们只是直接去做了，其实会更贴近数据一点。</p><p>很多实践告诉我们，Generative的模型表现不如Discriminative的模型。</p><p>实际情况的结论要复杂一些：</p><ul><li>training data比较小的时候，Discriminative受data的影响比较大，很容易失控；而Generative模型主要依据还有自己的假设（自己的脑补），受到数据影响比较小，反而能够比较好地描述数据。<ul><li>在数据量越来越大的时候，贝叶斯渐渐失去优势。</li><li>当然，数据量的多少还是以情况论，没有什么绝对标准。</li></ul></li><li>和第一条相似的情况是noise比较多，label本身有错的时候。此时Generative模型占优。</li><li>另外，如果特征之间明显没有关联，那么还是Generative模型好一些。<ul><li>语音辨识为例。为了预测下一句话的内容，一般采用generative的内容。</li></ul></li></ul><p>所以说，当我们掌握信息比较少的时候，脑补和假设很重要；而信息比较多的时候，自然要尊重事实。嘿嘿，不失为人生哲理一条～</p><h2 id="拓展"><a href="#拓展" class="headerlink" title="拓展"></a>拓展</h2><h3 id="多类逻辑回归multi-class-classification"><a href="#多类逻辑回归multi-class-classification" class="headerlink" title="多类逻辑回归multi-class classification"></a>多类逻辑回归multi-class classification</h3><p>现在我们把二元的结果向多元拓展：</p><p>假设有C1、C2、C3的类，我们也可以使用逻辑回归，对每个类也有w和b。</p><p>我们需要使用<em>softmax</em>函数（可以通过最大熵理论推导，但是超出了本文的讨论范围）：</p><p><img src="/ML-5-Logistic-Regression/softmax.png" alt></p><p>这么一做之后，不单考虑到各个概率的大小，也保证各个概率之和为1。</p><p>这样之后，我们还是采用计算交叉熵的方式评估函数的好坏（下图的表达式缺少一个负号，即$-\sum…$）。</p><p><img src="/ML-5-Logistic-Regression/multiCrossEntropy.png" alt="multiCrossEntropy"></p><h3 id="LR的限制：模型是有极限的，我不做LR啦！JOJO！"><a href="#LR的限制：模型是有极限的，我不做LR啦！JOJO！" class="headerlink" title="LR的限制：模型是有极限的，我不做LR啦！JOJO！"></a>LR的限制：<s>模型是有极限的，我不做LR啦！JOJO！</s></h3><p>逻辑回归的模型形式和线性回归是一样的，所以其本质是在高维平面上的直线（平面），不能够把一些复杂的分类表现出来。</p><p>比如图中例子，左上和右下是一类，左下和右上是一类，但是logistic分类只能画出一条直线，无法分割。</p><p><img src="/ML-5-Logistic-Regression/limit.png" alt></p><p>但是，我们可以通过Feature Transformation进行修正：</p><h4 id="Feature-Transformation"><a href="#Feature-Transformation" class="headerlink" title="Feature Transformation"></a>Feature Transformation</h4><p>我们把原有的特征进行变换，得到新的feature，而这个feature可以用直线分类。</p><p>例如在上面这个例子中，可以采用新的feature：$x3=x1^2+x2^2,x4=(1-x1)^2+(1-x2)^2$，即到点<code>(0, 0),(1,1)</code>之间的距离作为新的两个feature。这样一来，我们就可以用直线分割这两组点（图略）。</p><p>但是问题在于，我们往往无法描述属性的特征，不知道如何找到一个好的transformation。如果都是手动修改feature，那就不是人工智能啦！</p><p>我们需要的是让机器自己产生新的feature transformation！所以我们需要：</p><h4 id="Cascading-LR"><a href="#Cascading-LR" class="headerlink" title="Cascading LR"></a>Cascading LR</h4><p>将许多个逻辑回归模型接起来。</p><p>我们做了许多种方式的特征转换之后，再用softmax逻辑回归将他们进行分类。</p><p>是不是有点神经网络的样子？这么一看，其实神经网络就是无数个小的逻辑回归等单元的组合。</p><p>激动，终于学到Deep Learning的内容了。</p><p><img src="/ML-5-Logistic-Regression/cascading.png" alt></p>]]></content>
      
      
      <categories>
          
          <category> machine learning </category>
          
      </categories>
      
      
        <tags>
            
            <tag> classification </tag>
            
            <tag> logistic regression </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>33.Search in Rotated Sorted Array</title>
      <link href="/33-Search-in-Rotated-Sorted-Array/"/>
      <url>/33-Search-in-Rotated-Sorted-Array/</url>
      
        <content type="html"><![CDATA[<h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p>Suppose an array sorted in ascending order is rotated at some pivot unknown to you beforehand.</p><p>(i.e., <code>[0,1,2,4,5,6,7]</code> might become <code>[4,5,6,7,0,1,2]</code>).</p><p>You are given a target value to search. If found in the array return its index, otherwise return <code>-1</code>.</p><p>You may assume no duplicate exists in the array.</p><p>Your algorithm’s runtime complexity must be in the order of <em>O</em>(log <em>n</em>).</p><a id="more"></a><p><strong>Example 1:</strong></p><pre class="line-numbers language-java"><code class="language-java">Input<span class="token operator">:</span> nums <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> target <span class="token operator">=</span> <span class="token number">0</span>Output<span class="token operator">:</span> <span class="token number">4</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>Example 2:</strong></p><pre class="line-numbers language-java"><code class="language-java">Input<span class="token operator">:</span> nums <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> target <span class="token operator">=</span> <span class="token number">3</span>Output<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><h4 id="二分查找"><a href="#二分查找" class="headerlink" title="二分查找"></a>二分查找</h4><p>首先，通过二分找到旋转点（第一个比<code>nums[0]</code>小的元素）；</p><p>然后，确认是否旋转，并确定查找范围；</p><p>最后二分查找元素。</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">search</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">,</span> <span class="token keyword">int</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>nums <span class="token operator">==</span> null <span class="token operator">||</span> nums<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> cut <span class="token operator">=</span> nums<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> lo <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> hi <span class="token operator">=</span> nums<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>      <span class="token comment" spellcheck="true">// find rotate point</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>lo <span class="token operator">&lt;</span> hi<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> mi <span class="token operator">=</span> lo <span class="token operator">+</span> <span class="token punctuation">(</span>hi <span class="token operator">-</span> lo<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>nums<span class="token punctuation">[</span>mi<span class="token punctuation">]</span> <span class="token operator">>=</span> cut<span class="token punctuation">)</span>            lo <span class="token operator">=</span> mi <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">else</span>            hi <span class="token operator">=</span> mi<span class="token punctuation">;</span>    <span class="token punctuation">}</span>      <span class="token comment" spellcheck="true">// check if truly rotate</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>nums<span class="token punctuation">[</span>lo<span class="token punctuation">]</span> <span class="token operator">></span> cut<span class="token punctuation">)</span>        lo <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>      <span class="token comment" spellcheck="true">// if target is on the left side</span>    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>target <span class="token operator">>=</span> cut<span class="token punctuation">)</span> <span class="token punctuation">{</span>        lo <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        hi<span class="token operator">--</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// if target is on the right side</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span>        hi <span class="token operator">=</span> nums<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>      <span class="token comment" spellcheck="true">// binary search</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>lo <span class="token operator">&lt;</span> hi<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> mi <span class="token operator">=</span> lo <span class="token operator">+</span> <span class="token punctuation">(</span>hi <span class="token operator">-</span> lo<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>nums<span class="token punctuation">[</span>mi<span class="token punctuation">]</span> <span class="token operator">&lt;</span> target<span class="token punctuation">)</span>            lo <span class="token operator">=</span> mi <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">else</span>            hi <span class="token operator">=</span> mi<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> nums<span class="token punctuation">[</span>lo<span class="token punctuation">]</span> <span class="token operator">==</span> target <span class="token operator">?</span> lo <span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(log(n))$</li><li>空间复杂度：$O(1)$</li></ul>]]></content>
      
      
      <categories>
          
          <category> leetcode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> array </tag>
            
            <tag> medium </tag>
            
            <tag> binary search </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Code Jam 2019 Qualification Round</title>
      <link href="/Code-Jam-2019-Qualification-Round/"/>
      <url>/Code-Jam-2019-Qualification-Round/</url>
      
        <content type="html"><![CDATA[<p>准备打一下今年的code jam和kick start，看了一下code jam是采取连续比赛的机制，kick start是每一轮独立。</p><p>今天写一下关于code jam的资格赛的事情。</p><p>QR在4月5日早上七点开始，持续27小时，只要在难度不大的四题（总分100）里面做出30分就可以。</p><p>贴一下战绩：55分，其实挺低的……还需要加油</p><a id="more"></a><h3 id="Foregone-Solution"><a href="#Foregone-Solution" class="headerlink" title="Foregone Solution"></a>Foregone Solution</h3><blockquote><h3 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h3><p>Someone just won the Code Jam lottery, and we owe them <strong>N</strong> jamcoins! However, when we tried to print out an oversized check, we encountered a problem. The value of <strong>N</strong>, which is an integer, includes at least one digit that is a <code>4</code>… and the <code>4</code>key on the keyboard of our oversized check printer is broken.</p><p>Fortunately, we have a workaround: we will send our winner two checks for positive integer amounts A and B, such that neither A nor B contains any digit that is a <code>4</code>, and A + B = <strong>N</strong>. Please help us find any pair of values A and B that satisfy these conditions.</p><h3 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h3><p>The first line of the input gives the number of test cases, <strong>T</strong>. <strong>T</strong> test cases follow; each consists of one line with an integer <strong>N</strong>.</p><h3 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h3><p>For each test case, output one line containing <code>Case #x: A B</code>, where <code>x</code> is the test case number (starting from 1), and <code>A</code> and <code>B</code> are positive integers as described above.</p><p>It is guaranteed that at least one solution exists. If there are multiple solutions, you may output any one of them. (See “What if a test case has multiple correct solutions?” in the Competing section of the <a href="https://codingcompetitions.withgoogle.com/codejam/faq">FAQ</a>. This information about multiple solutions will not be explicitly stated in the remainder of the 2019 contest.)</p><h3 id="Limits"><a href="#Limits" class="headerlink" title="Limits"></a>Limits</h3><p>1 ≤ <strong>T</strong> ≤ 100.<br>Time limit: 10 seconds per test set.<br>Memory limit: 1GB.<br>At least one of the digits of <strong>N</strong> is a 4.</p><h4 id="Test-set-1-Visible"><a href="#Test-set-1-Visible" class="headerlink" title="Test set 1 (Visible)"></a>Test set 1 (Visible)</h4><p>1 &lt; <strong>N</strong> &lt; 105.</p><h4 id="Test-set-2-Visible"><a href="#Test-set-2-Visible" class="headerlink" title="Test set 2 (Visible)"></a>Test set 2 (Visible)</h4><p>1 &lt; <strong>N</strong> &lt; 109.</p><p>Solving the first two test sets for this problem should get you a long way toward advancing. The third test set is worth only 1 extra point, for extra fun and bragging rights!</p><h4 id="Test-set-3-Hidden"><a href="#Test-set-3-Hidden" class="headerlink" title="Test set 3 (Hidden)"></a>Test set 3 (Hidden)</h4><p>1 &lt; <strong>N</strong> &lt; 10100.</p><h3 id="Sample"><a href="#Sample" class="headerlink" title="Sample"></a>Sample</h3><table><thead><tr><th>Input</th><th>Output</th></tr></thead><tbody><tr><td><code>3 4 940 4444</code></td><td><code>Case #1: 2 2 Case #2: 852 88 Case #3: 667 3777</code></td></tr></tbody></table><p>In Sample Case #1, notice that A and B can be the same. The only other possible answers are <code>1 3</code> and <code>3 1</code>.</p></blockquote><p>这题是米斯达保护协会出的（迫真）</p><p>其实就是把一个包含<code>4</code>的数拆分成两个不同的数，但是这两个数不能包含<code>4</code>。</p><p>只要有一个固定的拆分方法就可以：</p><ul><li>对每一个位上的数字<code>a</code>，如果不是<code>4</code>，就拆分成<code>a</code>和<code>0</code>；</li><li>否则拆出两个<code>2</code></li></ul><p>想着很简单就不管了，结果比赛结束一看，竟然没过hidden case……</p><p>想了一会恍然大悟：位数不够！</p><p>那就该用<code>BigInteger</code>库了。</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>BufferedReader<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>InputStreamReader<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Scanner<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>math<span class="token punctuation">.</span>BigInteger<span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        Scanner in <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Scanner</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BufferedReader</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">InputStreamReader</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span>in<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> t <span class="token operator">=</span> in<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> t<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>            BigInteger sum <span class="token operator">=</span> in<span class="token punctuation">.</span><span class="token function">nextBigInteger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> num <span class="token operator">=</span> <span class="token function">splitWithout4</span><span class="token punctuation">(</span>sum<span class="token punctuation">)</span><span class="token punctuation">;</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Case #"</span> <span class="token operator">+</span> i <span class="token operator">+</span> <span class="token string">": "</span> <span class="token operator">+</span> num <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> sum<span class="token punctuation">.</span><span class="token function">subtract</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> BigInteger <span class="token function">splitWithout4</span><span class="token punctuation">(</span>BigInteger sum<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> ch <span class="token operator">=</span> sum<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toCharArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        BigInteger res <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BigInteger</span><span class="token punctuation">(</span><span class="token string">"0"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            two <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BigInteger</span><span class="token punctuation">(</span><span class="token string">"2"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            ten <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BigInteger</span><span class="token punctuation">(</span><span class="token string">"10"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">char</span> c <span class="token operator">:</span> ch<span class="token punctuation">)</span> <span class="token punctuation">{</span>            res <span class="token operator">=</span> res<span class="token punctuation">.</span><span class="token function">multiply</span><span class="token punctuation">(</span>ten<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>c <span class="token operator">==</span> <span class="token string">'4'</span><span class="token punctuation">)</span>                  res <span class="token operator">=</span> res<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>two<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(log(n))$</li><li>空间复杂度：$O(1)$</li></ul><hr><p>这里插播一下<code>java.math.BigInteger</code>库，好像是1.7版本的jdk开始支持的。</p><p>因为java最大的整数使用<code>long</code>存的，数位最大不过64bit，也就是说最大表示不到2的63次方，最小自然是负的2的63次方。这样计算起来不过就是1e20左右嘛，根本不够看的。</p><p>所以java使用大整数库来操作比较长的数，方法是将数存在<code>String</code>里面，然后对加减乘除模，位运算等等都单独内置了支持（还支持了gcd，好评！）</p><p>因为是使用字符串表示，字符串长度是一个<code>int</code>值，最长就是<code>Integer.MAX_VALUE</code>，一般够用了</p><hr><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>BufferedReader<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>InputStreamReader<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Scanner<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>math<span class="token punctuation">.</span>BigInteger<span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        Scanner in <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Scanner</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BufferedReader</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">InputStreamReader</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span>in<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> t <span class="token operator">=</span> in<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> t<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>            BigInteger sum <span class="token operator">=</span> in<span class="token punctuation">.</span><span class="token function">nextBigInteger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> num <span class="token operator">=</span> <span class="token function">splitWithout4</span><span class="token punctuation">(</span>sum<span class="token punctuation">)</span><span class="token punctuation">;</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Case #"</span> <span class="token operator">+</span> i <span class="token operator">+</span> <span class="token string">": "</span> <span class="token operator">+</span> num <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> sum<span class="token punctuation">.</span><span class="token function">subtract</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> BigInteger <span class="token function">splitWithout4</span><span class="token punctuation">(</span>BigInteger sum<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> ch <span class="token operator">=</span> sum<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toCharArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        BigInteger res <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BigInteger</span><span class="token punctuation">(</span><span class="token string">"0"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        BigInteger three <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BigInteger</span><span class="token punctuation">(</span><span class="token string">"3"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            two <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BigInteger</span><span class="token punctuation">(</span><span class="token string">"2"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            ten <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BigInteger</span><span class="token punctuation">(</span><span class="token string">"10"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">char</span> c <span class="token operator">:</span> ch<span class="token punctuation">)</span> <span class="token punctuation">{</span>            res <span class="token operator">=</span> res<span class="token punctuation">.</span><span class="token function">multiply</span><span class="token punctuation">(</span>ten<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>c <span class="token operator">>=</span> <span class="token string">'4'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>c <span class="token operator">==</span> <span class="token string">'6'</span><span class="token punctuation">)</span>                    res <span class="token operator">=</span> res<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>three<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">else</span>                    res <span class="token operator">=</span> res<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>two<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="You-Can-Go-Your-Own-Way"><a href="#You-Can-Go-Your-Own-Way" class="headerlink" title="You Can Go Your Own Way"></a>You Can Go Your Own Way</h3><blockquote><h3 id="Problem-1"><a href="#Problem-1" class="headerlink" title="Problem"></a>Problem</h3><p>You have just entered the world’s easiest maze. You start in the northwest cell of an <strong>N</strong> by <strong>N</strong> grid of unit cells, and you must reach the southeast cell. You have only two types of moves available: a unit move to the east, and a unit move to the south. You can move into any cell, but you may not make a move that would cause you to leave the grid.</p><p>You are excited to be the first in the world to solve the maze, but then you see footprints. Your rival, Labyrinth Lydia, has already solved the maze before you, using the same rules described above!</p><p>As an original thinker, you do not want to reuse any of Lydia’s moves. Specifically, if her path includes a unit move from some cell A to some adjacent cell B, your path cannot also include a move from A to B. (However, in that case, it is OK for your path to visit A or visit B, as long as you do not go from A to B.) Please find such a path.</p><p>In the following picture, Lydia’s path is indicated in blue, and one possible valid path for you is indicated in orange:</p><p><img src="/Code-Jam-2019-Qualification-Round/path.svg" alt></p><h3 id="Input-1"><a href="#Input-1" class="headerlink" title="Input"></a>Input</h3><p>The first line of the input gives the number of test cases, <strong>T</strong>. <strong>T</strong> test cases follow; each case consists of two lines. The first line contains one integer <strong>N</strong>, giving the dimensions of the maze, as described above. The second line contains a string <strong>P</strong>of 2<strong>N</strong> - 2 characters, each of which is either uppercase <code>E</code> (for east) or uppercase <code>S</code>(for south), representing Lydia’s valid path through the maze.</p><h3 id="Output-1"><a href="#Output-1" class="headerlink" title="Output"></a>Output</h3><p>For each test case, output one line containing <code>Case #x: y</code>, where <code>x</code> is the test case number (starting from 1) and <code>y</code> is a string of 2<strong>N</strong> - 2 characters each of which is either uppercase <code>E</code> (for east) or uppercase <code>S</code> (for south), representing your valid path through the maze that does not conflict with Lydia’s path, as described above. It is guaranteed that at least one answer exists.</p><h3 id="Limits-1"><a href="#Limits-1" class="headerlink" title="Limits"></a>Limits</h3><p>1 ≤ <strong>T</strong> ≤ 100.<br>Time limit: 15 seconds per test set.<br>Memory limit: 1GB.<br><strong>P</strong> contains exactly <strong>N</strong> - 1 <code>E</code> characters and exactly <strong>N</strong> - 1 <code>S</code> characters.</p><h4 id="Test-set-1-Visible-1"><a href="#Test-set-1-Visible-1" class="headerlink" title="Test set 1 (Visible)"></a>Test set 1 (Visible)</h4><p>2 ≤ <strong>N</strong> ≤ 10.</p><h4 id="Test-set-2-Visible-1"><a href="#Test-set-2-Visible-1" class="headerlink" title="Test set 2 (Visible)"></a>Test set 2 (Visible)</h4><p>2 ≤ <strong>N</strong> ≤ 1000.</p><h4 id="Test-set-3-Hidden-1"><a href="#Test-set-3-Hidden-1" class="headerlink" title="Test set 3 (Hidden)"></a>Test set 3 (Hidden)</h4><p>For at most 10 cases, 2 ≤ <strong>N</strong> ≤ 50000.<br>For all other cases, 2 ≤ <strong>N</strong> ≤ 10000.</p><h3 id="Sample-1"><a href="#Sample-1" class="headerlink" title="Sample"></a>Sample</h3><table><thead><tr><th>Input</th><th>Output</th></tr></thead><tbody><tr><td><code>2 2 SE 5 EESSSESE</code></td><td><code>Case #1: ES Case #2: SEEESSES</code></td></tr></tbody></table><p>In Sample Case #1, the maze is so small that there is only one valid solution left for us.</p><p>Sample Case #2 corresponds to the picture above. Notice that it is acceptable for the paths to cross.</p></blockquote><p>一开始我想的很复杂，回溯法解决：首先在<code>n*n</code>的格子上标记每个格子走的路线，如果遇到同路那就返回上一步换个方向继续做。时间和空间复杂度是$O(n^2)$，代码也很长：</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>BufferedReader<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>InputStreamReader<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>*<span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> map<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> List<span class="token operator">&lt;</span>String<span class="token operator">></span> res<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        res <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Scanner in <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Scanner</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BufferedReader</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">InputStreamReader</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span>in<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> t <span class="token operator">=</span> in<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> ti <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> ti <span class="token operator">&lt;=</span> t<span class="token punctuation">;</span> ti<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">int</span> n <span class="token operator">=</span> in<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            in<span class="token punctuation">.</span><span class="token function">nextLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            String path <span class="token operator">=</span> in<span class="token punctuation">.</span><span class="token function">nextLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">char</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>            res<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> path<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                map<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>y<span class="token punctuation">]</span> <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'E'</span><span class="token punctuation">)</span>                    y<span class="token operator">++</span><span class="token punctuation">;</span>                <span class="token keyword">else</span>                    x<span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token function">findAnotherPath</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Case #"</span> <span class="token operator">+</span> ti <span class="token operator">+</span> <span class="token string">": "</span> <span class="token operator">+</span> res<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">boolean</span> <span class="token function">findAnotherPath</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> y<span class="token punctuation">,</span> StringBuilder curr<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> n <span class="token operator">=</span> map<span class="token punctuation">.</span>length<span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token operator">==</span> n <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> y <span class="token operator">==</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            res<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>curr<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">boolean</span> goEast <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">,</span> goSouth <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>map<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>y<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">'S'</span> <span class="token operator">&amp;&amp;</span> y <span class="token operator">!=</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            curr<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'S'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            goEast <span class="token operator">=</span> <span class="token function">findAnotherPath</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> curr<span class="token punctuation">)</span><span class="token punctuation">;</span>            curr<span class="token punctuation">.</span><span class="token function">setLength</span><span class="token punctuation">(</span>curr<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>goEast <span class="token operator">&amp;&amp;</span> map<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">[</span>y<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">'E'</span> <span class="token operator">&amp;&amp;</span> x <span class="token operator">!=</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            curr<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'E'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            goSouth <span class="token operator">=</span> <span class="token function">findAnotherPath</span><span class="token punctuation">(</span>x <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> y<span class="token punctuation">,</span> curr<span class="token punctuation">)</span><span class="token punctuation">;</span>            curr<span class="token punctuation">.</span><span class="token function">setLength</span><span class="token punctuation">(</span>curr<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> goEast <span class="token operator">||</span> goSouth<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>然后顺利通过了两个visible case。</p><p>比赛结束之后，发现还有hidden case没过。看了一下analysis，才知道有一种更简洁的方法：</p><p>那就是始终走对称路线！</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>BufferedReader<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>InputStreamReader<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>*<span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        Scanner in <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Scanner</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BufferedReader</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">InputStreamReader</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span>in<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> t <span class="token operator">=</span> in<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> ti <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> ti <span class="token operator">&lt;=</span> t<span class="token punctuation">;</span> ti<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">int</span> n <span class="token operator">=</span> in<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            in<span class="token punctuation">.</span><span class="token function">nextLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            String path <span class="token operator">=</span> in<span class="token punctuation">.</span><span class="token function">nextLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Case #"</span> <span class="token operator">+</span> ti <span class="token operator">+</span> <span class="token string">": "</span> <span class="token operator">+</span> <span class="token function">inversePath</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> String <span class="token function">inversePath</span><span class="token punctuation">(</span>String path<span class="token punctuation">)</span> <span class="token punctuation">{</span>        StringBuilder res <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> path<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>            res<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'S'</span> <span class="token operator">?</span> <span class="token string">'E'</span> <span class="token operator">:</span> <span class="token string">'S'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Cryptopangrams"><a href="#Cryptopangrams" class="headerlink" title="Cryptopangrams"></a>Cryptopangrams</h3><blockquote><h3 id="Problem-2"><a href="#Problem-2" class="headerlink" title="Problem"></a>Problem</h3><p>On the Code Jam team, we enjoy sending each other <em>pangrams</em>, which are phrases that use each letter of the English alphabet at least once. One common example of a pangram is “the quick brown fox jumps over the lazy dog”. Sometimes our pangrams contain confidential information — for example, <code>CJ QUIZ: KNOW BEVY OF DP FLUX ALGORITHMS</code> — so we need to keep them secure.</p><p>We looked through a cryptography textbook for a few minutes, and we learned that it is very hard to factor products of two large prime numbers, so we devised an encryption scheme based on that fact. First, we made some preparations:</p><ul><li>We chose 26 different prime numbers, none of which is larger than some integer <strong>N</strong>.</li><li>We sorted those primes in increasing order. Then, we assigned the smallest prime to the letter <code>A</code>, the second smallest prime to the letter <code>B</code>, and so on.</li><li>Everyone on the team memorized this list.</li></ul><p>Now, whenever we want to send a pangram as a message, we first remove all spacing to form a plaintext message. Then we write down the product of the prime for the first letter of the plaintext and the prime for the second letter of the plaintext. Then we write down the product of the primes for the second and third plaintext letters, and so on, ending with the product of the primes for the next-to-last and last plaintext letters. This new list of values is our ciphertext. The number of values is one smaller than the number of characters in the plaintext message.</p><p>For example, suppose that <strong>N</strong> = 103 and we chose to use the first 26 odd prime numbers, because we worry that it is too easy to factor even numbers. Then <code>A</code> = 3, <code>B</code> = 5, <code>C</code> = 7, <code>D</code> = 11, and so on, up to <code>Z</code> = 103. Also suppose that we want to encrypt the <code>CJ QUIZ</code>… pangram above, so our plaintext is <code>CJQUIZKNOWBEVYOFDPFLUXALGORITHMS</code>. Then the first value in our ciphertext is 7 (the prime for <code>C</code>) times 31 (the prime for <code>J</code>) = <code>217</code>; the next value is <code>1891</code>, and so on, ending with <code>3053</code>.</p><p>We will give you a ciphertext message and the value of <strong>N</strong> that we used. We will not tell you which primes we used, or how to decrypt the ciphertext. Do you think you can recover the plaintext anyway?</p><h3 id="Input-2"><a href="#Input-2" class="headerlink" title="Input"></a>Input</h3><p>The first line of the input gives the number of test cases, <strong>T</strong>. <strong>T</strong> test cases follow; each test case consists of two lines. The first line contains two integers: <strong>N</strong>, as described above, and <strong>L</strong>, the length of the list of values in the ciphertext. The second line contains <strong>L</strong> integers: the list of values in the ciphertext.</p><h3 id="Output-2"><a href="#Output-2" class="headerlink" title="Output"></a>Output</h3><p>For each test case, output one line containing <code>Case #x: y</code>, where <code>x</code> is the test case number (starting from 1) and <code>y</code> is a string of <strong>L</strong> + 1 uppercase English alphabet letters: the plaintext.</p><h3 id="Limits-2"><a href="#Limits-2" class="headerlink" title="Limits"></a>Limits</h3><p>1 ≤ <strong>T</strong> ≤ 100.<br>Time limit: 20 seconds per test set.<br>Memory limit: 1 GB.<br>25 ≤ <strong>L</strong> ≤ 100.<br>The plaintext contains each English alphabet letter at least once.</p><h4 id="Test-set-1-Visible-2"><a href="#Test-set-1-Visible-2" class="headerlink" title="Test set 1 (Visible)"></a>Test set 1 (Visible)</h4><p>101 ≤ <strong>N</strong> ≤ 10000.</p><h4 id="Test-set-2-Hidden"><a href="#Test-set-2-Hidden" class="headerlink" title="Test set 2 (Hidden)"></a>Test set 2 (Hidden)</h4><p>101 ≤ <strong>N</strong> ≤ 10100.</p><h3 id="Sample-2"><a href="#Sample-2" class="headerlink" title="Sample"></a>Sample</h3><table><thead><tr><th>Input</th><th></th></tr></thead><tbody><tr><td><code>2 103 31 217 1891 4819 2291 2987 3811 1739 2491 4717 445 65 1079 8383 5353 901 187 649 1003 697 3239 7663 291 123 779 1007 3551 1943 2117 1679 989 3053 10000 25 3292937 175597 18779 50429 375469 1651121 2102 3722 2376497 611683 489059 2328901 3150061 829981 421301 76409 38477 291931 730241 959821 1664197 3057407 4267589 4729181 5335543</code></td><td></td></tr><tr><td></td><td></td></tr><tr><td>Output</td><td></td></tr><tr><td><code>Case #1: CJQUIZKNOWBEVYOFDPFLUXALGORITHMS Case #2: SUBDERMATOGLYPHICFJKNQVWXZ</code></td></tr></tbody></table></blockquote><p>思路很简单，找到两个相邻的数的最大公因数，例如相邻两个数是<code>a * b</code>和<code>b*c</code>，那么最大公因数就是<code>b</code></p><p>后面hidden case比较大，1e100的数据量，一开始想的是先别考虑了</p><p>然后我就掉入了巨坑……</p><p>简单写了一下使用<code>Integer</code>存保存数组的代码，gcd用的是欧几里得算法的加强版，对较大的数提高了一点效率。</p><p>运行了一下sample，ok</p><p>结果在visible case上面<code>re(runtime error)</code>了。</p><p>冥思苦想，可能是数据太大溢出了？我寻思这也不是什么大的数据啊？？</p><p>索性上<code>BigInteger</code>库改写了一下代码，正好可以解决hidden case的问题：</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>BufferedReader<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>InputStreamReader<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>math<span class="token punctuation">.</span>BigInteger<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>*<span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        Scanner in <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Scanner</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BufferedReader</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">InputStreamReader</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span>in<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> t <span class="token operator">=</span> in<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> t<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>            BigInteger up <span class="token operator">=</span> in<span class="token punctuation">.</span><span class="token function">nextBigInteger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">int</span> n <span class="token operator">=</span> in<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            BigInteger<span class="token punctuation">[</span><span class="token punctuation">]</span> product <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BigInteger</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>                product<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> in<span class="token punctuation">.</span><span class="token function">nextBigInteger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Case #"</span> <span class="token operator">+</span> i <span class="token operator">+</span> <span class="token string">": "</span> <span class="token operator">+</span> <span class="token function">decrypt</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> product<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> String <span class="token function">decrypt</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">,</span> BigInteger<span class="token punctuation">[</span><span class="token punctuation">]</span> product<span class="token punctuation">)</span> <span class="token punctuation">{</span>        BigInteger<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> factor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BigInteger</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        StringBuilder res <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Set<span class="token operator">&lt;</span>BigInteger<span class="token operator">></span> primes <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashSet</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        factor<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> product<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">gcd</span><span class="token punctuation">(</span>product<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        factor<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> product<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">divide</span><span class="token punctuation">(</span>factor<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        primes<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>factor<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            factor<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> factor<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            factor<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> product<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">divide</span><span class="token punctuation">(</span>factor<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            primes<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>factor<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        primes<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>factor<span class="token punctuation">[</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        List<span class="token operator">&lt;</span>BigInteger<span class="token operator">></span> nums <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span>primes<span class="token punctuation">)</span><span class="token punctuation">;</span>        Collections<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span>nums<span class="token punctuation">)</span><span class="token punctuation">;</span>        Map<span class="token operator">&lt;</span>BigInteger<span class="token punctuation">,</span> Character<span class="token operator">></span> dict <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> nums<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>            dict<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>nums<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token string">'A'</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>            res<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>dict<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>factor<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        res<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>dict<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>factor<span class="token punctuation">[</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>自我感觉良好～sample ok之后就立马去attempt了。</p><p>结果：<code>RE</code></p><p>心态略崩，那说明不是刚才说的问题咯？</p><p>于是去查了一下<code>RE</code>都有哪些错误——除了数组越界（这个不会吧，sample都过了），最可能的就是算数除0错误？</p><h3 id="喵喵喵？哪里有0啊？"><a href="#喵喵喵？哪里有0啊？" class="headerlink" title="喵喵喵？哪里有0啊？"></a>喵喵喵？哪里有0啊？</h3><p>苦恼地改进了一下代码，把原来两行的数组改成一行了。话说本来就该用一行做的……</p><p>虽然很奇怪，但是我还是顺着这个想法，在代码中除的部分用了一次catch，捕捉之后返回错误的结果。</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">static</span> String <span class="token function">decrypt</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">,</span> BigInteger<span class="token punctuation">[</span><span class="token punctuation">]</span> product<span class="token punctuation">)</span> <span class="token punctuation">{</span>    BigInteger<span class="token punctuation">[</span><span class="token punctuation">]</span> factor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BigInteger</span><span class="token punctuation">[</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    StringBuilder res <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Set<span class="token operator">&lt;</span>BigInteger<span class="token operator">></span> primes <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashSet</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">try</span> <span class="token punctuation">{</span>        factor<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> product<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">divide</span><span class="token punctuation">(</span>product<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">gcd</span><span class="token punctuation">(</span>product<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ArithmeticException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token string">"ERROR"</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 如果出现除0错误，那么提交结果就会变成WA</span>    <span class="token punctuation">}</span>    primes<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>factor<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            factor<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> product<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">divide</span><span class="token punctuation">(</span>factor<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ArithmeticException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">return</span> <span class="token string">"ERROR"</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 如果出现除0错误，那么提交结果就会变成WA</span>        <span class="token punctuation">}</span>        primes<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>factor<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    primes<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>factor<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    List<span class="token operator">&lt;</span>BigInteger<span class="token operator">></span> tmp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span>primes<span class="token punctuation">)</span><span class="token punctuation">;</span>    Collections<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token punctuation">;</span>    Map<span class="token operator">&lt;</span>BigInteger<span class="token punctuation">,</span> Character<span class="token operator">></span> dict <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> tmp<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>        dict<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>tmp<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token string">'A'</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>BigInteger num <span class="token operator">:</span> factor<span class="token punctuation">)</span>        res<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>dict<span class="token punctuation">.</span><span class="token function">getOrDefault</span><span class="token punctuation">(</span>num<span class="token punctuation">,</span> <span class="token string">'@'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这次提交果然变成了<code>WA</code>，真的是除0的结果……</p><p>然而还是百思不得其解。</p><p>心态崩了一会，只好上ide了。</p><p>在intellij里面写了一下用0～1000的质数生成case的代码：</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">generate</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">,</span> <span class="token keyword">int</span> m<span class="token punctuation">)</span> <span class="token punctuation">{</span>    System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">,</span> <span class="token number">109</span><span class="token punctuation">,</span> <span class="token number">211</span><span class="token punctuation">,</span> <span class="token number">239</span><span class="token punctuation">,</span> <span class="token number">353</span><span class="token punctuation">,</span> <span class="token number">479</span><span class="token punctuation">,</span> <span class="token number">601</span><span class="token punctuation">,</span> <span class="token number">701</span><span class="token punctuation">,</span> <span class="token number">827</span><span class="token punctuation">,</span> <span class="token number">883</span><span class="token punctuation">,</span> <span class="token number">1021</span><span class="token punctuation">,</span> <span class="token number">1051</span><span class="token punctuation">,</span> <span class="token number">1087</span><span class="token punctuation">,</span> <span class="token number">1277</span><span class="token punctuation">,</span> <span class="token number">1381</span><span class="token punctuation">,</span> <span class="token number">1531</span><span class="token punctuation">,</span> <span class="token number">1571</span><span class="token punctuation">,</span> <span class="token number">1669</span><span class="token punctuation">,</span> <span class="token number">1861</span><span class="token punctuation">,</span> <span class="token number">1973</span><span class="token punctuation">,</span> <span class="token number">1997</span><span class="token punctuation">,</span> <span class="token number">2137</span><span class="token punctuation">,</span> <span class="token number">2213</span><span class="token punctuation">,</span> <span class="token number">2281</span><span class="token punctuation">,</span> <span class="token number">2411</span><span class="token punctuation">}</span><span class="token punctuation">;</span>    Map<span class="token operator">&lt;</span>Character<span class="token punctuation">,</span> Integer<span class="token operator">></span> dict <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> res <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">int</span><span class="token punctuation">[</span>m <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> product <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">int</span><span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">26</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>        dict<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token string">'A'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Random r <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> ti <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> ti <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> ti<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> m <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">char</span> c <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token string">'A'</span> <span class="token operator">+</span> r<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            res<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> dict<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> m<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>            product<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> res<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> res<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"10000 "</span> <span class="token operator">+</span> m<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> m<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>product<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>结果做了几次实验，还真撞到一个error的case！</p><p>这还不赶紧保存下来，一看生成的case……</p><pre class="line-numbers language-java"><code class="language-java"><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token number">10000</span> <span class="token number">100</span><span class="token number">4419361</span> <span class="token number">4419361</span> <span class="token number">2325863</span> <span class="token number">1073071</span> <span class="token number">2181877</span> <span class="token number">4566769</span> <span class="token number">4874497</span> <span class="token number">4562</span> <span class="token number">3994</span> <span class="token number">2098847</span> <span class="token number">371003</span> <span class="token number">311699</span> <span class="token number">618983</span> <span class="token number">1498037</span> <span class="token number">3566653</span> <span class="token number">3338</span> <span class="token number">4</span> <span class="token number">706</span> <span class="token number">704941</span> <span class="token number">3</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>第一个数和第二个数是相等的！这样一来它们的公因数就是本身——意味着我会认为第一个数对应的质数是1，第二个数的质数是它本身，第三个数的质数就是它除以第二个数，而如果它还比第二个数小，那么除法就会返回0！</p><p>终于想明白这一点之后，我开始思考解决方案：</p><ul><li>遇到这种情况，排列肯定出现了<code>aba</code>型的序列，导致前后两个乘积是相等的，得出的公因数就无效了。</li><li>每个字母在每段明文都出现至少一次，那么明文肯定出现了至少三个字母，那么肯定在某一处会有<code>abc</code>型的序列，他们保证乘积不相等。</li><li>那么就在找到不同的数之后，从他们入手解出公因数，然后向两侧【传播】。</li></ul><p>做到这点，终于做出了。比赛结束后一看，hidden case也搞定了，真不错。</p><p>最终完整代码如下：</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>BufferedReader<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>InputStreamReader<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>math<span class="token punctuation">.</span>BigInteger<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>*<span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        Scanner in <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Scanner</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BufferedReader</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">InputStreamReader</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span>in<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> t <span class="token operator">=</span> in<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> t<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>            BigInteger up <span class="token operator">=</span> in<span class="token punctuation">.</span><span class="token function">nextBigInteger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">int</span> n <span class="token operator">=</span> in<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            BigInteger<span class="token punctuation">[</span><span class="token punctuation">]</span> product <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BigInteger</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>                product<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> in<span class="token punctuation">.</span><span class="token function">nextBigInteger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Case #"</span> <span class="token operator">+</span> i <span class="token operator">+</span> <span class="token string">": "</span> <span class="token operator">+</span> <span class="token function">decrypt</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> product<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> String <span class="token function">decrypt</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">,</span> BigInteger<span class="token punctuation">[</span><span class="token punctuation">]</span> product<span class="token punctuation">)</span> <span class="token punctuation">{</span>        BigInteger<span class="token punctuation">[</span><span class="token punctuation">]</span> factor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BigInteger</span><span class="token punctuation">[</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        StringBuilder res <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Set<span class="token operator">&lt;</span>BigInteger<span class="token operator">></span> primes <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashSet</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> mid <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>mid <span class="token operator">&lt;</span> n <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> product<span class="token punctuation">[</span>mid<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>product<span class="token punctuation">[</span>mid <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            mid<span class="token operator">++</span><span class="token punctuation">;</span>        factor<span class="token punctuation">[</span>mid<span class="token punctuation">]</span> <span class="token operator">=</span> product<span class="token punctuation">[</span>mid<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">divide</span><span class="token punctuation">(</span>product<span class="token punctuation">[</span>mid<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">gcd</span><span class="token punctuation">(</span>product<span class="token punctuation">[</span>mid <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        primes<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>factor<span class="token punctuation">[</span>mid<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment" spellcheck="true">// 向右计算</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> mid<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            factor<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> product<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">divide</span><span class="token punctuation">(</span>factor<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            primes<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>factor<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>          <span class="token comment" spellcheck="true">// 向左计算</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> mid<span class="token punctuation">;</span> i <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            factor<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> product<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">divide</span><span class="token punctuation">(</span>factor<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            primes<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>factor<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>          <span class="token comment" spellcheck="true">// set中质数排序后和对应字母构成字典</span>        List<span class="token operator">&lt;</span>BigInteger<span class="token operator">></span> tmp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span>primes<span class="token punctuation">)</span><span class="token punctuation">;</span>        Collections<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token punctuation">;</span>        Map<span class="token operator">&lt;</span>BigInteger<span class="token punctuation">,</span> Character<span class="token operator">></span> dict <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> tmp<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>            dict<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>tmp<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token string">'A'</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment" spellcheck="true">// 这里以防万一嘛，虽然题目要求肯定不会出现get不到的字母</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>BigInteger num <span class="token operator">:</span> factor<span class="token punctuation">)</span>            res<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>dict<span class="token punctuation">.</span><span class="token function">getOrDefault</span><span class="token punctuation">(</span>num<span class="token punctuation">,</span> <span class="token string">'@'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(n)$</li><li>空间复杂度：$O( n)$</li></ul><h3 id="Dat-Bae"><a href="#Dat-Bae" class="headerlink" title="Dat Bae"></a>Dat Bae</h3><blockquote><h3 id="Problem-3"><a href="#Problem-3" class="headerlink" title="Problem"></a>Problem</h3><p>A research consortium has built a new database system for their new data center. The database is made up of one master computer and <strong>N</strong> worker computers, which are given IDs from 0 to <strong>N</strong>-1. Each worker stores exactly one bit of information… which seems rather wasteful, but this is very important data!</p><p>You have been hired to evaluate the following instruction for the database:</p><ul><li><code>TEST_STORE</code> <bits>: The master reads in <bits>, which is a string of <strong>N</strong> bits, and sends the i-th bit to the i-th worker for storage. The master will then read the bits back from the workers and return them to the user, in the same order in which they were read in.</bits></bits></li></ul><p>During normal operation, <code>TEST_STORE</code> should return the same string of bits that it read in, but unfortunately, <strong>B</strong> of the workers are broken!</p><p>The broken workers are correctly able to store the bits given to them, but whenever the master tries to read from a broken worker, no bit is returned. This causes the <code>TEST_STORE</code> operation to return only <strong>N</strong>-<strong>B</strong> bits, which are the bits stored on the non-broken workers (in ascending order of their IDs). For example, suppose <strong>N</strong> = 5 and the 0th and 3rd workers are broken (so <strong>B</strong> = 2). Then:</p><ul><li><code>TEST_STORE 01101</code> returns <code>111</code>.</li><li><code>TEST_STORE 00110</code> returns <code>010</code>.</li><li><code>TEST_STORE 01010</code> returns <code>100</code>.</li><li><code>TEST_STORE 11010</code> also returns <code>100</code>.</li></ul><p>For security reasons, the database is hidden in an underground mountain vault, so calls to <code>TEST_STORE</code> take a very long time. You have been tasked with working out which workers are broken using at most <strong>F</strong> calls to <code>TEST_STORE</code>.</p><h3 id="Input-and-output"><a href="#Input-and-output" class="headerlink" title="Input and output"></a>Input and output</h3><p>This is an interactive problem. You should make sure you have read the information in the Interactive Problems section of our <a href="https://codingcompetitions.withgoogle.com/codejam/faq">FAQ</a>.</p><p>Initially, your program should read a single line containing a single integer <strong>T</strong>indicating the number of test cases. Then, you need to process <strong>T</strong> test cases.</p><p>For each test case, your program will first read a single line containing three integers <strong>N</strong>, <strong>B</strong>, and <strong>F</strong>, indicating the number of workers, the number of broken workers, and the number of lines you may send (as described below).</p><p>Then you may send the judge up to <strong>F</strong> lines, each containing a string of exactly <strong>N</strong>characters, each either <code>0</code> or <code>1</code>. Each time you send a line, the judge will check that you have not made more than <strong>F</strong> calls. If you have, the judge will send you a single line containing a single <code>-1</code>, and then finish all communication and wait for your program to finish. Otherwise, the judge will send a string of length <strong>N</strong>-<strong>B</strong>: the string returned by <code>TEST_STORE</code>, as described above.</p><p>Once your program knows the index of the <strong>B</strong> broken workers, it can finish the test case by sending <strong>B</strong> space-separated integers: the IDs of the broken workers, in sorted order. This does not count as one of your <strong>F</strong> calls.</p><p>If the <strong>B</strong> integers are not exactly the IDs of the <strong>B</strong> broken workers, you will receive a Wrong Answer verdict, and the judge will send a single line containing <code>-1</code>, and then no additional communication. If your answer was correct, the judge will send a single line with <code>1</code>, followed by the line that begins the next test case (or exit, if that was the last test case).</p><h3 id="Limits-3"><a href="#Limits-3" class="headerlink" title="Limits"></a>Limits</h3><p>Time limit: 20 seconds per test set.<br>Memory limit: 1GB.<br>1 ≤ <strong>T</strong> ≤ 100.<br>2 ≤ <strong>N</strong> ≤ 1024.<br>1 ≤ <strong>B</strong> ≤ min(15, <strong>N</strong>-1).</p><h4 id="Test-set-1-Visible-3"><a href="#Test-set-1-Visible-3" class="headerlink" title="Test set 1 (Visible)"></a>Test set 1 (Visible)</h4><p><strong>F</strong> = 10.</p><h4 id="Test-set-2-Hidden-1"><a href="#Test-set-2-Hidden-1" class="headerlink" title="Test set 2 (Hidden)"></a>Test set 2 (Hidden)</h4><p><strong>F</strong> = 5.</p><h3 id="Testing-Tool"><a href="#Testing-Tool" class="headerlink" title="Testing Tool"></a>Testing Tool</h3><p>You can use this testing tool to test locally or on our servers. To test locally, you will need to run the tool in parallel with your code; you can use our <a href="https://storage.googleapis.com/coding-competitions.appspot.com/interactive_runner.py">interactive runner</a> for that. For more information, read the Interactive Problems section of the <a href="https://codingcompetitions.withgoogle.com/codejam/faq">FAQ</a>.</p><h3 id="Local-Testing-Tool"><a href="#Local-Testing-Tool" class="headerlink" title="Local Testing Tool"></a>Local Testing Tool</h3><p>To better facilitate local testing, we provide you the following script. Instructions are included inside. You are encouraged to add more test cases for better testing. Please be advised that although the testing tool is intended to simulate the judging system, it is <strong>NOT</strong> the real judging system and might behave differently.</p><p>If your code passes the testing tool but fails the real judge, please check <a href="https://code.google.com/codejam/resources/faq#language-details">here</a> to make sure that you are using the same compiler as us.</p><p><a href="https://codingcompetitions.withgoogle.com/codejam/round/0000000000051705/00000000000881de#"><em>file_download</em>Download testing_tool.py</a></p><h3 id="Sample-Interaction"><a href="#Sample-Interaction" class="headerlink" title="Sample Interaction"></a>Sample Interaction</h3><p>The following interaction meets the limits for Test set 1.</p><pre class="line-numbers language-python"><code class="language-python">  t <span class="token operator">=</span> readline_int<span class="token punctuation">(</span><span class="token punctuation">)</span>           <span class="token operator">//</span> Reads <span class="token number">2</span> into t  n<span class="token punctuation">,</span> b<span class="token punctuation">,</span> f <span class="token operator">=</span> readline_int_list<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token operator">//</span> Reads <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">10</span> into n<span class="token punctuation">,</span> b<span class="token punctuation">,</span> f  printline <span class="token number">01101</span> to stdout    <span class="token operator">//</span> The next four outputs match the example <span class="token keyword">in</span>                               <span class="token operator">//</span> the problem statement<span class="token punctuation">.</span>  flush stdout  response <span class="token operator">=</span> readline_str<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token operator">//</span> Reads <span class="token number">111</span> into response<span class="token punctuation">.</span> <span class="token punctuation">(</span>At this point<span class="token punctuation">,</span> we                               <span class="token operator">//</span> could determine the answer<span class="token punctuation">;</span> the remaining                               <span class="token operator">//</span> queries are just examples!<span class="token punctuation">)</span>  printline <span class="token number">00110</span> to stdout  flush stdout  response <span class="token operator">=</span> readline_str<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token operator">//</span> Reads <span class="token number">010</span> into response  printline <span class="token number">01010</span> to stdout  flush stdout  response <span class="token operator">=</span> readline_str<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token operator">//</span> Reads <span class="token number">100</span> into response  printline <span class="token number">11010</span> to stdout  flush stdout  response <span class="token operator">=</span> readline_str<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token operator">//</span> Reads <span class="token number">100</span> into response  printline <span class="token number">0</span> <span class="token number">3</span> to stdout      <span class="token operator">//</span> Guesses the answer<span class="token punctuation">.</span> Notice that we were                               <span class="token operator">//</span> <span class="token operator">not</span> required to use all <span class="token number">10</span> of our allowed                               <span class="token operator">//</span> queries<span class="token punctuation">.</span>  flush stdout  verdict <span class="token operator">=</span> readline_int<span class="token punctuation">(</span><span class="token punctuation">)</span>     <span class="token operator">//</span> Reads <span class="token number">1</span> into verdict<span class="token punctuation">.</span> We got that test case                               <span class="token operator">//</span> right!  n<span class="token punctuation">,</span> b<span class="token punctuation">,</span> f <span class="token operator">=</span> readline_int_list<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token operator">//</span> Reads <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span> into n<span class="token punctuation">,</span> b<span class="token punctuation">,</span> f<span class="token punctuation">.</span>  printline <span class="token number">01</span> to stdout       <span class="token operator">//</span> <span class="token number">01</span> <span class="token keyword">is</span> a query<span class="token punctuation">,</span> <span class="token operator">not</span> a guess at the final                               <span class="token operator">//</span> answer <span class="token punctuation">(</span><span class="token keyword">if</span> we wanted to guess that just                               <span class="token operator">//</span> worker <span class="token number">1</span> were broken<span class="token punctuation">,</span> we would have to                               <span class="token operator">//</span> send <span class="token number">1</span> <span class="token keyword">as</span> we do below<span class="token punctuation">)</span>  flush stdout  response <span class="token operator">=</span> readline_str<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token operator">//</span> Reads <span class="token number">1</span> into response<span class="token punctuation">.</span>  printline <span class="token number">1</span> to stdout        <span class="token operator">//</span> Makes a <span class="token punctuation">(</span>bad<span class="token punctuation">)</span> wild guess<span class="token punctuation">.</span>  verdict <span class="token operator">=</span> readline_str<span class="token punctuation">(</span><span class="token punctuation">)</span>     <span class="token operator">//</span> Reads <span class="token operator">-</span><span class="token number">1</span> into verdict<span class="token punctuation">.</span>  exit                         <span class="token operator">//</span> exits to avoid an ambiguous TLE error<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></blockquote><p>这题比赛的时候没有做，现在研究一下。</p><p>少见的交互题，其实就是和控制台输入输出的交互。</p><p>说的是如何在有限次收发信息中确定缺失的机子有哪些。</p><p>这题可以说是四道题里面最难的一道了，也是做的人最少的。以下思路和代码来自分析：</p><ol><li><p>首先，介绍一下这题的交互方式：</p><ul><li>开头输入和其他题目一样，先输入次数，然后每轮输入N，B和F；</li><li>程序需要输出F行，每行是测试数据（也就是长度为N的0和1的字符串）</li><li>此时交互端读取程序输出，并依次返回测试结果到输出。</li><li>程序需要读入结果，分析出出错的序号，中间用空格分开。</li><li>交互端会根据读入的结果，返回-1或者1，前者表示错误而后者表示正确。</li></ul></li><li><p>思路？</p><ul><li><p>首先，如果一台机器坏了，那么它接下来的反馈不论如何都会缺失，所以导致整列数据缺失；</p></li><li><p>在case1中，长度是1024，允许猜测10次；那么我们需要构造出一个序列，使得每一列都具有一个独特的标示，而我们读出缺少的列就可以判断缺少的数。幸运的是，1024是2的10次方，所以我们能够如此构造：</p><ul><li>由01重复构成的串</li><li>由0011节重复构成的串</li><li>由00001111节重复构成的串</li><li>……</li><li>由16个0和16个1组成的节重复构成的串</li></ul><p>为什么要这么构造呢？那是因为我们可以惊奇的发现，这样做之后，从左到右的列，它们从下往上排列的串——比如，第一列是0000000000，第二列是0000000001——刚好是列的序号的二进制表示。最后一个串是1111111111，即1023。如此一来，我们可以通过判断某个数字是否存在来判断列是否缺失。</p></li><li><p>在case2中，我们最多只能请求5次，这就不像第一部分一样直接，但是思路是类似的。由于我们只能够使用5次，那么我们只能表示从0到2的5次，也就是0～15的范围。我们无法直接用列的数字和列关联起来，但是我们可以把所有的列分为16个一组，通过组号和组内缺失的数字来确定丢失的数字。</p><ul><li>注意，因为坏掉的机器最多只有15台，所以不会出现整个组都坏掉，或者本来在两组的部分被当作一组来看待——举个例子，如果最坏情况出现，那就是连续的15台机器坏掉，从某组的1号开始一直坏到15号，那么它和下一组将会有2个0，我们依然能够将它们区分成两组（因为没有一组会包含两个相同的数字）。</li></ul></li></ul></li></ol><p>代码来源：<a href="https://github.com/arthtyagi/Google-Code-Jam">https://github.com/arthtyagi/Google-Code-Jam</a></p><p>遗憾的是，这段代码测试是re。目前没有找到简洁的代码。</p><p>有时间我自己写一份吧😠</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> sys<span class="token keyword">def</span> <span class="token function">solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    N<span class="token punctuation">,</span> B<span class="token punctuation">,</span> F <span class="token operator">=</span> map<span class="token punctuation">(</span>int<span class="token punctuation">,</span> input<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    mask <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">&lt;&lt;</span> F<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>F<span class="token punctuation">)</span><span class="token punctuation">:</span>        send <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>map<span class="token punctuation">(</span>str<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>mask <span class="token operator">&amp;</span> x<span class="token punctuation">)</span> <span class="token operator">>></span> i<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> range<span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>send<span class="token punctuation">)</span>    sys<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>flush<span class="token punctuation">(</span><span class="token punctuation">)</span>    recv <span class="token operator">=</span> <span class="token punctuation">[</span>list<span class="token punctuation">(</span>map<span class="token punctuation">(</span>int<span class="token punctuation">,</span> input<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> range<span class="token punctuation">(</span>F<span class="token punctuation">)</span><span class="token punctuation">]</span>      ans <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    i <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">for</span> x <span class="token keyword">in</span> range<span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> i <span class="token operator">==</span> N <span class="token operator">-</span> B<span class="token punctuation">:</span>            ans<span class="token punctuation">.</span>append<span class="token punctuation">(</span>x<span class="token punctuation">)</span>            <span class="token keyword">continue</span>        xx <span class="token operator">=</span> <span class="token number">0</span>        <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span>F<span class="token punctuation">)</span><span class="token punctuation">:</span>            xx <span class="token operator">|</span><span class="token operator">=</span> <span class="token punctuation">(</span>recv<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> j        <span class="token keyword">if</span> xx <span class="token operator">==</span> <span class="token punctuation">(</span>x <span class="token operator">&amp;</span> mask<span class="token punctuation">)</span><span class="token punctuation">:</span>            i <span class="token operator">+=</span> <span class="token number">1</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            ans<span class="token punctuation">.</span>append<span class="token punctuation">(</span>x<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>map<span class="token punctuation">(</span>str<span class="token punctuation">,</span> ans<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    sys<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>flush<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> int<span class="token punctuation">(</span>input<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    T <span class="token operator">=</span> int<span class="token punctuation">(</span>input<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> _ <span class="token keyword">in</span> range<span class="token punctuation">(</span>T<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token operator">not</span> solve<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">break</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> competition </category>
          
      </categories>
      
      
        <tags>
            
            <tag> code jam </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ML学习日记4——以少女前线为例讲解贝叶斯分类算法</title>
      <link href="/ML-4-Bayesian/"/>
      <url>/ML-4-Bayesian/</url>
      
        <content type="html"><![CDATA[<p>看了李宏毅老师讲解classification的视频，决定以少女前线的枪种分类为例，试做一个贝叶斯分类器。</p><p>前半段理论主要来自李宏毅老师的视频，后半段是自己实现的贝叶斯分类器代码。</p><p><img src="/ML-4-Bayesian/head.jpg" alt></p><p><s>找这张配图的时间比码字时间还长</s></p><p>我永远喜欢忤逆小队！</p><a id="more"></a><h2 id="理论部分"><a href="#理论部分" class="headerlink" title="理论部分"></a>理论部分</h2><h3 id="话题引入"><a href="#话题引入" class="headerlink" title="话题引入"></a>话题引入</h3><p>首先做一个题。</p><p>我有两个抽屉A和B，里面放着白球和红球；</p><p>A中红球和白球的个数比为1:3，B中红球和白球的个数比为2:3；</p><p>现在要从两个抽屉中抽一个球，从A抽屉和B抽屉中选择的概率比为1:2；</p><p>如果抽中红球，问：求抽到的球来自A抽屉的概率？</p><p>答案很简单，$P(A|red)=\frac{P(A)P(red|A)}{P(A)P(red|A)+P(B)P(red|B)}$</p><h3 id="分类思想"><a href="#分类思想" class="headerlink" title="分类思想"></a>分类思想</h3><p>首先，我们知道类和类之间是有联系的，我们不能完全确定x是否属于A或者B类，而是只能把归属可能性最大的类作为我们对x的分类。</p><p>现在我们不妨脑洞大开一下，把一个抽屉当作一个类别，把球当做一个需要分类的对象，我们需要找到这个球是哪一类的，其实就是找到这个球最有可能来自哪个抽屉，这样就和上面的公式是一回事了。</p><p>换言之，对某一个待归类的x，我们把它当作是已经取出的”球”，通过计算某个类别（抽屉）产生出case（从这一抽屉中抽球）的概率，以及各个类别（抽屉）产生出这一个x的概率，就可以计算出x属于每一类的概率。</p><p>当它属于某一类A的概率最大的时候，我们就将它分类为A类。</p><p>这一模型又被称为<em>generative model</em>——生成模型，也就是说这个模型其实不单可以归类，也可以用于产生case。</p><h3 id="具体分析产生的模型是什么样的？"><a href="#具体分析产生的模型是什么样的？" class="headerlink" title="具体分析产生的模型是什么样的？"></a>具体分析产生的模型是什么样的？</h3><p>根据刚才的模型，我们需要两类参数才能计算分类概率：</p><ol><li>某个类生产case的概率（从这个抽屉抽球的概率）</li><li>这个类产生出的case是x的概率（抽到的球是红球的概率）</li></ol><p>对1，使用训练集中该类的数据量占总数据量的个数作为这个类生产case的概率。</p><p>比较复杂的是2：</p><h4 id="生成的数据是x的概率如何计算？"><a href="#生成的数据是x的概率如何计算？" class="headerlink" title="生成的数据是x的概率如何计算？"></a>生成的数据是x的概率如何计算？</h4><p>我们以少前各个枪种为例：每一把枪具有血量、伤害、命中、回避、射速等等数值属性，它们都是一定范围内的整数，可以看作连续变量，而且同一类枪种的某一属性值都比较接近（比如，rf狙击枪的满级伤害普遍在120+，而射速普遍在40以下），可以认为是一个多维的正态分布生成的。</p><p>这样一来，我们可以以x属性在这一正态分布下的概率密度（注意，离散变量谈概率而连续变量谈概率密度）作为生成数据是x的概率。</p><h4 id="那么，怎样求出这一个正态分布的参数？"><a href="#那么，怎样求出这一个正态分布的参数？" class="headerlink" title="那么，怎样求出这一个正态分布的参数？"></a>那么，<strong>怎样求出这一个正态分布的参数</strong>？</h4><p>方法是极大似然估计：选取让过去发生的事情可能性最大的参数。</p><p>对一个正态分布$f_{\mu,\sum}$，它得出之前的case的概率越大，它就越好。</p><p>所以把最大似然作为目标函数，取微分为0的参数为最好的参数（过程略）：</p><ul><li><p>对一类train data，取它们的平均值作为$\mu$即$\mu=\frac{\sum_{i=1}^nx^i}{n}$，而$\sum=\frac{\sum^n_{i=1}(x^i-\mu)(x^i-\mu)^T}{n}​$。</p></li><li><p>注意这里的$\mu$是维度等于属性个数的向量，$\sum$是属性的协方差矩阵。</p></li></ul><h4 id="有了参数，如何评估产生x的可能性？"><a href="#有了参数，如何评估产生x的可能性？" class="headerlink" title="有了参数，如何评估产生x的可能性？"></a>有了参数，<strong>如何评估产生x的可能性</strong>？</h4><p>套公式呗。高斯分布的概率密度公式：</p><p>$P(C_i) * P(x | C_i) = \frac{1}{(2\pi)^{D/2}}\frac{1}{|\sum^i|^{1/2}}exp({-\frac{1}{2}(x-\mu^i)(\sum^i)^{-1}(x-\mu^i)})$</p><blockquote><p>【补充】多元正态分布的参数：</p><p>先从各维度不相关的多元正态分布入手，数据点通过d维的列向量描述$x=\left[ x_1,x_2,\cdots,x_d \right]^T$，各个维度的均值方差分别为$[\mu_1,\mu_2,\cdots,\mu_d]$ , $[\sigma_1,\sigma_2,\cdots,\sigma_d]$ 来描述，高斯概率密度函数可以表示为：</p><p>$f(x)=\frac{1}{(\sqrt{2\pi})^d\sigma_1\sigma_2\cdots\sigma_d}e^{-\frac{1}{2}[(\frac{x_1-\mu_1}{\sigma_1})^2+(\frac{x_2-\mu_2}{\sigma_2})^2+\cdots+(\frac{x_d-\mu_1}{\sigma_d})^2]}​$</p><p>前面多出的项是为了让概率之和为1，其实这个方程可以这样子去解读：</p><p>$f(x)=\frac{1}{(\sqrt{2\pi})\sigma_1}e^{-\frac{1}{2}(\frac{x_1-\mu_1}{\sigma_1})^2}\frac{1}{(\sqrt{2\pi})\sigma_2}e^{-\frac{1}{2}(\frac{x_2-\mu_2}{\sigma_2})^2}\cdots\frac{1}{(\sqrt{2\pi})\sigma_d}e^{-\frac{1}{2}(\frac{x_d-\mu_d}{\sigma_d})^2}$</p><p>而当我们考虑变量之间的并不独立的情况，我们可以用$\sum$相关矩阵取代$\sigma$向量（其实原本的$\sigma$向量可以看作是一个主对角阵，而$\sum$是它的一般化，其他位置表示的是各个维度之间的关系）</p></blockquote><h2 id="实践部分"><a href="#实践部分" class="headerlink" title="实践部分"></a>实践部分</h2><p>多说无益，开始写代码。</p><h3 id="读取数据"><a href="#读取数据" class="headerlink" title="读取数据"></a>读取数据</h3><ul><li>选取了数据的6-10列，即血量、伤害、命中、回避、射速属性。<a href="https://drive.google.com/file/d/1AKcKtE_YvYDCMFMOojWJ5I-z0KOiWVPh/view?usp=sharing">数据在这里哦</a></li><li>切分成test和train两部分。</li></ul><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span class="token keyword">from</span> random <span class="token keyword">import</span> randint<span class="token keyword">def</span> <span class="token function">loadData</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">:</span>    content <span class="token operator">=</span> np<span class="token punctuation">.</span>loadtxt<span class="token punctuation">(</span>file<span class="token punctuation">,</span> dtype<span class="token operator">=</span>np<span class="token punctuation">.</span>str<span class="token punctuation">,</span> delimiter<span class="token operator">=</span><span class="token string">','</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>    types <span class="token operator">=</span> <span class="token punctuation">[</span>line<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token keyword">for</span> line <span class="token keyword">in</span> content<span class="token punctuation">]</span>    attrs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>float<span class="token punctuation">(</span>num<span class="token punctuation">)</span> <span class="token keyword">for</span> num <span class="token keyword">in</span> line<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token keyword">for</span> line <span class="token keyword">in</span> content<span class="token punctuation">]</span>    <span class="token keyword">return</span> types<span class="token punctuation">,</span> attrs<span class="token keyword">def</span> <span class="token function">splitCases</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> len<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">!=</span> len<span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    trainX<span class="token punctuation">,</span> trainY<span class="token punctuation">,</span> testX<span class="token punctuation">,</span> testY <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> randint<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">3</span><span class="token punctuation">:</span>            testX<span class="token punctuation">.</span>append<span class="token punctuation">(</span>x<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>            testY<span class="token punctuation">.</span>append<span class="token punctuation">(</span>y<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            trainX<span class="token punctuation">.</span>append<span class="token punctuation">(</span>x<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>            trainY<span class="token punctuation">.</span>append<span class="token punctuation">(</span>y<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> trainX<span class="token punctuation">,</span> trainY<span class="token punctuation">,</span> testX<span class="token punctuation">,</span> testYtypes<span class="token punctuation">,</span> attrs <span class="token operator">=</span> loadData<span class="token punctuation">(</span><span class="token string">'./data/gf.csv'</span><span class="token punctuation">)</span>TrainX<span class="token punctuation">,</span> TrainY<span class="token punctuation">,</span> TestX<span class="token punctuation">,</span> TestY <span class="token operator">=</span> splitCases<span class="token punctuation">(</span>attrs<span class="token punctuation">,</span> types<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="求高斯分布参数"><a href="#求高斯分布参数" class="headerlink" title="求高斯分布参数"></a>求高斯分布参数</h3><ul><li>按照枪种分类形成字典，并且计算出每一类枪的高斯分布参数（协方差矩阵）：</li></ul><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">splitByType</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>    _groups <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>    <span class="token keyword">for</span> _i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> y<span class="token punctuation">[</span>_i<span class="token punctuation">]</span> <span class="token operator">not</span> <span class="token keyword">in</span> _groups<span class="token punctuation">:</span>            _groups<span class="token punctuation">[</span>y<span class="token punctuation">[</span>_i<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        _groups<span class="token punctuation">[</span>y<span class="token punctuation">[</span>_i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span>x<span class="token punctuation">[</span>_i<span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> _groups<span class="token keyword">def</span> <span class="token function">gaussianFit</span><span class="token punctuation">(</span>_attr<span class="token punctuation">)</span><span class="token punctuation">:</span>    _n<span class="token punctuation">,</span> _m <span class="token operator">=</span> len<span class="token punctuation">(</span>_attr<span class="token punctuation">)</span><span class="token punctuation">,</span> len<span class="token punctuation">(</span>_attr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    _mean <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>_m<span class="token punctuation">)</span>    _sigma <span class="token operator">=</span> np<span class="token punctuation">.</span>mat<span class="token punctuation">(</span>np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>_m<span class="token punctuation">,</span> _m<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> _j <span class="token keyword">in</span> range<span class="token punctuation">(</span>_m<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> _i <span class="token keyword">in</span> range<span class="token punctuation">(</span>_n<span class="token punctuation">)</span><span class="token punctuation">:</span>            _mean<span class="token punctuation">[</span>_j<span class="token punctuation">]</span> <span class="token operator">+=</span> _attr<span class="token punctuation">[</span>_i<span class="token punctuation">]</span><span class="token punctuation">[</span>_j<span class="token punctuation">]</span>        _mean<span class="token punctuation">[</span>_j<span class="token punctuation">]</span> <span class="token operator">/=</span> _n    <span class="token keyword">for</span> _i <span class="token keyword">in</span> range<span class="token punctuation">(</span>_n<span class="token punctuation">)</span><span class="token punctuation">:</span>        _tmp <span class="token operator">=</span> np<span class="token punctuation">.</span>mat<span class="token punctuation">(</span><span class="token punctuation">[</span>_attr<span class="token punctuation">[</span>_i<span class="token punctuation">]</span><span class="token punctuation">[</span>_j<span class="token punctuation">]</span> <span class="token operator">-</span> _mean<span class="token punctuation">[</span>_j<span class="token punctuation">]</span> <span class="token keyword">for</span> _j <span class="token keyword">in</span> range<span class="token punctuation">(</span>_m<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        _sigma <span class="token operator">+=</span> np<span class="token punctuation">.</span>transpose<span class="token punctuation">(</span>_tmp<span class="token punctuation">)</span> <span class="token operator">*</span> _tmp    <span class="token keyword">return</span> _mean<span class="token punctuation">,</span> _sigmaGroup <span class="token operator">=</span> splitByType<span class="token punctuation">(</span>TrainX<span class="token punctuation">,</span> TrainY<span class="token punctuation">)</span>names<span class="token punctuation">,</span> pClass<span class="token punctuation">,</span> means<span class="token punctuation">,</span> sigmas <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>count <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">for</span> name<span class="token punctuation">,</span> attr <span class="token keyword">in</span> Group<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    names<span class="token punctuation">.</span>append<span class="token punctuation">(</span>name<span class="token punctuation">)</span>    pClass<span class="token punctuation">.</span>append<span class="token punctuation">(</span>len<span class="token punctuation">(</span>attr<span class="token punctuation">)</span><span class="token punctuation">)</span>    count <span class="token operator">+=</span> len<span class="token punctuation">(</span>attr<span class="token punctuation">)</span>    mean<span class="token punctuation">,</span> sigma <span class="token operator">=</span> gaussianFit<span class="token punctuation">(</span>attr<span class="token punctuation">)</span>    means<span class="token punctuation">.</span>append<span class="token punctuation">(</span>mean<span class="token punctuation">)</span>    sigmas<span class="token punctuation">.</span>append<span class="token punctuation">(</span>sigma<span class="token punctuation">)</span>pClass <span class="token operator">=</span> <span class="token punctuation">[</span>num <span class="token operator">/</span> count <span class="token keyword">for</span> num <span class="token keyword">in</span> pClass<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># 查看一下协方差矩阵：</span><span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>sigmas<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Covariance matrix for %s'</span> <span class="token operator">%</span> names<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>sigmas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre><code>Covariance matrix for HG[[ 53742.96875   1333.28125  -4061.875   -11030.78125  -2615.46875] [  1333.28125    556.46875    327.875     -609.96875   -432.78125] [ -4061.875      327.875     2283.5       1339.125     -111.125  ] [-11030.78125   -609.96875   1339.125     4815.46875    176.28125] [ -2615.46875   -432.78125   -111.125      176.28125   1193.96875]]Covariance matrix for SMG[[ 2.20652679e+05  7.09821429e+02 -1.90000000e+02 -1.86701786e+04  -1.24607143e+03] [ 7.09821429e+02  1.52678571e+02 -2.90000000e+01 -1.96321429e+02  -1.50928571e+02] [-1.90000000e+02 -2.90000000e+01  5.20000000e+01  1.15000000e+02  -6.80000000e+01] [-1.86701786e+04 -1.96321429e+02  1.15000000e+02  2.51867857e+03   3.66071429e+02] [-1.24607143e+03 -1.50928571e+02 -6.80000000e+01  3.66071429e+02   1.58042857e+03]]Covariance matrix for RF[[15886.95652174  -578.26086957  -984.13043478 -1459.13043478   -256.73913043] [ -578.26086957  7262.43478261   811.2173913   -451.7826087   -885.43478261] [ -984.13043478   811.2173913   1592.60869565   257.60869565    -75.2173913 ] [-1459.13043478  -451.7826087    257.60869565   586.60869565    -42.2173913 ] [ -256.73913043  -885.43478261   -75.2173913    -42.2173913    250.43478261]]Covariance matrix for AR[[ 5.72460e+04 -1.57880e+03 -3.07180e+03 -1.26440e+03  9.71200e+02] [-1.57880e+03  1.36664e+03  7.20400e+01 -2.80680e+02 -1.31936e+03] [-3.07180e+03  7.20400e+01  1.00344e+03  5.11520e+02 -2.59600e+01] [-1.26440e+03 -2.80680e+02  5.11520e+02  5.10160e+02  2.51320e+02] [ 9.71200e+02 -1.31936e+03 -2.59600e+01  2.51320e+02  1.81864e+03]]Covariance matrix for MG[[189016.66666667   4573.33333333  -6338.33333333  -9428.33333333  -14030.        ] [  4573.33333333    811.80952381   -404.80952381   -442.52380952   -1365.42857143] [ -6338.33333333   -404.80952381    533.80952381    589.52380952    1174.42857143] [ -9428.33333333   -442.52380952    589.52380952    777.80952381    1376.57142857] [-14030.          -1365.42857143   1174.42857143   1376.57142857    5124.28571429]]Covariance matrix for SG[[ 4.89192308e+04  7.96153846e+02  1.40000000e+02 -9.53461538e+02   1.29230769e+02] [ 7.96153846e+02  1.32769231e+02 -1.00000000e+01 -3.43076923e+01  -1.13846154e+02] [ 1.40000000e+02 -1.00000000e+01  1.20000000e+01  1.40000000e+01   4.00000000e+00] [-9.53461538e+02 -3.43076923e+01  1.40000000e+01  7.09230769e+01  -5.46153846e+00] [ 1.29230769e+02 -1.13846154e+02  4.00000000e+00 -5.46153846e+00   1.59230769e+02]]</code></pre><h3 id="分类器核心代码"><a href="#分类器核心代码" class="headerlink" title="分类器核心代码"></a>分类器核心代码</h3><ul><li><p>这里的<code>calcPossibility</code>使用的公式：</p><p>$P(C_i) * P(x | C_i) = \frac{1}{(2\pi)^{D/2}}\frac{1}{|\sum^i|^{1/2}}exp({-\frac{1}{2}(x-\mu^i)(\sum^i)^{-1}(x-\mu^i)})​$</p><p>（省略和pi相关的第一项常数，以及分母部分）</p></li></ul><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">calcPossibility</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> i<span class="token punctuation">:</span> int<span class="token punctuation">)</span><span class="token punctuation">:</span>    _tmp <span class="token operator">=</span> np<span class="token punctuation">.</span>mat<span class="token punctuation">(</span>x <span class="token operator">-</span> means<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>    _inv <span class="token operator">=</span> np<span class="token punctuation">.</span>linalg<span class="token punctuation">.</span>inv<span class="token punctuation">(</span>sigmas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>    _exp <span class="token operator">=</span> np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0.5</span> <span class="token operator">*</span> _tmp <span class="token operator">*</span> _inv <span class="token operator">*</span> np<span class="token punctuation">.</span>transpose<span class="token punctuation">(</span>_tmp<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> pClass<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> _exp <span class="token operator">/</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>np<span class="token punctuation">.</span>linalg<span class="token punctuation">.</span>det<span class="token punctuation">(</span>sigmas<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">classifier</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>    _maxId<span class="token punctuation">,</span> _maxP <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span>    <span class="token keyword">for</span> _i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>names<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        _currP <span class="token operator">=</span> calcPossibility<span class="token punctuation">(</span>x<span class="token punctuation">,</span> _i<span class="token punctuation">)</span>        <span class="token keyword">if</span> _maxP <span class="token operator">&lt;</span> _currP <span class="token punctuation">:</span>            _maxId<span class="token punctuation">,</span> _maxP <span class="token operator">=</span> _i<span class="token punctuation">,</span> _currP    <span class="token keyword">return</span> names<span class="token punctuation">[</span>_maxId<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="测试数据："><a href="#测试数据：" class="headerlink" title="测试数据："></a>测试数据：</h3><pre class="line-numbers language-python"><code class="language-python">correct <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>TestX<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    guess <span class="token operator">=</span> classifier<span class="token punctuation">(</span>TestX<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'predict: %s, answer: %s'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>guess<span class="token punctuation">,</span> TestY<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> guess <span class="token operator">==</span> TestY<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">:</span>        correct <span class="token operator">+=</span> <span class="token number">1</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Rate of correct predictions: %f'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>correct <span class="token operator">/</span> len<span class="token punctuation">(</span>TestX<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre><code>predict: HG, answer: HGpredict: HG, answer: HGpredict: HG, answer: HGpredict: HG, answer: HGpredict: HG, answer: HGpredict: SMG, answer: SMGpredict: SMG, answer: SMGpredict: RF, answer: RFpredict: RF, answer: RFpredict: RF, answer: RFpredict: RF, answer: RFpredict: RF, answer: RFpredict: RF, answer: RFpredict: AR, answer: ARpredict: AR, answer: ARpredict: AR, answer: ARpredict: AR, answer: ARpredict: AR, answer: ARpredict: AR, answer: ARpredict: AR, answer: ARpredict: MG, answer: MGpredict: MG, answer: MGpredict: MG, answer: MGpredict: MG, answer: MGpredict: MG, answer: MGpredict: HG, answer: HGpredict: HG, answer: HGpredict: SMG, answer: SMGpredict: AR, answer: ARpredict: MG, answer: MGpredict: MG, answer: MGpredict: MG, answer: MGpredict: HG, answer: HGpredict: HG, answer: HGpredict: SMG, answer: SMGpredict: HG, answer: HGpredict: RF, answer: RFpredict: SMG, answer: SMGpredict: SG, answer: SGpredict: SG, answer: SGpredict: SG, answer: SGpredict: HG, answer: HGpredict: MG, answer: MGpredict: SMG, answer: SMGpredict: AR, answer: ARpredict: HG, answer: HGpredict: RF, answer: RFpredict: AR, answer: ARpredict: SG, answer: SGpredict: AR, answer: ARpredict: SG, answer: SGpredict: RF, answer: RFRate of correct predictions: 1.000000</code></pre><p>竟然是100%？？这么高的准确率，我佛了。。。</p><p>大概是因为少前里面每一种枪的特征太好区分了吧。</p><p>这里用sklearn库的朴素贝叶斯再试试：</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>naive_bayes <span class="token keyword">import</span> GaussianNBmodel <span class="token operator">=</span> GaussianNB<span class="token punctuation">(</span><span class="token punctuation">)</span>model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>TrainX<span class="token punctuation">,</span> TrainY<span class="token punctuation">)</span>res <span class="token operator">=</span> model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>TestX<span class="token punctuation">)</span>count <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'predict: %s, answer: %s'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>res<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> TestY<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> res<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> TestY<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">:</span>        count <span class="token operator">+=</span> <span class="token number">1</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Rate of correct predictions: %f'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>count <span class="token operator">/</span> len<span class="token punctuation">(</span>TestY<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre><code>predict: HG, answer: HGpredict: HG, answer: HGpredict: HG, answer: HGpredict: HG, answer: HGpredict: HG, answer: HGpredict: SMG, answer: SMGpredict: SMG, answer: SMGpredict: RF, answer: RFpredict: RF, answer: RFpredict: RF, answer: RF...Rate of correct predictions: 1.000000</code></pre><ul><li>毫无悬念的100%……好吧这说明少前的数据确实特征很明显=。=</li></ul><h2 id="拓展"><a href="#拓展" class="headerlink" title="拓展"></a>拓展</h2><h3 id="什么是朴素贝叶斯分类？"><a href="#什么是朴素贝叶斯分类？" class="headerlink" title="什么是朴素贝叶斯分类？"></a>什么是朴素贝叶斯分类？</h3><p>假设所有特征是比较独立的情况下，上面的$\sum$矩阵退化为对角阵，可以用$\sigma$向量表示；</p><p>这个时候就是朴素贝叶斯分类，也就是上面sklearn库所做的事情。</p><p>但是在属性特征相关性比较好的时候，NB的分类效果就比较差。</p><p>上面的方法使用的是多个特征的联合概率密度，在维度较高的时候模型就会比较复杂，同时也会造成稀疏的情况。</p><h3 id="可不可以用回归的方法直接做分类？"><a href="#可不可以用回归的方法直接做分类？" class="headerlink" title="可不可以用回归的方法直接做分类？"></a>可不可以用回归的方法直接做分类？</h3><p>一般这么做不好。</p><p>举个例子，用一个回归函数的值和分类对应，函数值接近1就是A类，接近2就是B类，以此类推。</p><p>这样固然可以训练出拟合train data的模型，但是数值上的接近关系不一定就能反映出分类之间的关系（比如，1和2比起1和3更接近，但是A和B不一定就能够比A和C的关系更接近），这样的拟合是不符合分类规律的。</p><h3 id="贝叶斯算法一定是用高斯（正态）分布嘛？"><a href="#贝叶斯算法一定是用高斯（正态）分布嘛？" class="headerlink" title="贝叶斯算法一定是用高斯（正态）分布嘛？"></a>贝叶斯算法一定是用高斯（正态）分布嘛？</h3><p>不一定。这里是根据变量的分布特征决定的，其他还有如多项式模型和伯努利模型都是常见的分布模型。</p><p>特征是离散的时候，一般使用多项式模型；</p><p>特征是离散而且只有0和1两种分布的时候，一般采用伯努利模型。</p><p>特征是连续的时候，一般使用高斯分布模型；</p><h3 id="其他分类器有哪些？"><a href="#其他分类器有哪些？" class="headerlink" title="其他分类器有哪些？"></a>其他分类器有哪些？</h3><p>逻辑回归，SVM，和决策树等等。</p><p>逻辑回归适合线性数据（什么是线性数据？）。</p><p>SVM非常耗时间，工业上不推荐。</p><p>决策树适合用在特征是离散型的变量上。</p><p>贝叶斯通常是用在NLP里面用来做文本分类等等的事情（用在这里也只是因为李宏毅老师讲了这个）</p><p>我暂时说不清楚它们的具体优劣，可以参考<a href="https://blog.csdn.net/July_sun/article/details/53088673">这里</a>。</p><hr><p>其实个人有几个问题：</p><ul><li><p>混合参数如何建模？比如又有数值型，又有离散型，应该用什么模型？</p></li><li><p>协方差矩阵对比朴素贝叶斯的方差向量效果会提高多少？</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> machine learning </category>
          
      </categories>
      
      
        <tags>
            
            <tag> naive bayesian </tag>
            
            <tag> classification </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>32.Longest Valid Partheses</title>
      <link href="/32-Longest-Valid-Partheses/"/>
      <url>/32-Longest-Valid-Partheses/</url>
      
        <content type="html"><![CDATA[<h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p>Given a string containing just the characters <code>&#39;(&#39;</code> and <code>&#39;)&#39;</code>, find the length of the longest valid (well-formed) parentheses substring.</p><a id="more"></a><p><strong>Example 1:</strong></p><pre class="line-numbers language-java"><code class="language-java">Input<span class="token operator">:</span> <span class="token string">"(()"</span>Output<span class="token operator">:</span> <span class="token number">2</span>Explanation<span class="token operator">:</span> The longest valid parentheses substring is <span class="token string">"()"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><strong>Example 2:</strong></p><pre class="line-numbers language-java"><code class="language-java">Input<span class="token operator">:</span> <span class="token string">")()())"</span>Output<span class="token operator">:</span> <span class="token number">4</span>Explanation<span class="token operator">:</span> The longest valid parentheses substring is <span class="token string">"()()"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><h4 id="暴力求解全部序列找最长"><a href="#暴力求解全部序列找最长" class="headerlink" title="暴力求解全部序列找最长"></a>暴力求解全部序列找最长</h4><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">longestValidParentheses</span><span class="token punctuation">(</span>String s<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>s <span class="token operator">==</span> null<span class="token punctuation">)</span>          <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>      <span class="token keyword">int</span> n <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> res <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> start <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> start <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> start<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>          <span class="token keyword">int</span> balance <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> end <span class="token operator">=</span> start<span class="token punctuation">;</span> end <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> end<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>              balance <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>end<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'('</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span>  <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>              <span class="token keyword">if</span> <span class="token punctuation">(</span>balance <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>                  res <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> end <span class="token operator">-</span> start <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>      <span class="token keyword">return</span> res<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(n^2)$</li><li>空间复杂度：$O(1)​$</li></ul><h4 id="dp"><a href="#dp" class="headerlink" title="dp"></a>dp</h4><p>公式理解起来有点困难，下面是解释。</p><ul><li>dp数组记录从0开始，以i位结尾的最长的合法序列长度。</li><li>只有右括号才能形成合法的括号对，所以左括号的dp值为0，在遇到右括号的时候检查：<ul><li>如果前一个括号是左括号，那么长度就是往前找的一位（假如有）+2</li><li>如果前一个括号是右括号，而且往前的一个完整序列之前那一位是左括号（如果没有或者是右括号，那么也不能匹配当前位置），那么长度等于从这个左括号开始到当前位的长度。<ul><li>额外注意⚠️如果在这个左括号之前还存在匹配，那么需要加上这一段的长度！</li></ul></li></ul></li></ul><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">longestValidParentheses</span><span class="token punctuation">(</span>String s<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>s <span class="token operator">==</span> null<span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> res <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> dp<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">int</span><span class="token punctuation">[</span>s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">')'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'('</span><span class="token punctuation">)</span>                dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>i <span class="token operator">>=</span> <span class="token number">2</span> <span class="token operator">?</span> dp<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">;</span>            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">-</span> dp<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i <span class="token operator">-</span> dp<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'('</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">-</span> dp<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">>=</span> <span class="token number">2</span><span class="token punctuation">)</span>                    dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> dp<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> dp<span class="token punctuation">[</span>i <span class="token operator">-</span> dp<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">;</span>                <span class="token keyword">else</span>                    dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> dp<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            res <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> res<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(n)$</li><li>空间复杂度：$O(n)$</li></ul><h4 id="使用栈"><a href="#使用栈" class="headerlink" title="使用栈"></a>使用栈</h4><p>这个做法旨在通过栈维护平衡，把所有不平衡的下标压栈。</p><ul><li>遇到左括号就压栈；</li><li>遇到右括号，如果栈内记录了待匹配的左括号，则出栈；否则（待匹配的是右括号，或者栈是空的情况下）压栈。</li></ul><p>这样一来，栈中所有的下标就是不平衡处的位置，而相邻的下标之间（包括头和尾的-1和n）的字符串就是平衡的，我们只要依次出栈并计算，找到最大值就可以。</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">longestValidParentheses</span><span class="token punctuation">(</span>String s<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>s <span class="token operator">==</span> null<span class="token punctuation">)</span>          <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> res <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> n <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Stack<span class="token operator">&lt;</span>Integer<span class="token operator">></span> stack <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Stack</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    stack<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 这里的-1是为计算方便</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'('</span><span class="token punctuation">)</span>            stack<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">else</span> <span class="token punctuation">{</span>              <span class="token keyword">int</span> last <span class="token operator">=</span> stack<span class="token punctuation">.</span><span class="token function">peek</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>last <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">||</span> s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>last<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">')'</span><span class="token punctuation">)</span>                  stack<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">else</span>                    stack<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>      <span class="token comment" spellcheck="true">// 计算包括-1和n在内所有非平衡下标之间的长度</span>      <span class="token keyword">int</span> right <span class="token operator">=</span> n<span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>stack<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">int</span> left <span class="token operator">=</span> stack<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          res <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> right <span class="token operator">-</span> left <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          right <span class="token operator">=</span> left<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> res<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(n)$</li><li>空间复杂度：$O(n)​$</li></ul><h4 id="双扫描，无额外空间"><a href="#双扫描，无额外空间" class="headerlink" title="双扫描，无额外空间"></a>双扫描，无额外空间</h4><p>这一做法受到最大子序列和的启发——最大子序列和的做法是，累加遇到负数就重置当前的和为0，扫描一遍数组即可得出答案——贪心的思路。</p><p>在这里，我们需要扫描两次：</p><ul><li>从左向右，左括号为1、右括号为-1，和为0时则平衡，和为负时归零；</li><li>从右向左，左括号为-1、右括号为1，其余同上。</li></ul><p>这样得出的最大的长度就是答案。</p><p>那么，如何解释？</p><ul><li>考虑从左向右的情况，在遇到右括号多于左括号的时候归零是合理的。因为不论从那一位开始，以这一位结尾的字符串肯定是不平衡的。而我们无法顾及的情况在于左括号偏多的情形：很有可能开头的几个左括号一直到最后都没有匹配的右括号，而中间潜在的合法匹配被我们忽略（因为和一直是正数）。</li><li>上面描述的这个情形，从右向左的扫描能够帮我们解决。相应的，从右到左的扫描无法解决的右括号偏多的情形，这在左括号里面得以解决。</li><li>两次扫描分别解决了两种情形，比较得出长度最大的是哪一种，就是答案。</li></ul><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">longestValidParentheses</span><span class="token punctuation">(</span>String s<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>s <span class="token operator">==</span> null<span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> res <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> len <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> n <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        sum <span class="token operator">+=</span> s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'('</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>sum <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>            sum <span class="token operator">=</span> len <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">else</span> <span class="token punctuation">{</span>            len<span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>sum <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>                res <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    sum <span class="token operator">=</span> len <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        sum <span class="token operator">+=</span> s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">')'</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>sum <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>            sum <span class="token operator">=</span> len <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">else</span> <span class="token punctuation">{</span>            len<span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>sum <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>                res <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> res<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(n)$</li><li>空间复杂度：$O(1)$</li></ul>]]></content>
      
      
      <categories>
          
          <category> leetcode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hard </tag>
            
            <tag> dp </tag>
            
            <tag> string </tag>
            
            <tag> stack </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>31.Next Permutation</title>
      <link href="/31-Next-Permutation/"/>
      <url>/31-Next-Permutation/</url>
      
        <content type="html"><![CDATA[<h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p>Implement <strong>next permutation</strong>, which rearranges numbers into the lexicographically next greater permutation of numbers.</p><p>If such arrangement is not possible, it must rearrange it as the lowest possible order (ie, sorted in ascending order).</p><p>The replacement must be <strong>in-place</strong> and use only constant extra memory.</p><a id="more"></a><p>Here are some examples. Inputs are in the left-hand column and its corresponding outputs are in the right-hand column.</p><pre class="line-numbers language-java"><code class="language-java"><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span> → <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span> → <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span> → <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><h4 id="暴力求解全排列"><a href="#暴力求解全排列" class="headerlink" title="暴力求解全排列"></a>暴力求解全排列</h4><ul><li><p>时间复杂度：$O(n!)$</p></li><li><p>空间复杂度：$O(n)$</p></li></ul><h4 id="寻找排列规律"><a href="#寻找排列规律" class="headerlink" title="寻找排列规律"></a>寻找排列规律</h4><ul><li>找到前一个排列和后一个排列的关系<ul><li>例如，<code>1234</code>—&gt;<code>1243</code></li><li><code>3124</code>—&gt;<code>3214</code></li><li><code>4321</code>—&gt;<code>1234</code></li><li>从右到左，找到第一个违反【非降序规律】的数，将它和右边第一个比它大的数交换（交换其实是让它插入合适的位置）（这里可以用二分查找），然后逆序排列（也就是让剩下来的数按照从左到右非降序排列）</li></ul></li><li>注意⚠️，可能出现重复数字</li></ul><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">swap</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">,</span> <span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> tmp <span class="token operator">=</span> nums<span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">;</span>        nums<span class="token punctuation">[</span>a<span class="token punctuation">]</span> <span class="token operator">=</span> nums<span class="token punctuation">[</span>b<span class="token punctuation">]</span><span class="token punctuation">;</span>        nums<span class="token punctuation">[</span>b<span class="token punctuation">]</span> <span class="token operator">=</span> tmp<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">reverse</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">,</span> <span class="token keyword">int</span> from<span class="token punctuation">,</span> <span class="token keyword">int</span> to<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> from<span class="token punctuation">,</span> j <span class="token operator">=</span> to <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> j<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">,</span> j<span class="token operator">--</span><span class="token punctuation">)</span>              <span class="token function">swap</span><span class="token punctuation">(</span>nums<span class="token punctuation">,</span> i<span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">nextPermutation</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> n <span class="token operator">=</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">,</span> iter<span class="token punctuation">,</span> last <span class="token operator">=</span> n <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;</span> <span class="token number">2</span><span class="token punctuation">)</span>              <span class="token keyword">return</span><span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>last <span class="token operator">>=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> nums<span class="token punctuation">[</span>last<span class="token punctuation">]</span> <span class="token operator">>=</span> nums<span class="token punctuation">[</span>last <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>            last<span class="token operator">--</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>last <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">int</span> minBigger <span class="token operator">=</span> last <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token keyword">while</span> <span class="token punctuation">(</span>minBigger <span class="token operator">&lt;</span> n <span class="token operator">-</span> <span class="token number">1</span>                    <span class="token operator">&amp;&amp;</span> nums<span class="token punctuation">[</span>minBigger <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">></span> nums<span class="token punctuation">[</span>last<span class="token punctuation">]</span><span class="token punctuation">)</span>                minBigger<span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token function">swap</span><span class="token punctuation">(</span>nums<span class="token punctuation">,</span> last<span class="token punctuation">,</span> minBigger<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token function">reverse</span><span class="token punctuation">(</span>nums<span class="token punctuation">,</span> last <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(n)$</li><li>空间复杂度：$O(1)$</li></ul>]]></content>
      
      
      <categories>
          
          <category> leetcode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> string </tag>
            
            <tag> medium </tag>
            
            <tag> permutation </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ML学习日记3——梯度下降技巧</title>
      <link href="/ML-3-Gradient-Descent/"/>
      <url>/ML-3-Gradient-Descent/</url>
      
        <content type="html"><![CDATA[<p>一些改进梯度下降方法的要点。</p><a id="more"></a><h3 id="自适应学习率：Adagrad-learning-rate"><a href="#自适应学习率：Adagrad-learning-rate" class="headerlink" title="自适应学习率：Adagrad learning rate"></a>自适应学习率：Adagrad learning rate</h3><ul><li>学习率太大或者太小，都会导致问题<ul><li>太小会收敛过慢</li><li>太大会不收敛</li></ul></li><li>自适应学习率可以较好地改变情况</li></ul><p><img src="/ML-3-Gradient-Descent/IMG_2209.PNG" alt="IMG_2209"></p><p><img src="/ML-3-Gradient-Descent/IMG_2210.PNG" alt="IMG_2210"></p><p><img src="/ML-3-Gradient-Descent/IMG_2211.PNG" alt="IMG_2211"></p><h3 id="随机梯度下降：Stochastic-gradient-descent"><a href="#随机梯度下降：Stochastic-gradient-descent" class="headerlink" title="随机梯度下降：Stochastic gradient descent"></a>随机梯度下降：Stochastic gradient descent</h3><ul><li>每次选取少量样本进行梯度下降</li><li>每一步未必朝着正确的方向，但是在全局一步的时间里可以进行多次迭代从而到达终点</li></ul><h3 id="特征归一化：Feature-scaling"><a href="#特征归一化：Feature-scaling" class="headerlink" title="特征归一化：Feature scaling"></a>特征归一化：Feature scaling</h3><ul><li>将所有维度统一到0和1（作为例子）的尺度，避免单一维度的weight变化影响全局太多或者太少</li></ul><p><img src="/ML-3-Gradient-Descent/IMG_2212.PNG" alt="IMG_2212"></p>]]></content>
      
      
      <categories>
          
          <category> machine learning </category>
          
      </categories>
      
      
        <tags>
            
            <tag> gradient descent </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Microsoft 2019暑期OA题目</title>
      <link href="/Microsoft-2019%E6%9A%91%E6%9C%9FOA%E9%A2%98%E7%9B%AE/"/>
      <url>/Microsoft-2019%E6%9A%91%E6%9C%9FOA%E9%A2%98%E7%9B%AE/</url>
      
        <content type="html"><![CDATA[<p>做了一晚上，心态崩了。。两小时4题，这难度堪比acm。</p><a id="more"></a><p>不说了，下面贴题目吧：</p><h3 id="Playing-with-beads"><a href="#Playing-with-beads" class="headerlink" title="Playing with beads"></a>Playing with beads</h3><blockquote><p><img src="/Microsoft-2019暑期OA题目/1-1.png" alt="1-1"></p><p><img src="/Microsoft-2019暑期OA题目/1-2.png" alt="1-2"></p></blockquote><h3 id="Archer"><a href="#Archer" class="headerlink" title="Archer"></a>Archer</h3><blockquote><p><img src="/Microsoft-2019暑期OA题目/2-1.png" alt="2-1"></p><p><img src="/Microsoft-2019暑期OA题目/2-2.png" alt="2-2"></p></blockquote><h3 id="Line"><a href="#Line" class="headerlink" title="Line"></a>Line</h3><blockquote><p><img src="/Microsoft-2019暑期OA题目/3-1.png" alt="3-1"></p><p><img src="/Microsoft-2019暑期OA题目/3-2.png" alt="3-2"></p></blockquote><h3 id="Honey-Madness"><a href="#Honey-Madness" class="headerlink" title="Honey Madness"></a>Honey Madness</h3><blockquote><p><img src="/Microsoft-2019暑期OA题目/4-1.png" alt="4-1"></p><p><img src="/Microsoft-2019暑期OA题目/4-2.png" alt="4-2"></p><p><img src="/Microsoft-2019暑期OA题目/4-3.png" alt="4-3"></p></blockquote><p>做出了1和3（但也不是全对），2和4完全没有思路。佛了。</p><p>之后如果有机会再补上吧。</p>]]></content>
      
      
      <categories>
          
          <category> interview </category>
          
      </categories>
      
      
        <tags>
            
            <tag> intern </tag>
            
            <tag> oa </tag>
            
            <tag> microsoft </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ML学习日记2——泛化误差：方差与偏差</title>
      <link href="/ML-2-Variance-and-Bias/"/>
      <url>/ML-2-Variance-and-Bias/</url>
      
        <content type="html"><![CDATA[<p>首先引用一段<a href="https://zhuanlan.zhihu.com/p/38853908">知乎</a>上的描述：</p><blockquote><p>在机器学习中，我们用训练数据集去训练一个模型，通常的做法是定义一个误差函数，通过将这个误差的最小化过程，来提高模型的性能。</p><p>然而我们学习一个模型的目的是为了解决训练数据集这个领域中的一般化问题，单纯地将训练数据集的损失最小化，并不能保证在解决更一般的问题时模型仍然是最优，甚至不能保证模型是可用的。这个训练数据集的损失与一般化的数据集的损失之间的差异就叫做<strong>泛化误差（generalization error）</strong>。</p><p>泛化误差为偏差、方差与噪声之和。</p></blockquote><a id="more"></a><h3 id="Variance（方差）"><a href="#Variance（方差）" class="headerlink" title="Variance（方差）"></a>Variance（方差）</h3><ul><li><strong>Variance</strong>是<strong>不同的训练数据集训练出的模型</strong>输出值之间的差异。</li><li>越复杂的模型，它的variance就越大，表现出来就是过拟合。</li><li>越简单的模型，variance越小</li><li><strong>方差度量了同样大小的训练集的变动所导致的学习性能的变化，即刻画了数据扰动所造成的影响。</strong></li><li>解决方案：<ol><li>collect more data，至少不会让variance更大；但是一般比较难获得（可以从现有数据修改等获得）。</li><li>或者使用regularization，使曲线平滑；代价是增大bias。</li></ol></li></ul><h3 id="Bias（偏差）"><a href="#Bias（偏差）" class="headerlink" title="Bias（偏差）"></a>Bias（偏差）</h3><ul><li><strong>Bias</strong>是用<strong>所有可能的训练数据集</strong>训练出的<strong>所有模型</strong>的输出的<strong>平均值</strong>与<strong>真实模型</strong>的输出值之间的差异。</li><li>比较简单的模型，bias越大，表现出来是underfitting</li><li>较大的bias说明甚至没有很好拟合training data</li></ul><h3 id="Noise（噪声）"><a href="#Noise（噪声）" class="headerlink" title="Noise（噪声）"></a>Noise（噪声）</h3><ul><li><strong>噪声</strong>的存在是学习算法所无法解决的问题，数据的质量决定了学习的上限。假设在数据已经给定的情况下，此时上限已定，我们要做的就是尽可能的接近这个上限。</li></ul><hr><h3 id="Cross-Validation"><a href="#Cross-Validation" class="headerlink" title="Cross Validation"></a>Cross Validation</h3><p>待补充。</p>]]></content>
      
      
      <categories>
          
          <category> machine learning </category>
          
      </categories>
      
      
        <tags>
            
            <tag> regression </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ML学习日记1——线性回归与梯度下降</title>
      <link href="/ML-1-LinearRegression/"/>
      <url>/ML-1-LinearRegression/</url>
      
        <content type="html"><![CDATA[<p>今天开始学习台大李宏毅教授的机器学习视频。</p><p>这篇文章是自己写的一个简单的多元线性回归模型：$y = \sum{w_i*x_i}+b$，基于批量梯度下降方法。</p><a id="more"></a><h3 id="准备阶段：生成训练数据和测试数据，选取多元一次的线性关系"><a href="#准备阶段：生成训练数据和测试数据，选取多元一次的线性关系" class="headerlink" title="准备阶段：生成训练数据和测试数据，选取多元一次的线性关系"></a>准备阶段：生成训练数据和测试数据，选取多元一次的线性关系</h3><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># 生成train data和test data</span><span class="token comment" spellcheck="true"># 随机选择一些x和w，b</span><span class="token keyword">from</span> random <span class="token keyword">import</span> randint<span class="token punctuation">,</span> uniform<span class="token keyword">from</span> numpy <span class="token keyword">import</span> random<span class="token keyword">def</span> <span class="token function">genCase</span><span class="token punctuation">(</span>n<span class="token punctuation">:</span> int<span class="token punctuation">,</span> m<span class="token punctuation">:</span> int<span class="token punctuation">)</span><span class="token punctuation">:</span>    x <span class="token operator">=</span> random<span class="token punctuation">.</span>uniform<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>m<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span>    w <span class="token operator">=</span> random<span class="token punctuation">.</span>uniform<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    b <span class="token operator">=</span> uniform<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 加入噪音</span>    y <span class="token operator">=</span> <span class="token punctuation">[</span>sum<span class="token punctuation">(</span>x<span class="token punctuation">[</span>i1<span class="token punctuation">]</span><span class="token punctuation">.</span>dot<span class="token punctuation">(</span>w<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> b <span class="token operator">+</span> uniform<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i1 <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Generated %d cases with %d features."</span> <span class="token operator">%</span> <span class="token punctuation">(</span>m<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> w<span class="token punctuation">,</span> b<span class="token keyword">def</span> <span class="token function">splitCase</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>    n <span class="token operator">=</span> len<span class="token punctuation">(</span>x<span class="token punctuation">)</span>    <span class="token keyword">if</span> len<span class="token punctuation">(</span>y<span class="token punctuation">)</span> <span class="token operator">!=</span> n<span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    trainX<span class="token punctuation">,</span> trainY<span class="token punctuation">,</span> testX<span class="token punctuation">,</span> testY <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> randint<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">2</span><span class="token punctuation">:</span>            testX<span class="token punctuation">.</span>append<span class="token punctuation">(</span>x<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>            testY<span class="token punctuation">.</span>append<span class="token punctuation">(</span>y<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            trainX<span class="token punctuation">.</span>append<span class="token punctuation">(</span>x<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>            trainY<span class="token punctuation">.</span>append<span class="token punctuation">(</span>y<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Split data into 2 parts: %d train data and %d test data"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>len<span class="token punctuation">(</span>trainX<span class="token punctuation">)</span><span class="token punctuation">,</span> len<span class="token punctuation">(</span>testX<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> trainX<span class="token punctuation">,</span> trainY<span class="token punctuation">,</span> testX<span class="token punctuation">,</span> testYX<span class="token punctuation">,</span> Y<span class="token punctuation">,</span> OriginW<span class="token punctuation">,</span> OriginB <span class="token operator">=</span> genCase<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>TrainX<span class="token punctuation">,</span> TrainY<span class="token punctuation">,</span> TestX<span class="token punctuation">,</span> TestY <span class="token operator">=</span> splitCase<span class="token punctuation">(</span>X<span class="token punctuation">,</span> Y<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># 导出到文件</span><span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">'./data/train.txt'</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>TrainX<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">'\t'</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>list<span class="token punctuation">(</span>map<span class="token punctuation">(</span>str<span class="token punctuation">,</span> TrainX<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\t'</span> <span class="token operator">+</span> str<span class="token punctuation">(</span>TrainY<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">'./data/test.txt'</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>TestX<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">'\t'</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>list<span class="token punctuation">(</span>map<span class="token punctuation">(</span>str<span class="token punctuation">,</span> TestX<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\t'</span> <span class="token operator">+</span> str<span class="token punctuation">(</span>TestY<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\n'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre><code>Generated 1000 cases with 10 features.Split data into 2 parts: 484 train data and 516 test data</code></pre><h3 id="训练阶段：采用批量梯度下降方法拟合"><a href="#训练阶段：采用批量梯度下降方法拟合" class="headerlink" title="训练阶段：采用批量梯度下降方法拟合"></a>训练阶段：采用批量梯度下降方法拟合</h3><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> numpy <span class="token keyword">import</span> loadtxt<span class="token punctuation">,</span> ones<span class="token keyword">def</span> <span class="token function">h</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> w<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> sum<span class="token punctuation">(</span>x<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>w<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> b<span class="token keyword">def</span> <span class="token function">loss</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> w<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> sum<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">(</span>h<span class="token punctuation">(</span>x<span class="token punctuation">[</span>i1<span class="token punctuation">]</span><span class="token punctuation">,</span> w<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">-</span> y<span class="token punctuation">[</span>i1<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">2</span> <span class="token keyword">for</span> i1 <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">batchGradientDescent</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> rate<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">,</span> iterBound<span class="token operator">=</span><span class="token number">100000</span><span class="token punctuation">,</span> gradBound<span class="token operator">=</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    m <span class="token operator">=</span> len<span class="token punctuation">(</span>x<span class="token punctuation">)</span>    <span class="token keyword">if</span> m <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">or</span> len<span class="token punctuation">(</span>y<span class="token punctuation">)</span> <span class="token operator">!=</span> m<span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span>    n <span class="token operator">=</span> len<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    w<span class="token punctuation">,</span> b <span class="token operator">=</span> ones<span class="token punctuation">(</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Learning ratio: %f"</span> <span class="token operator">%</span> rate<span class="token punctuation">)</span>    <span class="token keyword">for</span> k <span class="token keyword">in</span> range<span class="token punctuation">(</span>iterBound<span class="token punctuation">)</span><span class="token punctuation">:</span>        gradW <span class="token operator">=</span> <span class="token punctuation">[</span>sum<span class="token punctuation">(</span><span class="token punctuation">[</span>x<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token punctuation">(</span>y<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> h<span class="token punctuation">(</span>x<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> w<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">/</span> m <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">]</span>        gradB <span class="token operator">=</span> sum<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">(</span>y<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> h<span class="token punctuation">(</span>x<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> w<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">/</span> m        <span class="token comment" spellcheck="true"># 跳出循环的条件：梯度值较小</span>        <span class="token keyword">if</span> abs<span class="token punctuation">(</span>gradB<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> gradBound<span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Converges after %d rounds of batch gradient descent."</span> <span class="token operator">%</span> k<span class="token punctuation">)</span>            <span class="token keyword">return</span> w<span class="token punctuation">,</span> b        <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>            w<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+=</span> gradW<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> rate        b <span class="token operator">+=</span> gradB <span class="token operator">*</span> rate    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"After %d rounds of gradient descent, the loss is %f"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>k<span class="token punctuation">,</span> loss<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> w<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> w<span class="token punctuation">,</span> b<span class="token keyword">def</span> <span class="token function">readData</span><span class="token punctuation">(</span>file<span class="token punctuation">:</span> str<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">with</span> open<span class="token punctuation">(</span>file<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>        data <span class="token operator">=</span> loadtxt<span class="token punctuation">(</span>f<span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token punctuation">[</span>data<span class="token punctuation">[</span>i1<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token keyword">for</span> i1 <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>data<span class="token punctuation">[</span>i1<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token keyword">for</span> i1 <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>trainX<span class="token punctuation">,</span> trainY <span class="token operator">=</span> readData<span class="token punctuation">(</span><span class="token string">"./data/train.txt"</span><span class="token punctuation">)</span>testX<span class="token punctuation">,</span> testY <span class="token operator">=</span> readData<span class="token punctuation">(</span><span class="token string">"./data/test.txt"</span><span class="token punctuation">)</span><span class="token operator">%</span>time W<span class="token punctuation">,</span> B <span class="token operator">=</span> batchGradientDescent<span class="token punctuation">(</span>trainX<span class="token punctuation">,</span> trainY<span class="token punctuation">,</span> <span class="token number">0.02</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre><code>Learning ratio: 0.020000Converges after 608 rounds of batch gradient descent.CPU times: user 5.72 s, sys: 23 ms, total: 5.75 sWall time: 5.76 s</code></pre><h3 id="预测阶段：使用test数据测试模型准确率"><a href="#预测阶段：使用test数据测试模型准确率" class="headerlink" title="预测阶段：使用test数据测试模型准确率"></a>预测阶段：使用test数据测试模型准确率</h3><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Loss for test data: %f"</span> <span class="token operator">%</span> loss<span class="token punctuation">(</span>testX<span class="token punctuation">,</span> testY<span class="token punctuation">,</span> W<span class="token punctuation">,</span> B<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Loss for test data with original w and b: %f"</span> <span class="token operator">%</span> loss<span class="token punctuation">(</span>testX<span class="token punctuation">,</span> testY<span class="token punctuation">,</span> OriginW<span class="token punctuation">,</span> OriginB<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Difference for w and b:"</span><span class="token punctuation">,</span> OriginW <span class="token operator">-</span> W<span class="token punctuation">,</span> OriginB <span class="token operator">-</span> B<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre><code>Loss for test data: 47.161984Loss for test data with original w and b: 46.188546Difference for w and b: [[-0.00095575] [ 0.0001872 ] [ 0.00153668] [ 0.00050082] [-0.00034511] [-0.00396764] [-0.00295501] [ 0.00099687] [ 0.00369943] [ 0.00379453]] -0.003807025307413836</code></pre><ul><li>经过梯度下降之后，达到了较好的精度。</li><li>时间上存在改进空间。</li></ul><h3 id="自适应learning-rate：Adagrad"><a href="#自适应learning-rate：Adagrad" class="headerlink" title="自适应learning rate：Adagrad"></a>自适应learning rate：Adagrad</h3><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> math <span class="token keyword">import</span> sqrt<span class="token keyword">def</span> <span class="token function">improvedBGD</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> iterBound<span class="token operator">=</span><span class="token number">10000</span><span class="token punctuation">,</span> gradBound<span class="token operator">=</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    m <span class="token operator">=</span> len<span class="token punctuation">(</span>x<span class="token punctuation">)</span>    <span class="token keyword">if</span> m <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">or</span> len<span class="token punctuation">(</span>y<span class="token punctuation">)</span> <span class="token operator">!=</span> m<span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span>    n <span class="token operator">=</span> len<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    w<span class="token punctuation">,</span> b <span class="token operator">=</span> ones<span class="token punctuation">(</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span>    rateW<span class="token punctuation">,</span> rateB <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> range<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">0</span>    <span class="token keyword">for</span> k1 <span class="token keyword">in</span> range<span class="token punctuation">(</span>iterBound<span class="token punctuation">)</span><span class="token punctuation">:</span>        gradW <span class="token operator">=</span> <span class="token punctuation">[</span>sum<span class="token punctuation">(</span><span class="token punctuation">[</span>x<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token punctuation">(</span>y<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> h<span class="token punctuation">(</span>x<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> w<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">/</span> m <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">]</span>        gradB <span class="token operator">=</span> sum<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">(</span>y<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> h<span class="token punctuation">(</span>x<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> w<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">/</span> m        <span class="token comment" spellcheck="true"># 跳出循环的条件：梯度值较小</span>        <span class="token keyword">if</span> abs<span class="token punctuation">(</span>gradB<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> gradBound<span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Converges after %d rounds of batch gradient descent."</span> <span class="token operator">%</span> k1<span class="token punctuation">)</span>            <span class="token keyword">return</span> w<span class="token punctuation">,</span> b        <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>            rateW<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+=</span> gradW<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">**</span> <span class="token number">2</span>            w<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+=</span> gradW<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">/</span> sqrt<span class="token punctuation">(</span>rateW<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>        rateB <span class="token operator">+=</span> gradB <span class="token operator">**</span> <span class="token number">2</span>        b <span class="token operator">+=</span> gradB <span class="token operator">/</span> sqrt<span class="token punctuation">(</span>rateB<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"After %d rounds of gradient descent, the loss is %f"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>k1<span class="token punctuation">,</span> loss<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> w<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> w<span class="token punctuation">,</span> b<span class="token operator">%</span>time W<span class="token punctuation">,</span> B <span class="token operator">=</span> improvedBGD<span class="token punctuation">(</span>trainX<span class="token punctuation">,</span> trainY<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Loss for test data: %f"</span> <span class="token operator">%</span> loss<span class="token punctuation">(</span>testX<span class="token punctuation">,</span> testY<span class="token punctuation">,</span> W<span class="token punctuation">,</span> B<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Loss for test data with original w and b: %f"</span> <span class="token operator">%</span> loss<span class="token punctuation">(</span>testX<span class="token punctuation">,</span> testY<span class="token punctuation">,</span> OriginW<span class="token punctuation">,</span> OriginB<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Difference for w and b:"</span><span class="token punctuation">,</span> OriginW <span class="token operator">-</span> W<span class="token punctuation">,</span> OriginB <span class="token operator">-</span> B<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre><code>Converges after 251 rounds of batch gradient descent.CPU times: user 2.55 s, sys: 9.66 ms, total: 2.56 sWall time: 2.57 sLoss for test data: 43.177537Loss for test data with original w and b: 41.600574Difference for w and b: [[ 0.00108563] [-0.00580816] [ 0.00122102] [-0.002008  ] [-0.00198998] [-0.0003545 ] [ 0.00242942] [-0.00419475] [-0.00064363] [ 0.00016461]] -0.009286649191009438</code></pre><h3 id="使用高次拟合，查看loss变化"><a href="#使用高次拟合，查看loss变化" class="headerlink" title="使用高次拟合，查看loss变化"></a>使用高次拟合，查看loss变化</h3><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">generateAll</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> n <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> x    res <span class="token operator">=</span> ones<span class="token punctuation">(</span><span class="token punctuation">(</span>len<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> n <span class="token operator">*</span> len<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    count <span class="token operator">=</span> len<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> i1 <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> j1 <span class="token keyword">in</span> range<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">for</span> k1 <span class="token keyword">in</span> range<span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">:</span>                res<span class="token punctuation">[</span>i1<span class="token punctuation">]</span><span class="token punctuation">[</span>k1 <span class="token operator">+</span> j1 <span class="token operator">*</span> count<span class="token punctuation">]</span> <span class="token operator">=</span> x<span class="token punctuation">[</span>i1<span class="token punctuation">]</span><span class="token punctuation">[</span>k1<span class="token punctuation">]</span> <span class="token operator">**</span> <span class="token punctuation">(</span>j1 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> res<span class="token comment" spellcheck="true"># 拟合过程可以直接使用batchGradientDescent函数解决</span><span class="token comment" spellcheck="true"># 为了节约时间（一方面learning rate不能高，一高就不收敛；另一方面太低可能半小时都跑不出来）</span>trainLoss <span class="token operator">=</span> <span class="token punctuation">[</span>loss<span class="token punctuation">(</span>trainX<span class="token punctuation">,</span> trainY<span class="token punctuation">,</span> W<span class="token punctuation">,</span> B<span class="token punctuation">)</span><span class="token punctuation">]</span>testLoss <span class="token operator">=</span> <span class="token punctuation">[</span>loss<span class="token punctuation">(</span>testX<span class="token punctuation">,</span> testY<span class="token punctuation">,</span> W<span class="token punctuation">,</span> B<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    exTrainX<span class="token punctuation">,</span> exTestX <span class="token operator">=</span> generateAll<span class="token punctuation">(</span>trainX<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">,</span> generateAll<span class="token punctuation">(</span>testX<span class="token punctuation">,</span> i<span class="token punctuation">)</span>    <span class="token operator">%</span>time Wi<span class="token punctuation">,</span> Bi <span class="token operator">=</span> improvedBGD<span class="token punctuation">(</span>exTrainX<span class="token punctuation">,</span> trainY<span class="token punctuation">)</span>    trainLoss<span class="token punctuation">.</span>append<span class="token punctuation">(</span>loss<span class="token punctuation">(</span>exTrainX<span class="token punctuation">,</span> trainY<span class="token punctuation">,</span> Wi<span class="token punctuation">,</span> Bi<span class="token punctuation">)</span><span class="token punctuation">)</span>    testLoss<span class="token punctuation">.</span>append<span class="token punctuation">(</span>loss<span class="token punctuation">(</span>exTestX<span class="token punctuation">,</span> testY<span class="token punctuation">,</span> Wi<span class="token punctuation">,</span> Bi<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre><code>After 9999 rounds of gradient descent, the loss is 36.904122CPU times: user 3min 50s, sys: 1.34 s, total: 3min 51sWall time: 3min 52sAfter 9999 rounds of gradient descent, the loss is 35.874497CPU times: user 5min 39s, sys: 1.56 s, total: 5min 40sWall time: 5min 42sAfter 9999 rounds of gradient descent, the loss is 261.607271CPU times: user 7min 28s, sys: 2.38 s, total: 7min 31sWall time: 7min 33sAfter 9999 rounds of gradient descent, the loss is 181030.524181CPU times: user 9min 20s, sys: 3.25 s, total: 9min 24sWall time: 9min 27s</code></pre><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt<span class="token keyword">from</span> numpy <span class="token keyword">import</span> arangex_axis <span class="token operator">=</span> arange<span class="token punctuation">(</span>len<span class="token punctuation">(</span>trainLoss<span class="token punctuation">)</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token string">'on'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x_axis<span class="token punctuation">,</span> trainLoss<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'train'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x_axis<span class="token punctuation">,</span> testLoss<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'test'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/ML-1-LinearRegression/LinearRegression.png" alt="png"></p><ul><li>出现了明显的overfitting现象</li></ul><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>testLoss<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre><code>[43.17753677246426, 46.221044463400624, 47.5150256435928, 295.13051190429354, 216220.90071215943]</code></pre><h3 id="过拟合"><a href="#过拟合" class="headerlink" title="过拟合"></a>过拟合</h3><h4 id="减少变量"><a href="#减少变量" class="headerlink" title="减少变量"></a>减少变量</h4><p>可以人工检查每一项变量，保留重要的变量。</p><h4 id="正则化"><a href="#正则化" class="headerlink" title="正则化"></a>正则化</h4><p>过拟合之后，可以采用<code>regularization</code>方法，加入新的一项：$\lambda * \sum{w^2_i}$</p><p>这一项表示曲线的平滑程度：</p><ul><li>如果这一项越小，那么对输入的小幅度变化越不敏感，所以在小范围内波动比较稳定，不会偏离太多，从而对噪声不敏感，做到更好的拟合。</li><li><p>本质是对高次项作出惩罚，因为所有的w都是一样的系数，但是惩罚项带来变化对高次项影响更大。</p></li><li><p>随着$\lambda​$值变大而变得平滑，拟合度更高；但是高到一定程度的时候，引入的项造成的error越大。我们当然不喜欢太平滑的函数，极端一点就变成水平直线，没有任何意义。</p></li><li><p>这一项不需要加入<code>bias</code>这一项——因为它是常数项，只会把曲线抬高，不会影响曲线的形状。</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> machine learning </category>
          
      </categories>
      
      
        <tags>
            
            <tag> regression </tag>
            
            <tag> gradient descent </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>VOI</title>
      <link href="/VOI/"/>
      <url>/VOI/</url>
      
        <content type="html"><![CDATA[<p>VOI：一个来自iOS应用移植的小游戏，主体在canvas实现</p><p>目前尚在施工中(´･ω･`)</p><p>点击👉<a href="/voi/index.html">这里</a><br>代码在<a href="https://github.com/Riroaki/VOI">这里</a></p>]]></content>
      
      
      <categories>
          
          <category> wheels </category>
          
          <category> front end </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Google实习面试经历</title>
      <link href="/Google%E5%AE%9E%E4%B9%A0%E9%9D%A2%E8%AF%95%E7%BB%8F%E5%8E%86/"/>
      <url>/Google%E5%AE%9E%E4%B9%A0%E9%9D%A2%E8%AF%95%E7%BB%8F%E5%8E%86/</url>
      
        <content type="html"><![CDATA[<ul><li>3月29更新：</li></ul><blockquote><p><strong>Your Current Stage:</strong>  Pending. Unfortunately, your current interview result is not strong enough to proceed to next step, we will try to strive opportunity for you. If there is any update about proceed or reject, I’ll definitely let you know.</p></blockquote><p>今天发邮件催了一下hr，对面表示面试成绩不够好被挂着，然而也没有直接刷……学长说其实基本就是算凉了，我也不抱希望。</p><p>总体来说二面发挥较好，一面比较失败。等有空再补一下这两次面试的经历。<br><a id="more"></a></p><h2 id="一面"><a href="#一面" class="headerlink" title="一面"></a>一面</h2><p>上来先自我介绍，然而我并没有好好准备这部分，并没有说明自己的项目经历等等……现在看来真的太蠢了。</p><p>然后，开始码代码。结果一上来就遇到之前在lc讨论区看到的题，具体链接在<a href="https://leetcode.com/discuss/interview-question/236898/google-phone-interview/237669">这里</a>：</p><blockquote><p>Given a complete(virtual) binary tree, return true/false if the given target node exists in the tree or not.<br>Here, the “virtual” means the tree nodes are numbered assuming the tree is a complete binary tree.</p><p>For example:</p><pre class="line-numbers language-java"><code class="language-java">                <span class="token number">1</span>            <span class="token operator">/</span>        \          <span class="token number">2</span>              <span class="token number">3</span>       <span class="token operator">/</span>   \           <span class="token operator">/</span>  \      <span class="token function">4</span>   <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>nil      <span class="token function">6</span>  <span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span>nil   <span class="token comment" spellcheck="true">//function signature</span>   <span class="token comment" spellcheck="true">// bool doesNodeExist(root *TreeNode, target int)</span>   <span class="token function">doesNodeExist</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token boolean">true</span>   <span class="token function">doesNodeExist</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token boolean">false</span><span class="token punctuation">,</span> Given the node on #<span class="token number">7</span> is a nil node<span class="token punctuation">.</span>   <span class="token comment" spellcheck="true">//Think of a better solution.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></blockquote><p>这题，我之前就想到一个简单的做法，采用的是将数字二进制表示后，利用0和1定位，每次排除一半的搜索空间，总的时间效率是$O(log(n))$：</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">doesNodeExist</span><span class="token punctuation">(</span>TreeNode root<span class="token punctuation">,</span> <span class="token keyword">int</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>id <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> binary <span class="token operator">=</span> Integer<span class="token punctuation">.</span><span class="token function">toBinaryString</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toCharArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> binary<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>root <span class="token operator">==</span> null<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>binary<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'0'</span><span class="token punctuation">)</span> root <span class="token operator">=</span> root<span class="token punctuation">.</span>left<span class="token punctuation">;</span>        <span class="token keyword">else</span> root <span class="token operator">=</span> root<span class="token punctuation">.</span>right<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> root <span class="token operator">!=</span> null<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>写的差不多了，然而还是有点bug（我在之前没有练好白板orz，估计就是跪在这里）</p><p>然后修修补补，花了不少时间。之后他提出follow up（其实应该是另一个问题）：</p><blockquote><p>Given a complete(virtual) binary tree, return the number of nodes in the tree.</p></blockquote><p>这个首先当然是给出trivial做法，时间复杂度$O(n)$：</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">countNodes</span><span class="token punctuation">(</span>TreeNode root<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">return</span> root <span class="token operator">==</span> null <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token number">1</span> <span class="token operator">+</span> <span class="token function">countNodes</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>left<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">countNodes</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>right<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>我想了一会，想到结合第一题的思路：使用二分的方法，用第一题的函数确认某个结点是否存在于这个树上，然后不断二分搜索空间，时间复杂度为$O(log^2(n))$</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">countNodes</span><span class="token punctuation">(</span>TreeNode root<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>root <span class="token operator">==</span> null<span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> lo <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> hi <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    TreeNode tmp <span class="token operator">=</span> root<span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>tmp<span class="token punctuation">.</span>right <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>        tmp <span class="token operator">=</span> tmp<span class="token punctuation">.</span>right<span class="token punctuation">;</span>        hi <span class="token operator">=</span> <span class="token punctuation">(</span>hi <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    hi <span class="token operator">=</span> <span class="token punctuation">(</span>hi <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>lo <span class="token operator">&lt;</span> hi<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> mi <span class="token operator">=</span> lo <span class="token operator">+</span> <span class="token punctuation">(</span>hi <span class="token operator">-</span> lo<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">exist</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span> mi<span class="token punctuation">)</span><span class="token punctuation">)</span>            lo <span class="token operator">=</span> mi <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">else</span>            hi <span class="token operator">=</span> mi<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token function">exist</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span> lo<span class="token punctuation">)</span> <span class="token operator">?</span> lo <span class="token operator">:</span> lo <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>我觉得这个思路真的是，完美啊！！！但是写的过程还是出了一点bug……最后还是运算符陷阱，java的位运算优先级问题太坑。</p><p>然后写完，时间也差不多了，就这样不明不白地结束了。</p><h2 id="二面"><a href="#二面" class="headerlink" title="二面"></a>二面</h2><p>二面前又刷了一会题，还在一亩三分地看了一些面经，结果看的题<strong>完全没用</strong>，呵呵</p><p>二面面试官给人不善言辞的木讷感觉，我也和第一次不一样，自我介绍的时候说了一下自己的项目。</p><p>对面：有这么多项目经历啊……</p><p>我：嗯嗯（其实心里一脸懵逼）</p><p>然后，话不多说开始做题。</p><blockquote><p>Split an array such that the sum of each split &gt;= target.</p><p>The array consists of only integers in [0, 9].</p><p>Write a function to check whether the array could be split into k parts.</p><p>boolean canSplit(int[] nums, int k, int target)</p></blockquote><p>这题开始的时候他没讲清楚，让我以为是随意的切分，想了半天没话可说，正要和他求个提示，结果他看不下去让我先尝试一下比如<code>nums = [1,2,3,3,2,4,4], k = 3, x = 5</code></p><p>然后贪心地切下去，切成：<code>[1, 2, 3/ 3, 2/ 4, 4]</code>，能够切分三份，所以返回<code>true</code></p><p>好嘛，你直接说连续的切分不就好了。我就说我之前也问了这个问题，然后他没讲清楚。</p><p>这就开始写代码，时间复杂度$O(n)$：</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">boolean</span> <span class="token function">canSplit</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> k<span class="token punctuation">,</span> <span class="token keyword">int</span> x<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">int</span> n <span class="token operator">=</span> a<span class="token punctuation">.</span>length<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;</span> k <span class="token operator">||</span> x <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> k <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> currSum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> curr <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> index <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> index<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>currSum <span class="token operator">>=</span> x<span class="token punctuation">)</span> <span class="token punctuation">{</span>            curr <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>            currSum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        currSum <span class="token operator">+=</span> a<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>currSum <span class="token operator">>=</span> x<span class="token punctuation">)</span>        curr<span class="token operator">++</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> curr <span class="token operator">>=</span> k<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这一次我边写边讲了这一步做什么，那一步做什么，遇到全0的case等等怎么处理。</p><p>对方说ok，没有问题，就是把那个<code>currSum += a[index]</code>放在前面会比较好，避免循环外面再判断一次，代码更简洁。我说嗯嗯，确实如此。</p><p>接着是follow up：</p><blockquote><p>Now given the array and k, return what’s the maximum target.</p></blockquote><p>这里理解题目就比较麻烦，因为这个maximum其实是某一个切分中，每一份的和的最小值；但是又是不同切分中的最大值。</p><p>我想起以前周赛的一个题，给定天数要求和物品列表，每天载货一次，问最小的单次载货量是多少（题目在<a href="https://leetcode.com/problems/capacity-to-ship-packages-within-d-days/">这里</a>）——其实这两题比较像，稍加分析就可以看出：</p><ul><li>在这里是从<code>0</code>开始找到<code>sum</code>，前面都是可以的，到某一个值开始不能拆分成k份；</li><li>在上面那个载货题，从<code>0</code>开始找到<code>sum</code>，前面的<code>capacity</code>不能在<code>k</code>天载完，在某一个值开始可以载完。</li></ul><p>联想到这一题用的是二分，我就打算在这里也用二分，使用上一个题目的<code>canSplit</code>进行判断。</p><p>我一提出二分，对方就大为赞赏，这让我有些振奋，于是确定地提出想法，然后开始码，时间复杂度$O(nlogn)$：</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">int</span> <span class="token function">maxSplit</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> k<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">int</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> n <span class="token operator">=</span> a<span class="token punctuation">.</span>length<span class="token punctuation">;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;</span> k <span class="token operator">||</span> k <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// indicating invalid error</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> num <span class="token operator">:</span> a<span class="token punctuation">)</span>        sum <span class="token operator">+=</span> num<span class="token punctuation">;</span>    <span class="token keyword">int</span> lo <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> hi <span class="token operator">=</span> sum<span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>lo <span class="token operator">&lt;</span> hi<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> mi <span class="token operator">=</span> lo <span class="token operator">+</span> <span class="token punctuation">(</span>hi <span class="token operator">-</span> lo<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">canSplit</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> k<span class="token punctuation">,</span> mi<span class="token punctuation">)</span><span class="token punctuation">)</span>            lo <span class="token operator">=</span> mi <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">else</span>            hi <span class="token operator">=</span> mi<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token function">canSplit</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> k<span class="token punctuation">,</span> lo<span class="token punctuation">)</span> <span class="token operator">?</span> lo <span class="token operator">:</span> lo <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>写完一看，和一面的思路也太像了吧！不过我没有说，检查了很多<code>case</code>之后对方说很好，代码没有问题，而且风格也不错。</p><p>接下来提出进一步的follow up：</p><blockquote><p>What if the array contains minus numbers?</p></blockquote><p>这里我一开始没明白，负数会有影响吗？</p><p>后来才发现，对这种例子，就会对<code>canSplit</code>函数产生影响：<code>nums = [1, 2, 3, -1, 4, 1], target = 5</code></p><p>在这里，如果我们在<code>3</code>后面分割，那么后面就不能组成一个split，只能分成1份；但是如果我们在<code>-1</code>后面切分，那么就可以分成2份。然而我并没有想出来……</p><p>看到我的窘况，他说没关系，提示我用dp，并且贴心地换了一个follow up：</p><blockquote><p>What if the maxSplit function is called many times on the same array?</p></blockquote><p>也就是如何优化的问题。我这个时候脑子是糊的，但是盲猜了一个方法（套路啊）：前缀和数组。</p><p>这个概念一提出来，对方就很满意，接下来补全了思路：在前缀和数组上作二分找到下一个可切分的位置，将<code>canSplit</code>原来遍历数组的过程转化为二分，提高效率。</p><p>这样做之后，总时间效率就是$O(log^2(n))$，和一面的解法结构也很像——只能说我运气实在太好了吧。</p><p>然而这样还是没有利用好机会……orz</p><p>经过这样两次面试，我只能说，二分天下无敌！</p>]]></content>
      
      
      <categories>
          
          <category> interview </category>
          
      </categories>
      
      
        <tags>
            
            <tag> intern </tag>
            
            <tag> google </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>重置系统和ssh连接</title>
      <link href="/%E9%87%8D%E7%BD%AE%E7%B3%BB%E7%BB%9F%E5%92%8Cssh%E8%BF%9E%E6%8E%A5/"/>
      <url>/%E9%87%8D%E7%BD%AE%E7%B3%BB%E7%BB%9F%E5%92%8Cssh%E8%BF%9E%E6%8E%A5/</url>
      
        <content type="html"><![CDATA[<p>之前不小心更新了Ubuntu18.0，结果没法ssh连接了。。。</p><p>无奈之下重置了系统，知乎查了一下Ubuntu和其他Linux系统，感觉相对于服务器来说Debian更加稳定些，Ubuntu太倒腾了。重置完了之后，再ssh连接，咦？为啥还是不能连。。。</p><a id="more"></a><pre class="line-numbers language-shell"><code class="language-shell">@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@    WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED!     @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@IT IS POSSIBLE THAT SOMEONE IS DOING SOMETHING NASTY!Someone could be eavesdropping on you right now (man-in-the-middle attack)!It is also possible that a host key has just been changed.The fingerprint for the ECDSA key sent by the remote host isSHA256:2R1nMbHLVDbkj8Q564B1ZwsBkDMm92bJtL4hhb5FSr4.Please contact your system administrator.Add correct host key in /Users/Aki/.ssh/known_hosts to get rid of this message.Offending ECDSA key in /Users/Aki/.ssh/known_hosts:2ECDSA host key for 120.79.161.245 has changed and you have requested strict checking.Host key verification failed.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这应该是我自己电脑对对面系统做了检测，发现ecdsa的验证码不一样了（因为重置了系统啊，感觉不安全就不让我连接了（这个@@@……是我乔鲁诺哒！</p><p>于是谷歌了一下，发现可以通过这个指令移除：<code>ssh-keygen -R [ip]</code></p><p>系统回复：</p><pre class="line-numbers language-shell"><code class="language-shell"># Host 120.79.161.245 found: line 2/Users/Aki/.ssh/known_hosts updated.Original contents retained as /Users/Aki/.ssh/known_hosts.old<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>ok了。现在可以重新连接。</p><p>重新连接后会询问你是否信任，yes之后就会重新将域名加入列表。</p>]]></content>
      
      
      <categories>
          
          <category> back end </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ssh </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>收报名表过程出现的bug以及解决方案</title>
      <link href="/%E6%94%B6%E6%8A%A5%E5%90%8D%E8%A1%A8%E8%BF%87%E7%A8%8B%E5%87%BA%E7%8E%B0%E7%9A%84bug%E4%BB%A5%E5%8F%8A%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/"/>
      <url>/%E6%94%B6%E6%8A%A5%E5%90%8D%E8%A1%A8%E8%BF%87%E7%A8%8B%E5%87%BA%E7%8E%B0%E7%9A%84bug%E4%BB%A5%E5%8F%8A%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/</url>
      
        <content type="html"><![CDATA[<ul><li>校友文件名太长的问题</li><li>文件太大的问题（60m出错，姓名未填写错误）</li><li>校友文件名过长（因命名规则：账号+下划线+账号的md5值）</li><li>文件传不了，未知原因</li><li>文件无法覆盖，未知原因</li></ul><a id="more"></a><h3 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h3><ul><li>无法覆盖<ul><li>数据库里已经有相应文件名，只需要在文件目录<code>/var/www/File/applyfile</code>中替换文件即可。</li></ul></li><li>无法上传<ul><li>数据库中修改对应学号的<code>profile</code>属性为文件名。</li><li>在文件目录中加入文件。 </li></ul></li><li>备注：文件名默认为<code>账户名+下划线+账户名的哈希值</code>，其中账户名可能是学号（本科生）、邮箱（研究生、校友）</li></ul><h3 id="mysql远程连接"><a href="#mysql远程连接" class="headerlink" title="mysql远程连接"></a>mysql远程连接</h3><p>直接在终端建立ssh和mysql连接不安全，而且服务器不支持中文输入，有时候操作不便。</p><h4 id="更新配置"><a href="#更新配置" class="headerlink" title="更新配置"></a>更新配置</h4><pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">grant</span> <span class="token keyword">all</span> <span class="token keyword">privileges</span> <span class="token keyword">on</span> <span class="token operator">*</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">to</span> <span class="token string">'root'</span>@'<span class="token operator">%</span><span class="token string">' identified by '</span>password'<span class="token punctuation">;</span>flush <span class="token keyword">privileges</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><ul><li><code>*. *</code>：表示所有数据库（第一个 <em>）和表（第二个 </em>）。</li><li><code>root</code>：表示允许访问时登陆用的用户名。</li><li><code>%</code>：表示允许来自任何地址的访问。如果要指定一个ip，那么把%换成相应ip。</li><li><code>password</code>：表示设定密码。</li><li><code>flush privileges</code>：表示立即刷新使权限生效。</li></ul><p>这一步之后可以在表中查看结果：</p><pre class="line-numbers language-sql"><code class="language-sql"><span class="token operator">></span> <span class="token keyword">use</span> mysql<span class="token operator">></span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">user</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">-- 可以看到密码是经过md5加密之后的值。</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="修改cnf文件"><a href="#修改cnf文件" class="headerlink" title="修改cnf文件"></a>修改cnf文件</h4><ul><li>mysql的配置文件在目录<code>/etc/mysql/</code>下，需要编辑其开放的端口。</li><li>将<code>bind-address = 127.0.0.1</code>注释掉，因为它的意思是默认本地端口访问。</li></ul><h4 id="重启mysql服务"><a href="#重启mysql服务" class="headerlink" title="重启mysql服务"></a>重启mysql服务</h4><p><code>service mysql restart</code></p><h4 id="连接"><a href="#连接" class="headerlink" title="连接"></a>连接</h4><ul><li>打开mysqlworkbench，建立新的连接，输入用户名和密码、服务器ip。端口号默认3306即可。</li><li>进行连接之后就可以远程操作了。</li></ul>]]></content>
      
      
      <categories>
          
          <category> back end </category>
          
      </categories>
      
      
        <tags>
            
            <tag> shell </tag>
            
            <tag> mysql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>27.Remove Element</title>
      <link href="/27-Remove-Element/"/>
      <url>/27-Remove-Element/</url>
      
        <content type="html"><![CDATA[<h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p>Given an array <em>nums</em> and a value <em>val</em>, remove all instances of that value <a href="https://en.wikipedia.org/wiki/In-place_algorithm"><strong>in-place</strong></a> and return the new length.</p><p>Do not allocate extra space for another array, you must do this by <strong>modifying the input array in-place</strong> with O(1) extra memory.</p><p>The order of elements can be changed. It doesn’t matter what you leave beyond the new length.</p><a id="more"></a><p><strong>Example 1:</strong></p><pre class="line-numbers language-java"><code class="language-java">Given nums <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> val <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span>Your function should <span class="token keyword">return</span> length <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> with the first two elements of nums being <span class="token number">2</span><span class="token punctuation">.</span>It doesn't matter what you leave beyond the returned length<span class="token punctuation">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>Example 2:</strong></p><pre class="line-numbers language-java"><code class="language-java">Given nums <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> val <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>Your function should <span class="token keyword">return</span> length <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">,</span> with the first five elements of nums containing <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> and <span class="token number">4</span><span class="token punctuation">.</span>Note that the order of those five elements can be arbitrary<span class="token punctuation">.</span>It doesn't matter what values are set beyond the returned length<span class="token punctuation">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><h4 id="双指针，快慢操作"><a href="#双指针，快慢操作" class="headerlink" title="双指针，快慢操作"></a>双指针，快慢操作</h4><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">removeElement</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">,</span> <span class="token keyword">int</span> val<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">int</span> slow <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> fast <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> fast <span class="token operator">&lt;</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span> fast<span class="token operator">++</span><span class="token punctuation">)</span>          <span class="token keyword">if</span> <span class="token punctuation">(</span>nums<span class="token punctuation">[</span>fast<span class="token punctuation">]</span> <span class="token operator">!=</span> val<span class="token punctuation">)</span> nums<span class="token punctuation">[</span>slow<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> nums<span class="token punctuation">[</span>fast<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> slow<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(n)$</li><li>空间复杂度：$O(1)$</li></ul><h4 id="双指针——改进"><a href="#双指针——改进" class="headerlink" title="双指针——改进"></a>双指针——改进</h4><ul><li>在val元素较少的时候，为了避免过多的移动，采用交换机制；</li><li>这里的交换十分巧妙：将末尾的数替换当前的i，同时下一轮又会检查i位置的数；而n也会随交换缩小。</li></ul><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">removeElement</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">,</span> <span class="token keyword">int</span> val<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> n <span class="token operator">=</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> val<span class="token punctuation">)</span> <span class="token punctuation">{</span>            nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> nums<span class="token punctuation">[</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>              n<span class="token operator">--</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">// reduce array size by one</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span>            i<span class="token operator">++</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> n<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(n)$</li><li>空间复杂度：$O(1)$</li></ul>]]></content>
      
      
      <categories>
          
          <category> leetcode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> array </tag>
            
            <tag> two pointers </tag>
            
            <tag> easy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>26.Remove Duplicates from Sorted Array</title>
      <link href="/26-Remove-Duplicates-from-Sorted-Array/"/>
      <url>/26-Remove-Duplicates-from-Sorted-Array/</url>
      
        <content type="html"><![CDATA[<h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p>Given a sorted array <em>nums</em>, remove the duplicates <a href="https://en.wikipedia.org/wiki/In-place_algorithm"><strong>in-place</strong></a> such that each element appear only <em>once</em> and return the new length.</p><p>Do not allocate extra space for another array, you must do this by <strong>modifying the input array in-place</strong> with O(1) extra memory.</p><a id="more"></a><p><strong>Example 1:</strong></p><pre class="line-numbers language-java"><code class="language-java">Given nums <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>Your function should <span class="token keyword">return</span> length <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> with the first two elements of nums being <span class="token number">1</span> and <span class="token number">2</span> respectively<span class="token punctuation">.</span>It doesn't matter what you leave beyond the returned length<span class="token punctuation">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>Example 2:</strong></p><pre class="line-numbers language-java"><code class="language-java">Given nums <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>Your function should <span class="token keyword">return</span> length <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">,</span> with the first five elements of nums being modified to <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> and <span class="token number">4</span> respectively<span class="token punctuation">.</span>It doesn't matter what values are set beyond the returned length<span class="token punctuation">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><h4 id="双指针，快慢操作。"><a href="#双指针，快慢操作。" class="headerlink" title="双指针，快慢操作。"></a>双指针，快慢操作。</h4><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">removeDuplicates</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>nums<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> slow <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> fast <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> fast <span class="token operator">&lt;</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span> fast<span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>nums<span class="token punctuation">[</span>fast<span class="token punctuation">]</span> <span class="token operator">!=</span> nums<span class="token punctuation">[</span>slow<span class="token punctuation">]</span><span class="token punctuation">)</span> nums<span class="token punctuation">[</span><span class="token operator">++</span>slow<span class="token punctuation">]</span> <span class="token operator">=</span> nums<span class="token punctuation">[</span>fast<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> slow <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(n)$</li><li>空间复杂度：$O(1)$</li></ul>]]></content>
      
      
      <categories>
          
          <category> leetcode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> array </tag>
            
            <tag> two pointers </tag>
            
            <tag> easy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux服务器部署：Flask + gunicorn + nginx</title>
      <link href="/Linux%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%EF%BC%9AFlask-gunicorn-nginx/"/>
      <url>/Linux%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2%EF%BC%9AFlask-gunicorn-nginx/</url>
      
        <content type="html"><![CDATA[<h3 id="服务器参数"><a href="#服务器参数" class="headerlink" title="服务器参数"></a>服务器参数</h3><ul><li>服务器ip：120.79.161.245（阿里云轻量级服务器，学生机）</li><li>阿里管理控制台：<a href="https://swas.console.aliyun.com/">https://swas.console.aliyun.com/</a></li><li>os：Ubuntu 16.04.3 LTS (GNU/Linux 4.4.0-93-generic x86_64)</li></ul><a id="more"></a><h3 id="连接脚本："><a href="#连接脚本：" class="headerlink" title="连接脚本："></a>连接脚本：</h3><pre class="line-numbers language-shell"><code class="language-shell">#!/usr/bin/expectspawn ssh root@120.79.161.245expect "*password*" send "*****"expect "Welcome*"send "cd /data/www/\r"interact<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="配置环境"><a href="#配置环境" class="headerlink" title="配置环境"></a>配置环境</h3><pre class="line-numbers language-shell"><code class="language-shell">sudo apt-get install nginxsudo apt-get install python3.6python3 -V  # --version# 导出自己电脑上安装的库pip3 freeze > requirements.txt# 把requirements.txt拷贝到服务器上...# 按照库列表依次安装库pip3 install -r requirements.txt<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="本地运行"><a href="#本地运行" class="headerlink" title="本地运行"></a>本地运行</h3><ul><li>这个应该不用多说了吧。指定FLASK的app入口，之后run就可以了。</li></ul><pre class="line-numbers language-shell"><code class="language-shell">FLASK_APP=war.pyflask run# 在war项目下目录结构是这样的：.|____app| |______init__.py| |______pycache__| | |____*.pyc| |____templates| | |____*.html| |____routes.py|______pycache__| |____*.pyc|____war.py<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="部署"><a href="#部署" class="headerlink" title="部署"></a>部署</h3><ul><li><code>nginx</code>配置文件：</li></ul><pre class="line-numbers language-shell"><code class="language-shell">vi /etc/nginx/nginx./conf# 在http的大括号内加入如下内容：server {    listen 80;  # 监听80号端口（默认访问端口）    server_name _;  # 自身ip，下划线代替；和端口号组成外网监听地址    location / {        proxy_pass http://127.0.0.1:8080;  # 转接到本机地址和端口，挑一个没有被占用的端口        proxy_redirect off;        proxy_set_header Host $host;        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;        }    }<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><code>gunicorn</code>操作指令：</li></ul><pre class="line-numbers language-shell"><code class="language-shell">nohup gunicorn -w 1 -b 127.0.0.1:8080 main:app -D# nohup表示不输出任何信息，并将log存到当前目录下nohup.out文件；# -w指定开启的进程数量，一般推荐：【核数】 * 2 + 1，全写是--workers=1；# -b指定转到本机的接口，必须和nginx配置文件的内容一致；# 127.0.0.1即localhost，本地端口；# main:app指定gunicorn要代理的app入口，表示main.py里面的app；# -D表示daemon，守护进程，也就是后台运行<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>常用指令：</li></ul><pre class="line-numbers language-shell"><code class="language-shell"># 进程相关kill -s 9 [pid]ps aux    # 查看所有进程grep [string]  # 查看所有包含[string]的文件ps aux | grep nginx  # 管道，将显示nginx相关进程信息# 文件相关tree  # linux自带指令      # BTW，macOS如果想优雅地使用tree，需要如下操作：      # vi ～/.bash_profile  ## 在个人目录下创建/更改配置文件      # i  ## 插入模式      # alias tree="find . -print | sed -e 's;[^/]*/;|____;g;s;____|; |;g'"  ## 设置同义词组      # wq  ## 退出编辑      # source .bash_profile  ## 重新加载配置文件cat [filename]vi [filename]# nginx相关/etc/init.d/nginx start/etc/init.d/nginx stop/etc/init.d/nginx restart# 或者也可以 service nginx start.stop.restart# 再或者可以 nginx -s start.stop.restartvi /etc/nginx/nginx.conf  # 也可以选择 /etc/nginx/conf.d/default.conf<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><p>关于配置文件</p><ul><li>在配置nginx的时候，网上的资料告诉我配置文件位于<code>/etc/nginx/sites-available/default</code>，我改了半天却并无卯月……然后在zh的帮助下查看了配置文件的路径，我的路径不在参考范围内。</li><li>这个指令既可以测试配置文件的有效性，也可以看到当前运行的配置文件的位置：</li></ul><pre class="line-numbers language-shell"><code class="language-shell">/etc/init.d/nginx -tnginx: configuration file /etc/nginx/nginx.conf test is successful# 于是我们看到/etc/nginx/nginx.conf就是配置文件（这应该是默认的配置文件）<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><ul><li>接着，在这个nginx.conf里面还有一段文字表明nginx会参考的配置文件路径，如果不修改上面第一个文件，修改下面几个路径下的文件也是可以的：</li></ul><pre class="line-numbers language-shell"><code class="language-shell">    ##    # Virtual Host Configs    ##    include /etc/nginx/conf.d/*.conf;    include /etc/nginx/sites-enabled/*;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>记一次bug</p><ul><li>10月6日晚，这个ip发生了一次神秘的bug：刷新index页面的时候，游戏轮数时而显示第一轮，时而显示第二轮，但是总是和文件game.txt里面不一致。</li><li>调整了一晚上都没有找到问题的核心，终于在一次调试中偶然发现-w改成1之后就不会出错（后来知道不是这个原因），因此提出一个假说：是不是多个gunicorn进程引发的混乱？</li><li>可惜好景不长，第二天重新使用workers=1的参数测试的时候，发现问题依然存在。最终查看系统所有进程突然发现，关于gunicorn的进程数（每个的workers都是1）出现好几个，分别是不同的时间段开启的……等等，我好像明白了什么。</li><li>最终真相大白：是因为不同时间开启的gunicorn进程未能有效关闭（每一次我都是重启nginx再重新输入gunicorn指令），从而前几次的gunicorn维护的页面和这一次的页面产生了冲突……导致后来的每一次测试都是在几个不同时段的gunicorn进程中辗转，时而进入这个进程时而进入那一个……</li><li>至于昨晚的结果，则应该是因为那一次尝试恰好伴随着服务器的重启的缘故。</li><li>这一次的<strong>教训</strong>：以后，每次结束测试都要把所有gunicorn的进程关闭。nginx也不例外。</li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> back end </category>
          
      </categories>
      
      
        <tags>
            
            <tag> gunicorn </tag>
            
            <tag> linux </tag>
            
            <tag> shell </tag>
            
            <tag> nginx </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>25.Reverse Nodes in k-Group</title>
      <link href="/25-Reverse-Nodes-in-k-Group/"/>
      <url>/25-Reverse-Nodes-in-k-Group/</url>
      
        <content type="html"><![CDATA[<h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p>Given a linked list, reverse the nodes of a linked list <em>k</em> at a time and return its modified list.</p><p><em>k</em> is a positive integer and is less than or equal to the length of the linked list. If the number of nodes is not a multiple of <em>k</em> then left-out nodes in the end should remain as it is.</p><a id="more"></a><p><strong>Example:</strong></p><p>Given this linked list: <code>1-&gt;2-&gt;3-&gt;4-&gt;5</code></p><p>For <em>k</em> = 2, you should return: <code>2-&gt;1-&gt;4-&gt;3-&gt;5</code></p><p>For <em>k</em> = 3, you should return: <code>3-&gt;2-&gt;1-&gt;4-&gt;5</code></p><p><strong>Note:</strong></p><ul><li>Only constant extra memory is allowed.</li><li>You may not alter the values in the list’s nodes, only nodes itself may be changed.</li></ul><h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><h4 id="用k大小的数组存节点，并依次翻转"><a href="#用k大小的数组存节点，并依次翻转" class="headerlink" title="用k大小的数组存节点，并依次翻转"></a>用k大小的数组存节点，并依次翻转</h4><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> ListNode <span class="token function">reverseKGroup</span><span class="token punctuation">(</span>ListNode head<span class="token punctuation">,</span> <span class="token keyword">int</span> k<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>k <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> head<span class="token punctuation">;</span>    ListNode dummy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ListNode</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    dummy<span class="token punctuation">.</span>next <span class="token operator">=</span> head<span class="token punctuation">;</span>    ListNode<span class="token punctuation">[</span><span class="token punctuation">]</span> group <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ListNode</span><span class="token punctuation">[</span>k <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 保存k集团的前一个，k集团，以及k集团的后一个</span>    group<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> dummy<span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> i<span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> k <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">&amp;&amp;</span> group<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">!=</span> null<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>            group<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> group<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>next<span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>group<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> null<span class="token punctuation">)</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        group<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>next <span class="token operator">=</span> group<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span>        group<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>next <span class="token operator">=</span> group<span class="token punctuation">[</span>k <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> k <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>            group<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>next <span class="token operator">=</span> group<span class="token punctuation">[</span>j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        group<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> group<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> dummy<span class="token punctuation">.</span>next<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(k)​$</li><li>空间复杂度：$O(n)​$</li></ul><h4 id="只使用常数个节点的做法"><a href="#只使用常数个节点的做法" class="headerlink" title="只使用常数个节点的做法"></a>只使用常数个节点的做法</h4><ul><li>问题的关键在于如何反转一个k大小的链表；这里使用的是将每次的第一个插到末尾的做法。</li></ul><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> ListNode <span class="token function">reverseKGroup</span><span class="token punctuation">(</span>ListNode head<span class="token punctuation">,</span> <span class="token keyword">int</span> k<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>head <span class="token operator">==</span> null <span class="token operator">||</span> head<span class="token punctuation">.</span>next <span class="token operator">==</span> null <span class="token operator">||</span> k <span class="token operator">&lt;</span> <span class="token number">2</span><span class="token punctuation">)</span>          <span class="token keyword">return</span> head<span class="token punctuation">;</span>      ListNode dummy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ListNode</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      dummy<span class="token punctuation">.</span>next <span class="token operator">=</span> head<span class="token punctuation">;</span>      ListNode tail <span class="token operator">=</span> dummy<span class="token punctuation">,</span> prev <span class="token operator">=</span> dummy<span class="token punctuation">,</span> temp<span class="token punctuation">;</span>      <span class="token keyword">int</span> count<span class="token punctuation">;</span>      <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        count <span class="token operator">=</span> k<span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>count <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> tail <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>            count<span class="token operator">--</span><span class="token punctuation">;</span>            tail <span class="token operator">=</span> tail<span class="token punctuation">.</span>next<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>tail <span class="token operator">==</span> null<span class="token punctuation">)</span><span class="token comment" spellcheck="true">// 剩下来节点不够k个</span>              <span class="token keyword">break</span><span class="token punctuation">;</span>          <span class="token comment" spellcheck="true">// 此时tail指向k集团的最后一个节点</span>        head <span class="token operator">=</span> prev<span class="token punctuation">.</span>next<span class="token punctuation">;</span><span class="token comment" spellcheck="true">// head指向的是k集团的第一个节点，将会是翻转后最后一个节点，</span>                                          <span class="token comment" spellcheck="true">// 同时也是下一个k集团的前一个节点</span>        <span class="token comment" spellcheck="true">// prev-->temp-->...--->....--->tail-->....</span>        <span class="token comment" spellcheck="true">// Delete @temp and insert to the next position of @tail</span>        <span class="token comment" spellcheck="true">// prev-->...-->...-->tail-->head-->...</span>        <span class="token comment" spellcheck="true">// Assign @temp to the next node of @prev</span>        <span class="token comment" spellcheck="true">// prev-->temp-->...-->tail-->...-->...</span>        <span class="token comment" spellcheck="true">// Keep doing until @tail is the next node of @prev</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>prev<span class="token punctuation">.</span>next <span class="token operator">!=</span> tail<span class="token punctuation">)</span> <span class="token punctuation">{</span>            temp <span class="token operator">=</span> prev<span class="token punctuation">.</span>next<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//Assign</span>            prev<span class="token punctuation">.</span>next <span class="token operator">=</span> temp<span class="token punctuation">.</span>next<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//Delete，从左侧删除temp</span>            temp<span class="token punctuation">.</span>next <span class="token operator">=</span> tail<span class="token punctuation">.</span>next<span class="token punctuation">;</span>            tail<span class="token punctuation">.</span>next <span class="token operator">=</span> temp<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//Insert，在右侧末尾插入temp</span>        <span class="token punctuation">}</span>        tail <span class="token operator">=</span> prev <span class="token operator">=</span> head<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> dummy<span class="token punctuation">.</span>next<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(n)$</li><li>空间复杂度：$O(1)​$</li></ul>]]></content>
      
      
      <categories>
          
          <category> leetcode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hard </tag>
            
            <tag> linked list </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>24.Swap Nodes in Pairs</title>
      <link href="/24-Swap-Nodes-in-Pairs/"/>
      <url>/24-Swap-Nodes-in-Pairs/</url>
      
        <content type="html"><![CDATA[<h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p>Given a linked list, swap every two adjacent nodes and return its head.</p><p>You may <strong>not</strong> modify the values in the list’s nodes, only nodes itself may be changed.</p> <a id="more"></a><p><strong>Example:</strong></p><pre class="line-numbers language-java"><code class="language-java">Given <span class="token number">1</span><span class="token operator">-</span><span class="token operator">></span><span class="token number">2</span><span class="token operator">-</span><span class="token operator">></span><span class="token number">3</span><span class="token operator">-</span><span class="token operator">></span><span class="token number">4</span><span class="token punctuation">,</span> you should <span class="token keyword">return</span> the list as <span class="token number">2</span><span class="token operator">-</span><span class="token operator">></span><span class="token number">1</span><span class="token operator">-</span><span class="token operator">></span><span class="token number">4</span><span class="token operator">-</span><span class="token operator">></span><span class="token number">3</span><span class="token punctuation">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><h4 id="直接做就可以了；小心边界情况"><a href="#直接做就可以了；小心边界情况" class="headerlink" title="直接做就可以了；小心边界情况"></a>直接做就可以了；小心边界情况</h4><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> ListNode <span class="token function">swapPairs</span><span class="token punctuation">(</span>ListNode head<span class="token punctuation">)</span> <span class="token punctuation">{</span>    ListNode dummy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ListNode</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pre <span class="token operator">=</span> dummy<span class="token punctuation">,</span> first <span class="token operator">=</span> head<span class="token punctuation">;</span>    dummy<span class="token punctuation">.</span>next <span class="token operator">=</span> head<span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>first <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>        ListNode tmp <span class="token operator">=</span> first<span class="token punctuation">.</span>next<span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 无视没有配对的点</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>tmp <span class="token operator">==</span> null<span class="token punctuation">)</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        pre<span class="token punctuation">.</span>next <span class="token operator">=</span> tmp<span class="token punctuation">;</span>        first<span class="token punctuation">.</span>next <span class="token operator">=</span> tmp<span class="token punctuation">.</span>next<span class="token punctuation">;</span>        tmp<span class="token punctuation">.</span>next <span class="token operator">=</span> first<span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 下一对节点</span>        pre <span class="token operator">=</span> first<span class="token punctuation">;</span>        first <span class="token operator">=</span> first<span class="token punctuation">.</span>next<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> dummy<span class="token punctuation">.</span>next<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(n)$</li><li>空间复杂度：$O(1)$</li></ul>]]></content>
      
      
      <categories>
          
          <category> leetcode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> medium </tag>
            
            <tag> linked list </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>23.Merge k Sorted Lists</title>
      <link href="/23-Merge-k-Sorted-Lists/"/>
      <url>/23-Merge-k-Sorted-Lists/</url>
      
        <content type="html"><![CDATA[<h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p>Merge <em>k</em> sorted linked lists and return it as one sorted list. Analyze and describe its complexity.</p><a id="more"></a><p><strong>Example:</strong></p><pre class="line-numbers language-java"><code class="language-java">Input<span class="token operator">:</span><span class="token punctuation">[</span>  <span class="token number">1</span><span class="token operator">-</span><span class="token operator">></span><span class="token number">4</span><span class="token operator">-</span><span class="token operator">></span><span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">1</span><span class="token operator">-</span><span class="token operator">></span><span class="token number">3</span><span class="token operator">-</span><span class="token operator">></span><span class="token number">4</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token operator">-</span><span class="token operator">></span><span class="token number">6</span><span class="token punctuation">]</span>Output<span class="token operator">:</span> <span class="token number">1</span><span class="token operator">-</span><span class="token operator">></span><span class="token number">1</span><span class="token operator">-</span><span class="token operator">></span><span class="token number">2</span><span class="token operator">-</span><span class="token operator">></span><span class="token number">3</span><span class="token operator">-</span><span class="token operator">></span><span class="token number">4</span><span class="token operator">-</span><span class="token operator">></span><span class="token number">4</span><span class="token operator">-</span><span class="token operator">></span><span class="token number">5</span><span class="token operator">-</span><span class="token operator">></span><span class="token number">6</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><h4 id="将全部元素加入list，排序后转回链表"><a href="#将全部元素加入list，排序后转回链表" class="headerlink" title="将全部元素加入list，排序后转回链表"></a>将全部元素加入list，排序后转回链表</h4><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> ListNode <span class="token function">mergeKLists</span><span class="token punctuation">(</span>ListNode<span class="token punctuation">[</span><span class="token punctuation">]</span> lists<span class="token punctuation">)</span> <span class="token punctuation">{</span>      List<span class="token operator">&lt;</span>Integer<span class="token operator">></span> tmp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>ListNode curr <span class="token operator">:</span> lists<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>curr <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>                tmp<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>curr<span class="token punctuation">.</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>              curr <span class="token operator">=</span> curr<span class="token punctuation">.</span>next<span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>      Collections<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token punctuation">;</span>      ListNode dummy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ListNode</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> curr <span class="token operator">=</span> dummy<span class="token punctuation">;</span>      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> num <span class="token operator">:</span> tmp<span class="token punctuation">)</span> <span class="token punctuation">{</span>          curr<span class="token punctuation">.</span>next <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ListNode</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>          curr <span class="token operator">=</span> curr<span class="token punctuation">.</span>next<span class="token punctuation">;</span>    <span class="token punctuation">}</span>      <span class="token keyword">return</span> dummy<span class="token punctuation">.</span>next<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(nlog(n))$，其中n是总节点数</li><li>空间复杂度：$O(n)$</li></ul><h4 id="使用最小堆（优先队列）"><a href="#使用最小堆（优先队列）" class="headerlink" title="使用最小堆（优先队列）"></a>使用最小堆（优先队列）</h4><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> ListNode <span class="token function">mergeKLists</span><span class="token punctuation">(</span>ListNode<span class="token punctuation">[</span><span class="token punctuation">]</span> lists<span class="token punctuation">)</span> <span class="token punctuation">{</span>    PriorityQueue<span class="token operator">&lt;</span>ListNode<span class="token operator">></span> nodeHeap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PriorityQueue</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">(</span>o1<span class="token punctuation">,</span> o2<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> o1<span class="token punctuation">.</span>val <span class="token operator">-</span> o2<span class="token punctuation">.</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>    ListNode dummy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ListNode</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> curr <span class="token operator">=</span> dummy<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>ListNode head<span class="token operator">:</span> lists<span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>head <span class="token operator">!=</span> null<span class="token punctuation">)</span>              nodeHeap<span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>nodeHeap<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        curr<span class="token punctuation">.</span>next <span class="token operator">=</span> nodeHeap<span class="token punctuation">.</span><span class="token function">poll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        curr <span class="token operator">=</span> curr<span class="token punctuation">.</span>next<span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>curr<span class="token punctuation">.</span>next <span class="token operator">!=</span> null<span class="token punctuation">)</span>              nodeHeap<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>curr<span class="token punctuation">.</span>next<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> res<span class="token punctuation">.</span>next<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(nlogk)$</li><li>空间复杂度：$O(n+k)​$</li></ul><h4 id="一个接一个合并"><a href="#一个接一个合并" class="headerlink" title="一个接一个合并"></a>一个接一个合并</h4><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> ListNode <span class="token function">mergeKLists</span><span class="token punctuation">(</span>ListNode<span class="token punctuation">[</span><span class="token punctuation">]</span> lists<span class="token punctuation">)</span> <span class="token punctuation">{</span>      ListNode res<span class="token punctuation">;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>lists <span class="token operator">==</span> null <span class="token operator">||</span> lists<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>          <span class="token keyword">return</span> null<span class="token punctuation">;</span>      res <span class="token operator">=</span> lists<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> lists<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>          res <span class="token operator">=</span> <span class="token function">merge</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> lists<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">return</span> res<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">// code from 21.Merge two lists</span><span class="token keyword">private</span> ListNode <span class="token function">merge</span><span class="token punctuation">(</span>ListNode l1<span class="token punctuation">,</span> ListNode l2<span class="token punctuation">)</span> <span class="token punctuation">{</span>    ListNode l <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ListNode</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> tmp <span class="token operator">=</span> l<span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>l1 <span class="token operator">!=</span> null <span class="token operator">&amp;&amp;</span> l2 <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>l1<span class="token punctuation">.</span>val <span class="token operator">></span> l2<span class="token punctuation">.</span>val<span class="token punctuation">)</span> <span class="token punctuation">{</span>            tmp<span class="token punctuation">.</span>next <span class="token operator">=</span> l2<span class="token punctuation">;</span>            l2 <span class="token operator">=</span> l2<span class="token punctuation">.</span>next<span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            tmp<span class="token punctuation">.</span>next <span class="token operator">=</span> l1<span class="token punctuation">;</span>            l1 <span class="token operator">=</span> l1<span class="token punctuation">.</span>next<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        tmp <span class="token operator">=</span> tmp<span class="token punctuation">.</span>next<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    tmp<span class="token punctuation">.</span>next <span class="token operator">=</span> l1 <span class="token operator">!=</span> null <span class="token operator">?</span> l1 <span class="token operator">:</span> l2<span class="token punctuation">;</span>    <span class="token keyword">return</span> l<span class="token punctuation">.</span>next<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(kn)​$</li><li>空间复杂度：$O(n)$</li></ul><h4 id="分治法，两两合并，然后再合并……"><a href="#分治法，两两合并，然后再合并……" class="headerlink" title="分治法，两两合并，然后再合并……"></a>分治法，两两合并，然后再合并……</h4><ul><li><strong>这是实践效果最快的！</strong></li></ul><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> ListNode <span class="token function">mergeKLists</span><span class="token punctuation">(</span>ListNode<span class="token punctuation">[</span><span class="token punctuation">]</span> lists<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>lists <span class="token operator">==</span> null <span class="token operator">||</span> lists<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>          <span class="token keyword">return</span> null<span class="token punctuation">;</span>      <span class="token keyword">return</span> <span class="token function">helper</span><span class="token punctuation">(</span>lists<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> lists<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">private</span> ListNode <span class="token function">helper</span><span class="token punctuation">(</span>ListNode list<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> from<span class="token punctuation">,</span> <span class="token keyword">int</span> to<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>from <span class="token operator">==</span> to<span class="token punctuation">)</span>          <span class="token keyword">return</span> list<span class="token punctuation">[</span>from<span class="token punctuation">]</span><span class="token punctuation">;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>from <span class="token operator">==</span> to <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>          <span class="token keyword">return</span> <span class="token function">merge</span><span class="token punctuation">(</span>list<span class="token punctuation">[</span>from<span class="token punctuation">]</span><span class="token punctuation">,</span> list<span class="token punctuation">[</span>to<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">int</span> mid <span class="token operator">=</span> from <span class="token operator">+</span> <span class="token punctuation">(</span>to <span class="token operator">-</span> from<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>      <span class="token keyword">return</span> <span class="token function">merge</span><span class="token punctuation">(</span><span class="token function">helper</span><span class="token punctuation">(</span>list<span class="token punctuation">,</span> from<span class="token punctuation">,</span> mid<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">helper</span><span class="token punctuation">(</span>list<span class="token punctuation">,</span> mid <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> to<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">// code from 21.Merge two lists</span><span class="token keyword">private</span> ListNode <span class="token function">merge</span><span class="token punctuation">(</span>ListNode l1<span class="token punctuation">,</span> ListNode l2<span class="token punctuation">)</span> <span class="token punctuation">{</span>    ListNode l <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ListNode</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> tmp <span class="token operator">=</span> l<span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>l1 <span class="token operator">!=</span> null <span class="token operator">&amp;&amp;</span> l2 <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>l1<span class="token punctuation">.</span>val <span class="token operator">></span> l2<span class="token punctuation">.</span>val<span class="token punctuation">)</span> <span class="token punctuation">{</span>            tmp<span class="token punctuation">.</span>next <span class="token operator">=</span> l2<span class="token punctuation">;</span>            l2 <span class="token operator">=</span> l2<span class="token punctuation">.</span>next<span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            tmp<span class="token punctuation">.</span>next <span class="token operator">=</span> l1<span class="token punctuation">;</span>            l1 <span class="token operator">=</span> l1<span class="token punctuation">.</span>next<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        tmp <span class="token operator">=</span> tmp<span class="token punctuation">.</span>next<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    tmp<span class="token punctuation">.</span>next <span class="token operator">=</span> l1 <span class="token operator">!=</span> null <span class="token operator">?</span> l1 <span class="token operator">:</span> l2<span class="token punctuation">;</span>    <span class="token keyword">return</span> l<span class="token punctuation">.</span>next<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(nlogk)​$</li><li>空间复杂度：$O(n+log(k))$，其中$log(k)$为递归的栈深度</li></ul>]]></content>
      
      
      <categories>
          
          <category> leetcode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hard </tag>
            
            <tag> divide and conquer </tag>
            
            <tag> linked list </tag>
            
            <tag> priority queue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>22.Generate Parentheses</title>
      <link href="/22-Generate-Parentheses/"/>
      <url>/22-Generate-Parentheses/</url>
      
        <content type="html"><![CDATA[<h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p>Given <em>n</em> pairs of parentheses, write a function to generate all combinations of well-formed parentheses.</p><a id="more"></a><p>For example, given <em>n</em> = 3, a solution set is:</p><pre class="line-numbers language-java"><code class="language-java"><span class="token punctuation">[</span>  <span class="token string">"((()))"</span><span class="token punctuation">,</span>  <span class="token string">"(()())"</span><span class="token punctuation">,</span>  <span class="token string">"(())()"</span><span class="token punctuation">,</span>  <span class="token string">"()(())"</span><span class="token punctuation">,</span>  <span class="token string">"()()()"</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><h4 id="递归-回溯，记录开闭括号数量保持平衡"><a href="#递归-回溯，记录开闭括号数量保持平衡" class="headerlink" title="递归+回溯，记录开闭括号数量保持平衡"></a>递归+回溯，记录开闭括号数量保持平衡</h4><ul><li>使用char数组，节约空间、提高效率。</li></ul><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">private</span> List<span class="token operator">&lt;</span>String<span class="token operator">></span> res<span class="token punctuation">;</span><span class="token keyword">private</span> <span class="token keyword">int</span> bound<span class="token punctuation">;</span><span class="token keyword">private</span> <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> word<span class="token punctuation">;</span><span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">helper</span><span class="token punctuation">(</span><span class="token keyword">int</span> left<span class="token punctuation">,</span> <span class="token keyword">int</span> right<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>left <span class="token operator">==</span> bound <span class="token operator">&amp;&amp;</span> right <span class="token operator">==</span> bound<span class="token punctuation">)</span> <span class="token punctuation">{</span>        res<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>String<span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>word<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>left <span class="token operator">&lt;</span> bound<span class="token punctuation">)</span> <span class="token punctuation">{</span>        word<span class="token punctuation">[</span>left <span class="token operator">+</span> right<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'('</span><span class="token punctuation">;</span>        <span class="token function">helper</span><span class="token punctuation">(</span>left <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> right<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>right <span class="token operator">&lt;</span> bound <span class="token operator">&amp;&amp;</span> right <span class="token operator">&lt;</span> left<span class="token punctuation">)</span> <span class="token punctuation">{</span>        word<span class="token punctuation">[</span>left <span class="token operator">+</span> right<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">')'</span><span class="token punctuation">;</span>        <span class="token function">helper</span><span class="token punctuation">(</span>left<span class="token punctuation">,</span> right <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">public</span> List<span class="token operator">&lt;</span>String<span class="token operator">></span> <span class="token function">generateParenthesis</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>    res <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    bound <span class="token operator">=</span> n<span class="token punctuation">;</span>    word <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">char</span><span class="token punctuation">[</span>n <span class="token operator">+</span> n<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token function">helper</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> res<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(\dfrac{4^n}{\sqrt{n}})$，这个论证比较复杂，详见<a href="https://zh.wikipedia.org/wiki/%E5%8D%A1%E5%A1%94%E5%85%B0%E6%95%B0">卡塔兰数</a></li><li>空间复杂度：$O(\dfrac{4^n}{\sqrt{n}})​$</li></ul><h4 id="递归的风骚写法！"><a href="#递归的风骚写法！" class="headerlink" title="递归的风骚写法！"></a>递归的风骚写法！</h4><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> List<span class="token operator">&lt;</span>String<span class="token operator">></span> <span class="token function">generateParenthesis</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>    List<span class="token operator">&lt;</span>String<span class="token operator">></span> ans <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>        ans<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">else</span> <span class="token punctuation">{</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> c <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> c <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>c<span class="token punctuation">)</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span>String left<span class="token operator">:</span> <span class="token function">generateParenthesis</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token keyword">for</span> <span class="token punctuation">(</span>String right<span class="token operator">:</span> <span class="token function">generateParenthesis</span><span class="token punctuation">(</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token operator">-</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span>                    ans<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"("</span> <span class="token operator">+</span> left <span class="token operator">+</span> <span class="token string">")"</span> <span class="token operator">+</span> right<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> ans<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(\dfrac{4^n}{\sqrt{n}})$</li><li>空间复杂度：$O(\dfrac{4^n}{\sqrt{n}})$</li></ul>]]></content>
      
      
      <categories>
          
          <category> leetcode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> string </tag>
            
            <tag> medium </tag>
            
            <tag> permutation </tag>
            
            <tag> backtracking </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>21.Merge Two Sorted Lists</title>
      <link href="/21-Merge-Two-Sorted-Lists/"/>
      <url>/21-Merge-Two-Sorted-Lists/</url>
      
        <content type="html"><![CDATA[<h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p>Merge two sorted linked lists and return it as a new list. The new list should be made by splicing together the nodes of the first two lists.</p><a id="more"></a><p><strong>Example:</strong></p><pre class="line-numbers language-java"><code class="language-java">Input<span class="token operator">:</span> <span class="token number">1</span><span class="token operator">-</span><span class="token operator">></span><span class="token number">2</span><span class="token operator">-</span><span class="token operator">></span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">-</span><span class="token operator">></span><span class="token number">3</span><span class="token operator">-</span><span class="token operator">></span><span class="token number">4</span>Output<span class="token operator">:</span> <span class="token number">1</span><span class="token operator">-</span><span class="token operator">></span><span class="token number">1</span><span class="token operator">-</span><span class="token operator">></span><span class="token number">2</span><span class="token operator">-</span><span class="token operator">></span><span class="token number">3</span><span class="token operator">-</span><span class="token operator">></span><span class="token number">4</span><span class="token operator">-</span><span class="token operator">></span><span class="token number">4</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><h4 id="归并常规做法。"><a href="#归并常规做法。" class="headerlink" title="归并常规做法。"></a>归并常规做法。</h4><ul><li>这里如果不能指向原来的元素就不能这样写，需要重新创造node。</li></ul><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> ListNode <span class="token function">mergeTwoLists</span><span class="token punctuation">(</span>ListNode l1<span class="token punctuation">,</span> ListNode l2<span class="token punctuation">)</span> <span class="token punctuation">{</span>    ListNode dummy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ListNode</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> curr <span class="token operator">=</span> dummy<span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>l1 <span class="token operator">!=</span> null <span class="token operator">&amp;&amp;</span> l2 <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>l1<span class="token punctuation">.</span>val <span class="token operator">></span> l2<span class="token punctuation">.</span>val<span class="token punctuation">)</span> <span class="token punctuation">{</span>            curr<span class="token punctuation">.</span>next <span class="token operator">=</span> l2<span class="token punctuation">;</span>            l2 <span class="token operator">=</span> l2<span class="token punctuation">.</span>next<span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            curr<span class="token punctuation">.</span>next <span class="token operator">=</span> l1<span class="token punctuation">;</span>            l1 <span class="token operator">=</span> l1<span class="token punctuation">.</span>next<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        curr <span class="token operator">=</span> tmp<span class="token punctuation">.</span>next<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    curr<span class="token punctuation">.</span>next <span class="token operator">=</span> l1 <span class="token operator">!=</span> null <span class="token operator">?</span> l1 <span class="token operator">:</span> l2<span class="token punctuation">;</span>    <span class="token keyword">return</span> dummy<span class="token punctuation">.</span>next<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(n1 + n2)$</li><li>空间复杂度：$O(1)$</li></ul>]]></content>
      
      
      <categories>
          
          <category> leetcode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> two pointers </tag>
            
            <tag> easy </tag>
            
            <tag> linked list </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20.Valid Parentheses</title>
      <link href="/20-Valid-Parentheses/"/>
      <url>/20-Valid-Parentheses/</url>
      
        <content type="html"><![CDATA[<h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p>Given a string containing just the characters <code>&#39;(&#39;</code>, <code>&#39;)&#39;</code>, <code>&#39;{&#39;</code>, <code>&#39;}&#39;</code>, <code>&#39;[&#39;</code>and <code>&#39;]&#39;</code>, determine if the input string is valid.</p><p>An input string is valid if:</p><ol><li>Open brackets must be closed by the same type of brackets.</li><li>Open brackets must be closed in the correct order.</li></ol><p>Note that an empty string is also considered valid.</p><a id="more"></a><p><strong>Example 1:</strong></p><pre class="line-numbers language-java"><code class="language-java">Input<span class="token operator">:</span> <span class="token string">"()"</span>Output<span class="token operator">:</span> <span class="token boolean">true</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>Example 2:</strong></p><pre class="line-numbers language-java"><code class="language-java">Input<span class="token operator">:</span> <span class="token string">"()[]{}"</span>Output<span class="token operator">:</span> <span class="token boolean">true</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>Example 3:</strong></p><pre class="line-numbers language-java"><code class="language-java">Input<span class="token operator">:</span> <span class="token string">"(]"</span>Output<span class="token operator">:</span> <span class="token boolean">false</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>Example 4:</strong></p><pre class="line-numbers language-java"><code class="language-java">Input<span class="token operator">:</span> <span class="token string">"([)]"</span>Output<span class="token operator">:</span> <span class="token boolean">false</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>Example 5:</strong></p><pre class="line-numbers language-java"><code class="language-java">Input<span class="token operator">:</span> <span class="token string">"{[]}"</span>Output<span class="token operator">:</span> <span class="token boolean">true</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><h4 id="stack，使用栈保存未匹配的符号"><a href="#stack，使用栈保存未匹配的符号" class="headerlink" title="stack，使用栈保存未匹配的符号"></a>stack，使用栈保存未匹配的符号</h4><ul><li>遇到左括号就压入栈；</li><li>遇到右括号，如栈为空或者栈顶元素不是匹配的左括号，则返回false；否则将匹配的左括号弹出。</li></ul><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isValid</span><span class="token punctuation">(</span>String s<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>s <span class="token operator">==</span> null<span class="token punctuation">)</span>          <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> n <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">// 如果奇数个符号，显然不能匹配</span>          <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    Stack<span class="token operator">&lt;</span>Integer<span class="token operator">></span> stack <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Stack</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    HashMap<span class="token operator">&lt;</span>Character<span class="token punctuation">,</span> Integer<span class="token operator">></span> symbolVal <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    symbolVal<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">'{'</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    symbolVal<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">'}'</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    symbolVal<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">'['</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    symbolVal<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">']'</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    symbolVal<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">'('</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    symbolVal<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">')'</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">char</span> c <span class="token operator">:</span> s<span class="token punctuation">.</span><span class="token function">toCharArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> tmp <span class="token operator">=</span> symbolVal<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>stack<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> stack<span class="token punctuation">.</span><span class="token function">peek</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> tmp <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>              stack<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>tmp <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>              <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token keyword">else</span>              stack<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> stack<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(n)$</li><li>空间复杂度：$O(n)$</li></ul>]]></content>
      
      
      <categories>
          
          <category> leetcode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hash map </tag>
            
            <tag> easy </tag>
            
            <tag> string </tag>
            
            <tag> stack </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>19.Remove Nth Node From End of List</title>
      <link href="/19-Remove-Nth-Node-From-End-of-List/"/>
      <url>/19-Remove-Nth-Node-From-End-of-List/</url>
      
        <content type="html"><![CDATA[<h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p>Given a linked list, remove the <em>n</em>-th node from the end of list and return its head.</p><a id="more"></a><p><strong>Example:</strong></p><pre class="line-numbers language-java"><code class="language-java">Given linked list<span class="token operator">:</span> <span class="token number">1</span><span class="token operator">-</span><span class="token operator">></span><span class="token number">2</span><span class="token operator">-</span><span class="token operator">></span><span class="token number">3</span><span class="token operator">-</span><span class="token operator">></span><span class="token number">4</span><span class="token operator">-</span><span class="token operator">></span><span class="token number">5</span><span class="token punctuation">,</span> and n <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">.</span>After removing the second node from the end<span class="token punctuation">,</span> the linked list becomes <span class="token number">1</span><span class="token operator">-</span><span class="token operator">></span><span class="token number">2</span><span class="token operator">-</span><span class="token operator">></span><span class="token number">3</span><span class="token operator">-</span><span class="token operator">></span><span class="token number">5</span><span class="token punctuation">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><strong>Note:</strong></p><p>Given <em>n</em> will always be valid.</p><p><strong>Follow up:</strong></p><p>Could you do this in one pass?</p><h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><h4 id="遍历获得节点个数，并直接计算出从head出发需要的步数，即可获得所求节点"><a href="#遍历获得节点个数，并直接计算出从head出发需要的步数，即可获得所求节点" class="headerlink" title="遍历获得节点个数，并直接计算出从head出发需要的步数，即可获得所求节点"></a>遍历获得节点个数，并直接计算出从head出发需要的步数，即可获得所求节点</h4><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> ListNode <span class="token function">removeNthFromEnd</span><span class="token punctuation">(</span>ListNode head<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>    ListNode dummy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ListNode</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    dummy<span class="token punctuation">.</span>next <span class="token operator">=</span> head<span class="token punctuation">;</span>    <span class="token keyword">int</span> length  <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    ListNode first <span class="token operator">=</span> head<span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>first <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>        length<span class="token operator">++</span><span class="token punctuation">;</span>        first <span class="token operator">=</span> first<span class="token punctuation">.</span>next<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    length <span class="token operator">-=</span> n<span class="token punctuation">;</span>    first <span class="token operator">=</span> dummy<span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>length <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        length<span class="token operator">--</span><span class="token punctuation">;</span>        first <span class="token operator">=</span> first<span class="token punctuation">.</span>next<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    first<span class="token punctuation">.</span>next <span class="token operator">=</span> first<span class="token punctuation">.</span>next<span class="token punctuation">.</span>next<span class="token punctuation">;</span>    <span class="token keyword">return</span> dummy<span class="token punctuation">.</span>next<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(L)​$，但是需要2 passes。</li><li>空间复杂度：$O(1)$</li></ul><h4 id="快慢指针，快的比慢的多走k步即可，当快节点到头，慢节点将指向正确的位置。"><a href="#快慢指针，快的比慢的多走k步即可，当快节点到头，慢节点将指向正确的位置。" class="headerlink" title="快慢指针，快的比慢的多走k步即可，当快节点到头，慢节点将指向正确的位置。"></a>快慢指针，快的比慢的多走k步即可，当快节点到头，慢节点将指向正确的位置。</h4><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> ListNode <span class="token function">removeNthFromEnd</span><span class="token punctuation">(</span>ListNode head<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>    ListNode dummy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ListNode</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    dummy<span class="token punctuation">.</span>next <span class="token operator">=</span> head<span class="token punctuation">;</span>    ListNode fast <span class="token operator">=</span> dummy<span class="token punctuation">,</span> slow <span class="token operator">=</span> dummy<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        fast <span class="token operator">=</span> fast<span class="token punctuation">.</span>next<span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// Invalid n</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>fast <span class="token operator">==</span> null<span class="token punctuation">)</span>            <span class="token keyword">return</span> head<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>fast<span class="token punctuation">.</span>next<span class="token punctuation">.</span>next <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>        slow <span class="token operator">=</span> slow<span class="token punctuation">.</span>next<span class="token punctuation">;</span>        fast <span class="token operator">=</span> fast<span class="token punctuation">.</span>next<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    slow<span class="token punctuation">.</span>next <span class="token operator">=</span> slow<span class="token punctuation">.</span>next<span class="token punctuation">.</span>next<span class="token punctuation">;</span>    <span class="token keyword">return</span> dummy<span class="token punctuation">.</span>next<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(L)$，1 pass</li><li>空间复杂度：$O(1)$</li></ul>]]></content>
      
      
      <categories>
          
          <category> leetcode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> two pointers </tag>
            
            <tag> medium </tag>
            
            <tag> linked list </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>18.4Sum</title>
      <link href="/18-4Sum/"/>
      <url>/18-4Sum/</url>
      
        <content type="html"><![CDATA[<h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p>Given an array <code>nums</code> of <em>n</em> integers and an integer <code>target</code>, are there elements <em>a</em>, <em>b</em>, <em>c</em>, and <em>d</em> in <code>nums</code> such that <em>a</em> + <em>b</em> + <em>c</em> + <em>d</em> = <code>target</code>? Find all unique quadruplets in the array which gives the sum of <code>target</code>.</p><p><strong>Note:</strong></p><p>The solution set must not contain duplicate quadruplets.</p><a id="more"></a><p><strong>Example:</strong></p><pre><code>Given array nums = [1, 0, -1, 0, -2, 2], and target = 0.A solution set is:[  [-1,  0, 0, 1],  [-2, -1, 1, 2],  [-2,  0, 0, 2]]</code></pre><h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><h4 id="暴力搜索"><a href="#暴力搜索" class="headerlink" title="暴力搜索"></a>暴力搜索</h4><ul><li>时间复杂度：$O(n^4)$</li><li>空间复杂度：$O(n^4)$</li></ul><h4 id="排序-递归-双指针"><a href="#排序-递归-双指针" class="headerlink" title="排序+递归+双指针"></a>排序+递归+双指针</h4><ul><li>这里给出n-sum版本</li><li>使用最小值和最大值进行剪枝可以避免无效计算</li></ul><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> List<span class="token operator">&lt;</span>List<span class="token operator">&lt;</span>Integer<span class="token operator">>></span> <span class="token function">fourSum</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">,</span> <span class="token keyword">int</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>    Arrays<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span>nums<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token function">nSum</span><span class="token punctuation">(</span>nums<span class="token punctuation">,</span> target<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">private</span> <span class="token keyword">int</span> <span class="token function">maxSum</span><span class="token punctuation">(</span><span class="token keyword">int</span> nums<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">int</span> res <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> len <span class="token operator">=</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>        res <span class="token operator">+=</span> nums<span class="token punctuation">[</span>len <span class="token operator">-</span> i<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> res<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">private</span> <span class="token keyword">int</span> <span class="token function">minSum</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">,</span> <span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">int</span> res <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>        res <span class="token operator">+=</span> nums<span class="token punctuation">[</span>i <span class="token operator">+</span> index<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> res<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">private</span> List<span class="token operator">&lt;</span>List<span class="token operator">&lt;</span>Integer<span class="token operator">>></span> <span class="token function">nSum</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">,</span> <span class="token keyword">int</span> target<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">,</span> <span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>nums<span class="token punctuation">.</span>length <span class="token operator">-</span> index <span class="token operator">&lt;</span> n <span class="token operator">||</span> <span class="token function">maxSum</span><span class="token punctuation">(</span>nums<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token operator">&lt;</span> target <span class="token operator">||</span> <span class="token function">minSum</span><span class="token punctuation">(</span>nums<span class="token punctuation">,</span> n<span class="token punctuation">,</span> index<span class="token punctuation">)</span> <span class="token operator">></span> target<span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    List<span class="token operator">&lt;</span>List<span class="token operator">&lt;</span>Integer<span class="token operator">>></span> res <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> len <span class="token operator">=</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 2 sum</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> lo <span class="token operator">=</span> index<span class="token punctuation">,</span> hi <span class="token operator">=</span> len <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>lo <span class="token operator">&lt;</span> hi<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>nums<span class="token punctuation">[</span>lo<span class="token punctuation">]</span> <span class="token operator">+</span> nums<span class="token punctuation">[</span>hi<span class="token punctuation">]</span> <span class="token operator">&lt;</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">do</span> <span class="token punctuation">{</span>                    lo<span class="token operator">++</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span>lo <span class="token operator">&lt;</span> hi <span class="token operator">&amp;&amp;</span> nums<span class="token punctuation">[</span>lo<span class="token punctuation">]</span> <span class="token operator">==</span> nums<span class="token punctuation">[</span>lo <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><span class="token comment" spellcheck="true">// >= target</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>nums<span class="token punctuation">[</span>lo<span class="token punctuation">]</span> <span class="token operator">+</span> nums<span class="token punctuation">[</span>hi<span class="token punctuation">]</span> <span class="token operator">==</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>                    List<span class="token operator">&lt;</span>Integer<span class="token operator">></span> tmp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    tmp<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>lo<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    tmp<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>hi<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    res<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>                <span class="token keyword">do</span> <span class="token punctuation">{</span>                    hi<span class="token operator">--</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span>lo <span class="token operator">&lt;</span> hi <span class="token operator">&amp;&amp;</span> nums<span class="token punctuation">[</span>hi<span class="token punctuation">]</span> <span class="token operator">==</span> nums<span class="token punctuation">[</span>hi <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><span class="token comment" spellcheck="true">// n sum</span>        <span class="token keyword">int</span> start <span class="token operator">=</span> index<span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>start <span class="token operator">&lt;=</span> len <span class="token operator">-</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>            List<span class="token operator">&lt;</span>List<span class="token operator">&lt;</span>Integer<span class="token operator">>></span> tmp <span class="token operator">=</span> <span class="token function">nSum</span><span class="token punctuation">(</span>nums<span class="token punctuation">,</span> target <span class="token operator">-</span> nums<span class="token punctuation">[</span>start<span class="token punctuation">]</span><span class="token punctuation">,</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> start <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span>List<span class="token operator">&lt;</span>Integer<span class="token operator">></span> a <span class="token operator">:</span> tmp<span class="token punctuation">)</span> <span class="token punctuation">{</span>                a<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>start<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                res<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>              <span class="token comment" spellcheck="true">// remove duplicates</span>            <span class="token keyword">do</span> <span class="token punctuation">{</span>                start<span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span>start <span class="token operator">&lt;=</span> len <span class="token operator">-</span> n <span class="token operator">&amp;&amp;</span> nums<span class="token punctuation">[</span>start<span class="token punctuation">]</span> <span class="token operator">==</span> nums<span class="token punctuation">[</span>start <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> res<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(n^3)$</li><li>空间复杂度：$O(n^3)$</li></ul><hr><p>事实上，双指针法可以将复杂度降一个n的幂次。</p>]]></content>
      
      
      <categories>
          
          <category> leetcode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> array </tag>
            
            <tag> two pointers </tag>
            
            <tag> medium </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>17.Letters Combinations of a Phone Number</title>
      <link href="/17-Letters-Combinations-of-a-Phone-Number/"/>
      <url>/17-Letters-Combinations-of-a-Phone-Number/</url>
      
        <content type="html"><![CDATA[<h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p>Given a string containing digits from <code>2-9</code> inclusive, return all possible letter combinations that the number could represent.</p><p>A mapping of digit to letters (just like on the telephone buttons) is given below. Note that 1 does not map to any letters.</p><a id="more"></a><p><img src="http://upload.wikimedia.org/wikipedia/commons/thumb/7/73/Telephone-keypad2.svg/200px-Telephone-keypad2.svg.png" alt="img"></p><p><strong>Example:</strong></p><pre><code>Input: &quot;23&quot;Output: [&quot;ad&quot;, &quot;ae&quot;, &quot;af&quot;, &quot;bd&quot;, &quot;be&quot;, &quot;bf&quot;, &quot;cd&quot;, &quot;ce&quot;, &quot;cf&quot;].</code></pre><p><strong>Note:</strong></p><p>Although the above answer is in lexicographical order, your answer could be in any order you want.</p><h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><h4 id="递归-回溯"><a href="#递归-回溯" class="headerlink" title="递归+回溯"></a>递归+回溯</h4><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">private</span> String<span class="token punctuation">[</span><span class="token punctuation">]</span> keys <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token string">"abc"</span><span class="token punctuation">,</span> <span class="token string">"def"</span><span class="token punctuation">,</span> <span class="token string">"ghi"</span><span class="token punctuation">,</span> <span class="token string">"jkl"</span><span class="token punctuation">,</span> <span class="token string">"mno"</span><span class="token punctuation">,</span> <span class="token string">"pqrs"</span><span class="token punctuation">,</span> <span class="token string">"tuv"</span><span class="token punctuation">,</span> <span class="token string">"wxyz"</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">helper</span><span class="token punctuation">(</span>List<span class="token operator">&lt;</span>String<span class="token operator">></span> res<span class="token punctuation">,</span> String curr<span class="token punctuation">,</span> String digits<span class="token punctuation">,</span> <span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">>=</span> digits<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            res<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>curr<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token keyword">return</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">char</span> c <span class="token operator">:</span> keys<span class="token punctuation">[</span>digits<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token string">'2'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">toCharArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token function">helper</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> curr <span class="token operator">+</span> String<span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">,</span> digits<span class="token punctuation">,</span> index <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">public</span> List<span class="token operator">&lt;</span>String<span class="token operator">></span> <span class="token function">letterCombinations</span><span class="token punctuation">(</span>String digits<span class="token punctuation">)</span> <span class="token punctuation">{</span>      List<span class="token operator">&lt;</span>String<span class="token operator">></span> res <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>digits<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>          <span class="token keyword">return</span> res<span class="token punctuation">;</span>      <span class="token function">helper</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> digits<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">return</span> res<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(3^n4^m)​$，n和m分别是对应3个和4个字符的数字在原字符串出现的个数。</li><li>空间复杂度：$O(3^n4^m)$，解的大小；其中栈的深度为原字符串长度。</li></ul><h4 id="迭代"><a href="#迭代" class="headerlink" title="迭代"></a>迭代</h4><ul><li>这里注意，不能直接在遍历时修改。一方面答案会出错，另一方面会遇到concurrentModification的异常。</li></ul><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> List<span class="token operator">&lt;</span>String<span class="token operator">></span> <span class="token function">letterCombinations</span><span class="token punctuation">(</span>String digits<span class="token punctuation">)</span> <span class="token punctuation">{</span>    List<span class="token operator">&lt;</span>String<span class="token operator">></span> res <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>digits<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>          <span class="token keyword">return</span> res<span class="token punctuation">;</span>    res<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    String<span class="token punctuation">[</span><span class="token punctuation">]</span> keys <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token string">"abc"</span><span class="token punctuation">,</span> <span class="token string">"def"</span><span class="token punctuation">,</span> <span class="token string">"ghi"</span><span class="token punctuation">,</span> <span class="token string">"jkl"</span><span class="token punctuation">,</span> <span class="token string">"mno"</span><span class="token punctuation">,</span> <span class="token string">"pqrs"</span><span class="token punctuation">,</span> <span class="token string">"tuv"</span><span class="token punctuation">,</span> <span class="token string">"wxyz"</span><span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">char</span> c <span class="token operator">:</span> digits<span class="token punctuation">.</span><span class="token function">toCharArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        List<span class="token operator">&lt;</span>String<span class="token operator">></span> tmp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>String s <span class="token operator">:</span> res<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">char</span> d <span class="token operator">:</span> keys<span class="token punctuation">[</span>c <span class="token operator">-</span> <span class="token string">'2'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">toCharArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                tmp<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>s <span class="token operator">+</span> String<span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        res <span class="token operator">=</span> tmp<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> res<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(3^n4^m)$</li><li>空间复杂度：$O(3^n4^m)$</li></ul>]]></content>
      
      
      <categories>
          
          <category> leetcode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> string </tag>
            
            <tag> medium </tag>
            
            <tag> permutation </tag>
            
            <tag> backtracking </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>16.3Sum Closest</title>
      <link href="/16-3Sum-Closest/"/>
      <url>/16-3Sum-Closest/</url>
      
        <content type="html"><![CDATA[<h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p>Given an array <code>nums</code> of <em>n</em> integers and an integer <code>target</code>, find three integers in <code>nums</code> such that the sum is closest to <code>target</code>. Return the sum of the three integers. You may assume that each input would have exactly one solution.</p><a id="more"></a><p><strong>Example:</strong></p><pre><code>Given array nums = [-1, 2, 1, -4], and target = 1.The sum that is closest to the target is 2. (-1 + 2 + 1 = 2).</code></pre><h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><h4 id="暴力三重循环"><a href="#暴力三重循环" class="headerlink" title="暴力三重循环"></a>暴力三重循环</h4><ul><li>时间复杂度：$O(n^3)$</li><li>空间复杂度：$O(1)$</li></ul><h4 id="排序-双指针"><a href="#排序-双指针" class="headerlink" title="排序+双指针"></a>排序+双指针</h4><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">threeSumClosest</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">,</span> <span class="token keyword">int</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>nums <span class="token operator">==</span> null <span class="token operator">||</span> nums<span class="token punctuation">.</span>length <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    Arrays<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span>nums<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> res <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> diff <span class="token operator">=</span> Integer<span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">,</span> first<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>first <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> first <span class="token operator">&lt;</span> nums<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">;</span> first<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> right <span class="token operator">=</span> nums<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> left <span class="token operator">=</span> first <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> tmp <span class="token operator">=</span> target <span class="token operator">-</span> nums<span class="token punctuation">[</span>first<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>left <span class="token operator">&lt;</span> right<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">int</span> curr <span class="token operator">=</span> nums<span class="token punctuation">[</span>left<span class="token punctuation">]</span> <span class="token operator">+</span> nums<span class="token punctuation">[</span>right<span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>curr <span class="token operator">==</span> tmp<span class="token punctuation">)</span>                <span class="token keyword">return</span> target<span class="token punctuation">;</span><span class="token comment" spellcheck="true">// special case: diff = 0, just return.</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>curr <span class="token operator">-</span> tmp<span class="token punctuation">)</span> <span class="token operator">&lt;</span> diff<span class="token punctuation">)</span> <span class="token punctuation">{</span>                diff <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>curr <span class="token operator">-</span> tmp<span class="token punctuation">)</span><span class="token punctuation">;</span>                res <span class="token operator">=</span> curr <span class="token operator">+</span> nums<span class="token punctuation">[</span>first<span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>curr <span class="token operator">&lt;</span> tmp<span class="token punctuation">)</span>                left<span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token keyword">else</span>                right<span class="token operator">--</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> res<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(n^2)$</li><li>空间复杂度：$O(1)$</li></ul>]]></content>
      
      
      <categories>
          
          <category> leetcode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> array </tag>
            
            <tag> two pointers </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>15.3Sum</title>
      <link href="/15-3Sum/"/>
      <url>/15-3Sum/</url>
      
        <content type="html"><![CDATA[<h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p>Given an array <code>nums</code> of <em>n</em> integers, are there elements <em>a</em>, <em>b</em>, <em>c</em> in <code>nums</code> such that <em>a</em> + <em>b</em> + <em>c</em> = 0? Find all unique triplets in the array which gives the sum of zero.</p><p><strong>Note:</strong></p><p>The solution set must not contain duplicate triplets.</p><a id="more"></a><p><strong>Example:</strong></p><pre class="line-numbers language-java"><code class="language-java">Given array nums <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>A solution set is<span class="token operator">:</span><span class="token punctuation">[</span>  <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><ol><li><p>暴力循环+去重</p><ul><li>时间复杂度：$O(n^3)$</li><li>空间复杂度：$O(n^3)$</li></ul></li><li><p>排序+双指针</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> List<span class="token operator">&lt;</span>List<span class="token operator">&lt;</span>Integer<span class="token operator">>></span> <span class="token function">threeSum</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>nums <span class="token operator">==</span> null <span class="token operator">||</span> nums<span class="token punctuation">.</span>length <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">)</span>          <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Arrays<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span>nums<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> n <span class="token operator">=</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">,</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    List<span class="token operator">&lt;</span>List<span class="token operator">&lt;</span>Integer<span class="token operator">>></span> res <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> n <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        List<span class="token operator">&lt;</span>List<span class="token operator">&lt;</span>Integer<span class="token operator">>></span> two <span class="token operator">=</span> <span class="token function">twoSum</span><span class="token punctuation">(</span>nums<span class="token punctuation">,</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        res<span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>two<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">do</span> <span class="token punctuation">{</span>                i<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> n <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">&amp;&amp;</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> nums<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> res<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">private</span> List<span class="token operator">&lt;</span>List<span class="token operator">&lt;</span>Integer<span class="token operator">>></span> <span class="token function">twoSum</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">,</span> <span class="token keyword">int</span> from<span class="token punctuation">,</span> <span class="token keyword">int</span> to<span class="token punctuation">,</span> <span class="token keyword">int</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>    List<span class="token operator">&lt;</span>List<span class="token operator">&lt;</span>Integer<span class="token operator">>></span> res <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>from<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">></span> target <span class="token operator">||</span> <span class="token punctuation">(</span>nums<span class="token punctuation">[</span>to<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> target<span class="token punctuation">)</span>          <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>from <span class="token operator">&lt;</span> to<span class="token punctuation">)</span> <span class="token punctuation">{</span>          <span class="token keyword">if</span> <span class="token punctuation">(</span>nums<span class="token punctuation">[</span>from<span class="token punctuation">]</span> <span class="token operator">+</span> nums<span class="token punctuation">[</span>to<span class="token punctuation">]</span> <span class="token operator">&lt;</span> target<span class="token punctuation">)</span>              from<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token keyword">else</span> <span class="token punctuation">{</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>nums<span class="token punctuation">[</span>from<span class="token punctuation">]</span> <span class="token operator">+</span> nums<span class="token punctuation">[</span>to<span class="token punctuation">]</span> <span class="token operator">==</span> target<span class="token punctuation">)</span>                  res<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>Arrays<span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span><span class="token operator">-</span>target<span class="token punctuation">,</span> nums<span class="token punctuation">[</span>from<span class="token punctuation">]</span><span class="token punctuation">,</span> nums<span class="token punctuation">[</span>to<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              to<span class="token operator">--</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> res<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(n^2)$</li><li>空间复杂度：$O(n^2)$</li></ul></li></ol>]]></content>
      
      
      <categories>
          
          <category> leetcode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> array </tag>
            
            <tag> two pointers </tag>
            
            <tag> medium </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>14.Longest Common Prefix</title>
      <link href="/14-Longest-Common-Prefix/"/>
      <url>/14-Longest-Common-Prefix/</url>
      
        <content type="html"><![CDATA[<h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p>Write a function to find the longest common prefix string amongst an array of strings.</p><p>If there is no common prefix, return an empty string <code>&quot;&quot;</code>.</p><a id="more"></a><p><strong>Example 1:</strong></p><pre class="line-numbers language-java"><code class="language-java">Input<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"flower"</span><span class="token punctuation">,</span><span class="token string">"flow"</span><span class="token punctuation">,</span><span class="token string">"flight"</span><span class="token punctuation">]</span>Output<span class="token operator">:</span> <span class="token string">"fl"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>Example 2:</strong></p><pre class="line-numbers language-java"><code class="language-java">Input<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"dog"</span><span class="token punctuation">,</span><span class="token string">"racecar"</span><span class="token punctuation">,</span><span class="token string">"car"</span><span class="token punctuation">]</span>Output<span class="token operator">:</span> <span class="token string">""</span>Explanation<span class="token operator">:</span> There is no common prefix among the input strings<span class="token punctuation">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><strong>Note:</strong></p><p>All given inputs are in lowercase letters <code>a-z</code>.</p><h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><ol><li><p>Horizontal scanning，依次扫描两个单词间的最长前缀</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> String <span class="token function">longestCommonPrefix</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> strs<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>strs <span class="token operator">==</span> null <span class="token operator">||</span> strs<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>          <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span>      String res <span class="token operator">=</span> strs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> strs<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">int</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> n1 <span class="token operator">=</span> res<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> n2 <span class="token operator">=</span> strs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token keyword">while</span> <span class="token punctuation">(</span>index <span class="token operator">&lt;</span> n1 <span class="token operator">&amp;&amp;</span> index <span class="token operator">&lt;</span> n2 <span class="token operator">&amp;&amp;</span> strs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span> <span class="token operator">==</span> res<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">)</span>              index<span class="token operator">++</span><span class="token punctuation">;</span>          res <span class="token operator">=</span> res<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> index<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>      <span class="token keyword">return</span> res<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(nm)$，n为字符串数量，m为字符串平均长度</li><li>空间复杂度：$O(m)​$</li></ul></li><li><p>Vertical scanning，按字符依次扫描，如果所有str的第i都是这一字符那么就加入前缀</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> String <span class="token function">longestCommonPrefix</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> strs<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>strs <span class="token operator">==</span> null <span class="token operator">||</span> strs<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>          <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span>      StringBuilder res <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> strs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">char</span> curr <span class="token operator">=</span> strs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token keyword">boolean</span> contains <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> strs<span class="token punctuation">.</span>length<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">>=</span> strs<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">||</span> strs<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">!=</span> curr<span class="token punctuation">)</span> <span class="token punctuation">{</span>                contains <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>                  <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>          <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>contains<span class="token punctuation">)</span>              <span class="token keyword">break</span><span class="token punctuation">;</span>          res<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>curr<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>      <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(nm)$，n为字符串数量，m为字符串平均长度</li><li>空间复杂度：$O(m)$</li></ul></li><li><p>Divide and conquer，两两比较后再比较。在这里没有体现出优势的原因是两两比较的成本比较低（$O(m)$），时间复杂度也不比常规做法好</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> String <span class="token function">longestCommonPrefix</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> strs<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>strs <span class="token operator">==</span> null <span class="token operator">||</span> strs<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>          <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span>      <span class="token keyword">return</span> <span class="token function">helper</span><span class="token punctuation">(</span>strs<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> strs<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">public</span> String <span class="token function">helper</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> strs<span class="token punctuation">,</span> <span class="token keyword">int</span> from<span class="token punctuation">,</span> <span class="token keyword">int</span> to<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>to <span class="token operator">==</span> from<span class="token punctuation">)</span>          <span class="token keyword">return</span> strs<span class="token punctuation">[</span>from<span class="token punctuation">]</span><span class="token punctuation">;</span>      <span class="token keyword">int</span> mid <span class="token operator">=</span> from <span class="token operator">+</span> <span class="token punctuation">(</span>to <span class="token operator">-</span> from<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>      <span class="token keyword">return</span> <span class="token function">commonPrefix</span><span class="token punctuation">(</span><span class="token function">helper</span><span class="token punctuation">(</span>strs<span class="token punctuation">,</span> from<span class="token punctuation">,</span> mid<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">helper</span><span class="token punctuation">(</span>strs<span class="token punctuation">,</span> mid <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> to<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">private</span> String <span class="token function">commonPrefix</span><span class="token punctuation">(</span>String s1<span class="token punctuation">,</span> String s2<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> n1 <span class="token operator">=</span> s1<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> n2 <span class="token operator">=</span> s2<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n1 <span class="token operator">&amp;&amp;</span> i <span class="token operator">&lt;</span> n2<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>          <span class="token keyword">if</span> <span class="token punctuation">(</span>s1<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">!=</span> s2<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>              <span class="token keyword">break</span><span class="token punctuation">;</span>      <span class="token keyword">return</span> s1<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(nm)$，因为一共大约有$n/2 + n/4 + … + 1 = n = O(n)$次比较，每次比较的复杂度为$O(m)$</li><li>空间复杂度：$O(log(n))$，也就是递归栈的深度</li></ul></li><li><p>binary search，找到最短的字符串长度，并对可能的长度进行二分，遍历以确认这个长度是否是公共子序列。</p><ul><li>（二分的奇妙用法）</li></ul><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> String <span class="token function">longestCommonPrefix</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> strs<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>strs <span class="token operator">==</span> null <span class="token operator">||</span> strs<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> minLen <span class="token operator">=</span> Integer<span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span>String str <span class="token operator">:</span> strs<span class="token punctuation">)</span>        minLen <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>minLen<span class="token punctuation">,</span> str<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> lo <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> hi <span class="token operator">=</span> minLen<span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>lo <span class="token operator">&lt;</span> hi<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> mi <span class="token operator">=</span> <span class="token punctuation">(</span>lo <span class="token operator">+</span> hi<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isCommonPrefix</span><span class="token punctuation">(</span>strs<span class="token punctuation">,</span> mi<span class="token punctuation">)</span><span class="token punctuation">)</span>            lo <span class="token operator">=</span> mi <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">else</span>            hi <span class="token operator">=</span> mi<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isCommonPrefix</span><span class="token punctuation">(</span>strs<span class="token punctuation">,</span> lo<span class="token punctuation">)</span><span class="token punctuation">)</span>        lo<span class="token operator">--</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> strs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> lo<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">private</span> <span class="token keyword">boolean</span> <span class="token function">isCommonPrefix</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> strs<span class="token punctuation">,</span> <span class="token keyword">int</span> len<span class="token punctuation">)</span><span class="token punctuation">{</span>    String str1 <span class="token operator">=</span> strs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> strs<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>strs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span>str1<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(nmlog(m))$，一共调用$O(log(m))$次<code>isCommonPrefix</code>函数，每次调用复杂度为$O(nm)$</li><li>空间复杂度：$O(1)$</li></ul></li></ol><hr><h3 id="Follow-up：如果需要计算某字符串s和strs共同的最长前缀需要多次调用，应该如何实现？假设strs不变"><a href="#Follow-up：如果需要计算某字符串s和strs共同的最长前缀需要多次调用，应该如何实现？假设strs不变" class="headerlink" title="Follow up：如果需要计算某字符串s和strs共同的最长前缀需要多次调用，应该如何实现？假设strs不变"></a>Follow up：如果需要计算某字符串s和strs共同的最长前缀需要多次调用，应该如何实现？假设strs不变</h3><ul><li>使用trie。<ul><li>时间复杂度：$O(nm)$在构建树过程，$O(m)$在查找过程</li><li>空间复杂度：$O(nm)$用于存储trie树</li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> leetcode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> easy </tag>
            
            <tag> string </tag>
            
            <tag> longest xxx </tag>
            
            <tag> divide and conquer </tag>
            
            <tag> binary search </tag>
            
            <tag> trie </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>13.Roman to Integer</title>
      <link href="/13-Roman-to-Integer/"/>
      <url>/13-Roman-to-Integer/</url>
      
        <content type="html"><![CDATA[<h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p>Roman numerals are represented by seven different symbols: <code>I</code>, <code>V</code>, <code>X</code>, <code>L</code>, <code>C</code>, <code>D</code> and <code>M</code>.</p><pre class="line-numbers language-java"><code class="language-java">Symbol       ValueI             <span class="token number">1</span>V             <span class="token number">5</span>X             <span class="token number">10</span>L             <span class="token number">50</span>C             <span class="token number">100</span>D             <span class="token number">500</span>M             <span class="token number">1000</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>For example, two is written as <code>II</code> in Roman numeral, just two one’s added together. Twelve is written as, <code>XII</code>, which is simply <code>X</code> + <code>II</code>. The number twenty seven is written as <code>XXVII</code>, which is <code>XX</code> + <code>V</code> + <code>II</code>.</p><p>Roman numerals are usually written largest to smallest from left to right. However, the numeral for four is not <code>IIII</code>. Instead, the number four is written as <code>IV</code>. Because the one is before the five we subtract it making four. The same principle applies to the number nine, which is written as <code>IX</code>. There are six instances where subtraction is used:</p><ul><li><code>I</code> can be placed before <code>V</code> (5) and <code>X</code> (10) to make 4 and 9. </li><li><code>X</code> can be placed before <code>L</code> (50) and <code>C</code> (100) to make 40 and 90. </li><li><code>C</code> can be placed before <code>D</code> (500) and <code>M</code> (1000) to make 400 and 900.</li></ul><p>Given a roman numeral, convert it to an integer. Input is guaranteed to be within the range from 1 to 3999.</p><a id="more"></a><p><strong>Example 1:</strong></p><pre class="line-numbers language-java"><code class="language-java">Input<span class="token operator">:</span> <span class="token string">"III"</span>Output<span class="token operator">:</span> <span class="token number">3</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>Example 2:</strong></p><pre class="line-numbers language-java"><code class="language-java">Input<span class="token operator">:</span> <span class="token string">"IV"</span>Output<span class="token operator">:</span> <span class="token number">4</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>Example 3:</strong></p><pre class="line-numbers language-java"><code class="language-java">Input<span class="token operator">:</span> <span class="token string">"IX"</span>Output<span class="token operator">:</span> <span class="token number">9</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>Example 4:</strong></p><pre class="line-numbers language-java"><code class="language-java">Input<span class="token operator">:</span> <span class="token string">"LVIII"</span>Output<span class="token operator">:</span> <span class="token number">58</span>Explanation<span class="token operator">:</span> L <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">,</span> V<span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">,</span> III <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><strong>Example 5:</strong></p><pre class="line-numbers language-java"><code class="language-java">Input<span class="token operator">:</span> <span class="token string">"MCMXCIV"</span>Output<span class="token operator">:</span> <span class="token number">1994</span>Explanation<span class="token operator">:</span> M <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">,</span> CM <span class="token operator">=</span> <span class="token number">900</span><span class="token punctuation">,</span> XC <span class="token operator">=</span> <span class="token number">90</span> and IV <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><ol><li><p>使用hash map存所有数字对应字符，并将字符串的每一个字符转换成数字，接下来观察规律：</p><ul><li>如果从左到右没有出现逆序的字符（即，每个字符代表的数字都不大于左侧字符代表的数字）那么简单相加即可</li><li>如果出现逆序字符，那么该位的结果将会是用逆序字符的后一位减去逆序字符的数字</li></ul><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">romanToInt</span><span class="token punctuation">(</span>String s<span class="token punctuation">)</span> <span class="token punctuation">{</span>    Map<span class="token operator">&lt;</span>Character<span class="token punctuation">,</span> Integer<span class="token operator">></span> numMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    numMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">'I'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    numMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">'V'</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    numMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">'X'</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    numMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">'L'</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    numMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">'C'</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    numMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">'D'</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    numMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">'M'</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">int</span><span class="token punctuation">[</span>s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> n <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> res <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>        nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> numMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> nums<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>            res <span class="token operator">-=</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">else</span>            res <span class="token operator">+=</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> res <span class="token operator">+</span> nums<span class="token punctuation">[</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(n)$</li><li>空间复杂度：$O(1)$</li></ul></li></ol>]]></content>
      
      
      <categories>
          
          <category> leetcode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hash map </tag>
            
            <tag> easy </tag>
            
            <tag> string </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>12.Integer to Roman</title>
      <link href="/12-Integer-to-Roman/"/>
      <url>/12-Integer-to-Roman/</url>
      
        <content type="html"><![CDATA[<h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p>Roman numerals are represented by seven different symbols: <code>I</code>, <code>V</code>, <code>X</code>, <code>L</code>, <code>C</code>, <code>D</code> and <code>M</code>.</p><pre class="line-numbers language-java"><code class="language-java">Symbol       ValueI             <span class="token number">1</span>V             <span class="token number">5</span>X             <span class="token number">10</span>L             <span class="token number">50</span>C             <span class="token number">100</span>D             <span class="token number">500</span>M             <span class="token number">1000</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>For example, two is written as <code>II</code> in Roman numeral, just two one’s added together. Twelve is written as, <code>XII</code>, which is simply <code>X</code> + <code>II</code>. The number twenty seven is written as <code>XXVII</code>, which is <code>XX</code> + <code>V</code> + <code>II</code>.</p><p>Roman numerals are usually written largest to smallest from left to right. However, the numeral for four is not <code>IIII</code>. Instead, the number four is written as <code>IV</code>. Because the one is before the five we subtract it making four. The same principle applies to the number nine, which is written as <code>IX</code>. There are six instances where subtraction is used:</p><ul><li><code>I</code> can be placed before <code>V</code> (5) and <code>X</code> (10) to make 4 and 9. </li><li><code>X</code> can be placed before <code>L</code> (50) and <code>C</code> (100) to make 40 and 90. </li><li><code>C</code> can be placed before <code>D</code> (500) and <code>M</code> (1000) to make 400 and 900.</li></ul><p>Given an integer, convert it to a roman numeral. Input is guaranteed to be within the range from 1 to 3999.</p><a id="more"></a><p><strong>Example 1:</strong></p><pre class="line-numbers language-java"><code class="language-java">Input<span class="token operator">:</span> <span class="token number">3</span>Output<span class="token operator">:</span> <span class="token string">"III"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>Example 2:</strong></p><pre class="line-numbers language-java"><code class="language-java">Input<span class="token operator">:</span> <span class="token number">4</span>Output<span class="token operator">:</span> <span class="token string">"IV"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>Example 3:</strong></p><pre class="line-numbers language-java"><code class="language-java">Input<span class="token operator">:</span> <span class="token number">9</span>Output<span class="token operator">:</span> <span class="token string">"IX"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>Example 4:</strong></p><pre class="line-numbers language-java"><code class="language-java">Input<span class="token operator">:</span> <span class="token number">58</span>Output<span class="token operator">:</span> <span class="token string">"LVIII"</span>Explanation<span class="token operator">:</span> L <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">,</span> V <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">,</span> III <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><strong>Example 5:</strong></p><pre class="line-numbers language-java"><code class="language-java">Input<span class="token operator">:</span> <span class="token number">1994</span>Output<span class="token operator">:</span> <span class="token string">"MCMXCIV"</span>Explanation<span class="token operator">:</span> M <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">,</span> CM <span class="token operator">=</span> <span class="token number">900</span><span class="token punctuation">,</span> XC <span class="token operator">=</span> <span class="token number">90</span> and IV <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><ol><li><p>用hash map存所有数字对应的罗马字符；对每一位上的digit找到对应字符即可。</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">private</span> String <span class="token function">repeat</span><span class="token punctuation">(</span>String a<span class="token punctuation">,</span> <span class="token keyword">int</span> time<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>time <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span>    StringBuilder res <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> time<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>        res<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">public</span> String <span class="token function">intToRoman</span><span class="token punctuation">(</span><span class="token keyword">int</span> num<span class="token punctuation">)</span> <span class="token punctuation">{</span>    StringBuilder res <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Map<span class="token operator">&lt;</span>Integer<span class="token punctuation">,</span> String<span class="token operator">></span> charSet <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    charSet<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"I"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    charSet<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">"V"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    charSet<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">"X"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    charSet<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token string">"L"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    charSet<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token string">"C"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    charSet<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">,</span> <span class="token string">"D"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    charSet<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">,</span> <span class="token string">"M"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    res<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token function">repeat</span><span class="token punctuation">(</span>charSet<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">,</span> num <span class="token operator">/</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// res.append(charSet.get(1000).repeat(num / 1000)); // since JDK 11</span>    num <span class="token operator">%=</span> <span class="token number">1000</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> base <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>base <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">switch</span> <span class="token punctuation">(</span>num <span class="token operator">/</span> base<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">case</span> <span class="token number">9</span><span class="token operator">:</span>                res<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>charSet<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>base<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                res<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>charSet<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>base <span class="token operator">*</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token keyword">case</span> <span class="token number">8</span><span class="token operator">:</span>            <span class="token keyword">case</span> <span class="token number">7</span><span class="token operator">:</span>            <span class="token keyword">case</span> <span class="token number">6</span><span class="token operator">:</span>            <span class="token keyword">case</span> <span class="token number">5</span><span class="token operator">:</span>                res<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>charSet<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>base <span class="token operator">*</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                res<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token function">repeat</span><span class="token punctuation">(</span>charSet<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>base<span class="token punctuation">)</span><span class="token punctuation">,</span> num <span class="token operator">/</span> base <span class="token operator">-</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">// res.append(charSet.get(base).repeat(num / base - 5)); // since JDK 11</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token keyword">case</span> <span class="token number">4</span><span class="token operator">:</span>                res<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>charSet<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>base<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                res<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>charSet<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>base <span class="token operator">*</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token keyword">default</span><span class="token operator">:</span>                res<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token function">repeat</span><span class="token punctuation">(</span>charSet<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>base<span class="token punctuation">)</span><span class="token punctuation">,</span> num <span class="token operator">/</span> base<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">// res.append(charSet.get(base).repeat(num / base)); // since JDK 11</span>        <span class="token punctuation">}</span>        num <span class="token operator">%=</span> base<span class="token punctuation">;</span>        base <span class="token operator">/=</span> <span class="token number">10</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(log(num))​$</li><li>空间复杂度：$O(log(num))$</li></ul></li></ol>]]></content>
      
      
      <categories>
          
          <category> leetcode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> string </tag>
            
            <tag> medium </tag>
            
            <tag> hash set </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>11.Container With Most Water</title>
      <link href="/11-Container-With-Most-Water/"/>
      <url>/11-Container-With-Most-Water/</url>
      
        <content type="html"><![CDATA[<h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p>Given <em>n</em> non-negative integers <em>a1</em>, <em>a2</em>, …, <em>an</em> , where each represents a point at coordinate (<em>i</em>, <em>ai</em>). <em>n</em> vertical lines are drawn such that the two endpoints of line <em>i</em> is at (<em>i</em>, <em>ai</em>) and (<em>i</em>, 0). Find two lines, which together with x-axis forms a container, such that the container contains the most water.</p><p><strong>Note:</strong> You may not slant the container and <em>n</em> is at least 2.</p> <a id="more"></a><p><img src="https://s3-lc-upload.s3.amazonaws.com/uploads/2018/07/17/question_11.jpg" alt="img"></p><p>The above vertical lines are represented by array [1,8,6,2,5,4,8,3,7]. In this case, the max area of water (blue section) the container can contain is 49. </p><p><strong>Example:</strong></p><pre class="line-numbers language-java"><code class="language-java">Input<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">]</span>Output<span class="token operator">:</span> <span class="token number">49</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><ol><li><p>暴力求解，遍历每一组i，j。</p><ul><li>时间复杂度：$O(n^2)$</li><li>空间复杂度：$O(1)$</li></ul></li><li><p>双指针。首尾向中间靠拢，贪心收缩（每次移动值较小的指针）</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">maxArea</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> height<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">int</span> left <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> right <span class="token operator">=</span> height<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> res <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> curr<span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>left <span class="token operator">&lt;</span> right<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>height<span class="token punctuation">[</span>left<span class="token punctuation">]</span> <span class="token operator">&lt;</span> height<span class="token punctuation">[</span>right<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            curr <span class="token operator">=</span> <span class="token punctuation">(</span>right <span class="token operator">-</span> left<span class="token punctuation">)</span> <span class="token operator">*</span> height<span class="token punctuation">[</span>left<span class="token punctuation">]</span><span class="token punctuation">;</span>            left<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            curr <span class="token operator">=</span> <span class="token punctuation">(</span>right <span class="token operator">-</span> left<span class="token punctuation">)</span> <span class="token operator">*</span> height<span class="token punctuation">[</span>right<span class="token punctuation">]</span><span class="token punctuation">;</span>            right<span class="token operator">--</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        res <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> curr<span class="token punctuation">)</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> res<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(n)$</li><li>空间复杂度：$O(1)$</li></ul></li></ol>]]></content>
      
      
      <categories>
          
          <category> leetcode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> array </tag>
            
            <tag> two pointers </tag>
            
            <tag> medium </tag>
            
            <tag> greedy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>10.Regular Expression Matching</title>
      <link href="/10-Regular-Expression-Matching/"/>
      <url>/10-Regular-Expression-Matching/</url>
      
        <content type="html"><![CDATA[<h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p>Given an input string (<code>s</code>) and a pattern (<code>p</code>), implement regular expression matching with support for <code>&#39;.&#39;</code> and <code>&#39;*&#39;</code>.</p><pre class="line-numbers language-java"><code class="language-java"><span class="token string">'.'</span> Matches any single character<span class="token punctuation">.</span><span class="token string">'*'</span> Matches zero or more of the preceding element<span class="token punctuation">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>The matching should cover the <strong>entire</strong> input string (not partial).</p><p><strong>Note:</strong></p><ul><li><code>s</code> could be empty and contains only lowercase letters <code>a-z</code>.</li><li><code>p</code> could be empty and contains only lowercase letters <code>a-z</code>, and characters like <code>.</code> or <code>*</code>.</li></ul><a id="more"></a><p><strong>Example 1:</strong></p><pre class="line-numbers language-java"><code class="language-java">Input<span class="token operator">:</span>s <span class="token operator">=</span> <span class="token string">"aa"</span>p <span class="token operator">=</span> <span class="token string">"a"</span>Output<span class="token operator">:</span> <span class="token boolean">false</span>Explanation<span class="token operator">:</span> <span class="token string">"a"</span> does not match the entire string <span class="token string">"aa"</span><span class="token punctuation">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>Example 2:</strong></p><pre class="line-numbers language-java"><code class="language-java">Input<span class="token operator">:</span>s <span class="token operator">=</span> <span class="token string">"aa"</span>p <span class="token operator">=</span> <span class="token string">"a*"</span>Output<span class="token operator">:</span> <span class="token boolean">true</span>Explanation<span class="token operator">:</span> <span class="token string">'*'</span> means zero or more of the precedeng element<span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">.</span> Therefore<span class="token punctuation">,</span> by repeating <span class="token string">'a'</span> once<span class="token punctuation">,</span> it becomes <span class="token string">"aa"</span><span class="token punctuation">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>Example 3:</strong></p><pre class="line-numbers language-java"><code class="language-java">Input<span class="token operator">:</span>s <span class="token operator">=</span> <span class="token string">"ab"</span>p <span class="token operator">=</span> <span class="token string">".*"</span>Output<span class="token operator">:</span> <span class="token boolean">true</span>Explanation<span class="token operator">:</span> <span class="token string">".*"</span> means <span class="token string">"zero or more (*) of any character (.)"</span><span class="token punctuation">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>Example 4:</strong></p><pre class="line-numbers language-java"><code class="language-java">Input<span class="token operator">:</span>s <span class="token operator">=</span> <span class="token string">"aab"</span>p <span class="token operator">=</span> <span class="token string">"c*a*b"</span>Output<span class="token operator">:</span> <span class="token boolean">true</span>Explanation<span class="token operator">:</span> c can be repeated <span class="token number">0</span> times<span class="token punctuation">,</span> a can be repeated <span class="token number">1</span> time<span class="token punctuation">.</span> Therefore it matches <span class="token string">"aab"</span><span class="token punctuation">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>Example 5:</strong></p><pre class="line-numbers language-java"><code class="language-java">Input<span class="token operator">:</span>s <span class="token operator">=</span> <span class="token string">"mississippi"</span>p <span class="token operator">=</span> <span class="token string">"mis*is*p*."</span>Output<span class="token operator">:</span> <span class="token boolean">false</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><ol><li><p>嵌套递归求解</p><ul><li>对（star和它之前一个字符）之前的符号进行简单字符匹配；</li><li>对（star和它之前一个字符），对s中所有可能的长度进行划分（从0开始）；</li><li>对上一步产生的划分，使用star之后部分和s划分的后半部分进行匹配。只要有一种匹配满足即可。</li></ul><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">boolean</span> <span class="token function">charMatch</span><span class="token punctuation">(</span><span class="token keyword">char</span> s<span class="token punctuation">,</span> <span class="token keyword">char</span> p<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> s <span class="token operator">==</span> p <span class="token operator">||</span> p <span class="token operator">==</span> <span class="token string">'.'</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isMatch</span><span class="token punctuation">(</span>String s<span class="token punctuation">,</span> String p<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">int</span> star <span class="token operator">=</span> p<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">"*"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> n1 <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> n2 <span class="token operator">=</span> p<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>star <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>star <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// simple match.</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>n1 <span class="token operator">!=</span> n2<span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n1<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">charMatch</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> p<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// simple match the chars before star - 1</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>n1 <span class="token operator">&lt;</span> star <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token function">isMatch</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> star <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> p<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> star <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 从s中取0位到n位，和p的含*的两个位进行匹配，同时将后面部分和s的star+1起的字符串匹配</span>        <span class="token keyword">int</span> i <span class="token operator">=</span> star <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>        String after <span class="token operator">=</span> p<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>star <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">char</span> repeat <span class="token operator">=</span> p<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>star <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n1 <span class="token operator">&amp;&amp;</span> <span class="token function">charMatch</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> repeat<span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isMatch</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> after<span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 上面的匹配还剩下最后一次，也就是在0～i-1部分都可以匹配p[star - 1]的时候，从i开始的匹配</span>        <span class="token keyword">return</span> <span class="token function">isMatch</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> after<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：比较难分析，但是可达到$O((T+P)2^{T+\frac{P}{2}})​$</li><li>空间复杂度：同样比较难分析，可达到$O((T+P)2^{T+\frac{P}{2}})​$</li></ul></li><li><p>We define <code>dp[i][j]</code> to be <code>true</code> if <code>s[0..i)</code> matches <code>p[0..j)</code> and <code>false</code> otherwise.</p><ol><li><code>dp[i][j] = dp[i - 1][j - 1]</code>, if <code>p[j - 1] != &#39;*&#39; &amp;&amp; (s[i - 1] == p[j - 1] || p[j - 1] == &#39;.&#39;)</code>;</li><li><code>dp[i][j] = dp[i][j - 2]</code>, if <code>p[j - 1] == &#39;*&#39;</code> and the pattern repeats for 0 time;</li><li><code>dp[i][j] = dp[i - 1][j] &amp;&amp; (s[i - 1] == p[j - 2] || p[j - 2] == &#39;.&#39;)</code>, if <code>p[j - 1] == &#39;*&#39;</code> and the pattern repeats for at least 1 time.</li></ol><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isMatch</span><span class="token punctuation">(</span>String text<span class="token punctuation">,</span> String pattern<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">int</span> nt <span class="token operator">=</span> text<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> np <span class="token operator">=</span> pattern<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">boolean</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> dp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">boolean</span><span class="token punctuation">[</span>nt <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>np <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    dp<span class="token punctuation">[</span>nt<span class="token punctuation">]</span><span class="token punctuation">[</span>np<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> nt<span class="token punctuation">;</span> i <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> np <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">boolean</span> first_match <span class="token operator">=</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> nt <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>pattern<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span> <span class="token operator">==</span> text<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>                                              <span class="token operator">||</span> pattern<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>j <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">&lt;</span> pattern<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> pattern<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'*'</span><span class="token punctuation">)</span>                dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">||</span> first_match <span class="token operator">&amp;&amp;</span> dp<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token keyword">else</span>                dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> first_match <span class="token operator">&amp;&amp;</span> dp<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> dp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(TP)​$</li><li>空间复杂度：$O(TP)$</li></ul></li></ol>]]></content>
      
      
      <categories>
          
          <category> leetcode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hard </tag>
            
            <tag> dp </tag>
            
            <tag> string </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>9.Palindrome Number</title>
      <link href="/9-Palindrome-Number/"/>
      <url>/9-Palindrome-Number/</url>
      
        <content type="html"><![CDATA[<h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p>Determine whether an integer is a palindrome. An integer is a palindrome when it reads the same backward as forward.</p><a id="more"></a><p><strong>Example 1:</strong></p><pre class="line-numbers language-java"><code class="language-java">Input<span class="token operator">:</span> <span class="token number">121</span>Output<span class="token operator">:</span> <span class="token boolean">true</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>Example 2:</strong></p><pre class="line-numbers language-java"><code class="language-java">Input<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">121</span>Output<span class="token operator">:</span> <span class="token boolean">false</span>Explanation<span class="token operator">:</span> From left to right<span class="token punctuation">,</span> it reads <span class="token operator">-</span><span class="token number">121</span><span class="token punctuation">.</span> From right to left<span class="token punctuation">,</span> it becomes <span class="token number">121</span><span class="token operator">-</span><span class="token punctuation">.</span> Therefore it is not a palindrome<span class="token punctuation">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><strong>Example 3:</strong></p><pre class="line-numbers language-java"><code class="language-java">Input<span class="token operator">:</span> <span class="token number">10</span>Output<span class="token operator">:</span> <span class="token boolean">false</span>Explanation<span class="token operator">:</span> Reads <span class="token number">01</span> from right to left<span class="token punctuation">.</span> Therefore it is not a palindrome<span class="token punctuation">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><ol><li><p>获得翻转后的数。如果发生溢出，那么说明不可能是回文数；所以不必考虑溢出问题，翻转即可。</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isPalindrome</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>          <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> reverseX <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> copyX <span class="token operator">=</span> x<span class="token punctuation">;</span>    <span class="token keyword">while</span><span class="token punctuation">(</span>x<span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        reverseX <span class="token operator">=</span> reverseX <span class="token operator">*</span> <span class="token number">10</span> <span class="token operator">+</span> x <span class="token operator">%</span> <span class="token number">10</span><span class="token punctuation">;</span>        x <span class="token operator">/=</span> <span class="token number">10</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> reverseX <span class="token operator">==</span> copyX<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(log(x))$</li><li>空间复杂度：$O(1)$</li></ul></li></ol>]]></content>
      
      
      <categories>
          
          <category> leetcode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> easy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>7.Reverse Integer</title>
      <link href="/7-Reverse-Integer/"/>
      <url>/7-Reverse-Integer/</url>
      
        <content type="html"><![CDATA[<h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p>Given a 32-bit signed integer, reverse digits of an integer.</p><a id="more"></a><p><strong>Example 1:</strong></p><pre class="line-numbers language-java"><code class="language-java">Input<span class="token operator">:</span> <span class="token number">123</span>Output<span class="token operator">:</span> <span class="token number">321</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>Example 2:</strong></p><pre class="line-numbers language-java"><code class="language-java">Input<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">123</span>Output<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">321</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>Example 3:</strong></p><pre class="line-numbers language-java"><code class="language-java">Input<span class="token operator">:</span> <span class="token number">120</span>Output<span class="token operator">:</span> <span class="token number">21</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>Note:</strong><br>Assume we are dealing with an environment which could only store integers within the 32-bit signed integer range: [−2^31,  2^31 − 1]. For the purpose of this problem, assume that your function returns 0 when the reversed integer overflows.</p><h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><ol><li><p>trick：用long存储结果</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">reverse</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">long</span> res <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>x <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        res <span class="token operator">=</span> res <span class="token operator">*</span> <span class="token number">10</span> <span class="token operator">+</span> x <span class="token operator">%</span> <span class="token number">10</span><span class="token punctuation">;</span>        x <span class="token operator">/=</span> <span class="token number">10</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>      <span class="token keyword">int</span> tmp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> res<span class="token punctuation">;</span>    <span class="token keyword">return</span> tmp <span class="token operator">==</span> res <span class="token operator">?</span> tmp <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(logn)$</li><li>空间复杂度：$O(1)​$</li></ul></li><li><p>进行大小检测，但是检测过程比较复杂</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">reverse</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">int</span> res <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>x <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> pop <span class="token operator">=</span> x <span class="token operator">%</span> <span class="token number">10</span><span class="token punctuation">;</span>        x <span class="token operator">/=</span> <span class="token number">10</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>res <span class="token operator">></span> Integer<span class="token punctuation">.</span>MAX_VALUE<span class="token operator">/</span><span class="token number">10</span> <span class="token operator">||</span> <span class="token punctuation">(</span>res <span class="token operator">==</span> Integer<span class="token punctuation">.</span>MAX_VALUE <span class="token operator">/</span> <span class="token number">10</span> <span class="token operator">&amp;&amp;</span> pop <span class="token operator">></span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span>              <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>res <span class="token operator">&lt;</span> Integer<span class="token punctuation">.</span>MIN_VALUE<span class="token operator">/</span><span class="token number">10</span> <span class="token operator">||</span> <span class="token punctuation">(</span>res <span class="token operator">==</span> Integer<span class="token punctuation">.</span>MIN_VALUE <span class="token operator">/</span> <span class="token number">10</span> <span class="token operator">&amp;&amp;</span> pop <span class="token operator">&lt;</span> <span class="token operator">-</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>              <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>        res <span class="token operator">=</span> res <span class="token operator">*</span> <span class="token number">10</span> <span class="token operator">+</span> pop<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> res<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(log(x))$</li><li>空间复杂度：$O(1)$</li></ul></li></ol>]]></content>
      
      
      <categories>
          
          <category> leetcode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> easy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>6.Zig Zag Conversion</title>
      <link href="/6-Zig-Zag-Conversion/"/>
      <url>/6-Zig-Zag-Conversion/</url>
      
        <content type="html"><![CDATA[<h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p>The string <code>&quot;PAYPALISHIRING&quot;</code> is written in a zigzag pattern on a given number of rows like this: (you may want to display this pattern in a fixed font for better legibility)</p><pre class="line-numbers language-cpp"><code class="language-cpp">P   A   H   NA P L S I I GY   I   R<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>And then read line by line: <code>&quot;PAHNAPLSIIGYIR&quot;</code></p><p>Write the code that will take a string and make this conversion given a number of rows:</p><pre class="line-numbers language-cpp"><code class="language-cpp">string <span class="token function">convert</span><span class="token punctuation">(</span>string s<span class="token punctuation">,</span> <span class="token keyword">int</span> numRows<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><a id="more"></a><p><strong>Example 1:</strong></p><pre class="line-numbers language-java"><code class="language-java">Input<span class="token operator">:</span> s <span class="token operator">=</span> <span class="token string">"PAYPALISHIRING"</span><span class="token punctuation">,</span> numRows <span class="token operator">=</span> <span class="token number">3</span>Output<span class="token operator">:</span> <span class="token string">"PAHNAPLSIIGYIR"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>Example 2:</strong></p><pre class="line-numbers language-java"><code class="language-java">Input<span class="token operator">:</span> s <span class="token operator">=</span> <span class="token string">"PAYPALISHIRING"</span><span class="token punctuation">,</span> numRows <span class="token operator">=</span> <span class="token number">4</span>Output<span class="token operator">:</span> <span class="token string">"PINALSIGYAHRPI"</span>Explanation<span class="token operator">:</span>P     I    NA   L S  I GY A   H RP     I<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><ol><li><p>来回扫描</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> String <span class="token function">convert</span><span class="token punctuation">(</span>String s<span class="token punctuation">,</span> <span class="token keyword">int</span> numRows<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>numRows <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> s<span class="token punctuation">;</span>    <span class="token keyword">int</span> n <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> curr <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> currRow <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> currDir <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> str <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">toCharArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    StringBuilder<span class="token punctuation">[</span><span class="token punctuation">]</span> rows <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">[</span>numRows<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> numRows<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>        rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment" spellcheck="true">// 来回扫描，currDir记录前进方向</span>    rows<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>str<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>curr <span class="token operator">&lt;</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>currRow <span class="token operator">==</span> numRows <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">||</span> currRow <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>            currDir <span class="token operator">*=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>        rows<span class="token punctuation">[</span>currRow<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>str<span class="token punctuation">[</span>curr<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        currRow <span class="token operator">+=</span> currDir<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> numRows<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>        rows<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> rows<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(n)$</li><li>空间复杂度：$O(n)$</li></ul></li></ol>]]></content>
      
      
      <categories>
          
          <category> leetcode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> string </tag>
            
            <tag> medium </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>5.Longest Palindromic Substring</title>
      <link href="/5-Longest-Palindromic-Substring/"/>
      <url>/5-Longest-Palindromic-Substring/</url>
      
        <content type="html"><![CDATA[<h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p>Given a string <strong>s</strong>, find the longest palindromic substring in <strong>s</strong>. You may assume that the maximum length of <strong>s</strong> is 1000.</p><a id="more"></a><p><strong>Example 1:</strong></p><pre class="line-numbers language-cpp"><code class="language-cpp">Input<span class="token operator">:</span> <span class="token string">"babad"</span>Output<span class="token operator">:</span> <span class="token string">"bab"</span>Note<span class="token operator">:</span> <span class="token string">"aba"</span> is also a valid answer<span class="token punctuation">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><strong>Example 2:</strong></p><pre class="line-numbers language-cpp"><code class="language-cpp">Input<span class="token operator">:</span> <span class="token string">"cbbd"</span>Output<span class="token operator">:</span> <span class="token string">"bb"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><ol><li><p>暴力遍历，从头到尾依次判断</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">boolean</span> <span class="token function">isValid</span><span class="token punctuation">(</span>String s<span class="token punctuation">,</span> <span class="token keyword">int</span> from<span class="token punctuation">,</span> <span class="token keyword">int</span> to<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> from<span class="token punctuation">,</span> j <span class="token operator">=</span> to<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> j<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">,</span> j<span class="token operator">--</span><span class="token punctuation">)</span>          <span class="token keyword">if</span> <span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">!=</span> s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span>              <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>      <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">public</span> String <span class="token function">longestPalindrome</span><span class="token punctuation">(</span>String s<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>s <span class="token operator">==</span> null <span class="token operator">||</span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>          <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span>      <span class="token keyword">int</span> n <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> start <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> end <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isValid</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> i<span class="token punctuation">,</span> j<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> j <span class="token operator">-</span> i <span class="token operator">></span> end <span class="token operator">-</span> start<span class="token punctuation">)</span> <span class="token punctuation">{</span>                    start <span class="token operator">=</span> i<span class="token punctuation">;</span>                  end <span class="token operator">=</span> j<span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>      <span class="token keyword">return</span> s<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span> end <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(n^3)$</li><li>空间复杂度：$O(1)$</li></ul></li><li><p>以某个字符（奇数长度）或者两个字符（偶数长度）作为回文串的中心向外拓展。</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">int</span> <span class="token function">count</span><span class="token punctuation">(</span>String s<span class="token punctuation">,</span> <span class="token keyword">int</span> left<span class="token punctuation">,</span> <span class="token keyword">int</span> right<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> n <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> left <span class="token operator">-</span> i <span class="token operator">>=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> right <span class="token operator">+</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>left <span class="token operator">-</span> i<span class="token punctuation">)</span> <span class="token operator">!=</span> s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>right <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token operator">--</span>i<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">public</span> String <span class="token function">longestPalindrome</span><span class="token punctuation">(</span>String s<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>s <span class="token operator">==</span> null <span class="token operator">||</span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> n <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> start <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> end <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>      <span class="token comment" spellcheck="true">// odd length</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> tmp <span class="token operator">=</span> <span class="token function">count</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> i<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>tmp <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">></span> end <span class="token operator">-</span> start<span class="token punctuation">)</span> <span class="token punctuation">{</span>            start <span class="token operator">=</span> i <span class="token operator">-</span> tmp<span class="token punctuation">;</span>            end <span class="token operator">=</span> i <span class="token operator">+</span> tmp <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>      <span class="token comment" spellcheck="true">// even length</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">==</span> s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">int</span> tmp <span class="token operator">=</span> <span class="token function">count</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> i<span class="token punctuation">,</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>tmp <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">></span> end <span class="token operator">-</span> start<span class="token punctuation">)</span> <span class="token punctuation">{</span>                start <span class="token operator">=</span> i <span class="token operator">-</span> tmp<span class="token punctuation">;</span>                end <span class="token operator">=</span> i <span class="token operator">+</span> tmp <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> s<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span> end<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(n^2)$</li><li>空间复杂度：$O(1)$</li></ul></li><li><p>dp：二维数组记录i到j是否为回文字符串；<code>dp[i][j] = dp[i + 1][j - 1] &amp;&amp; s.charAt(i) == s.charAt(j)</code></p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> String <span class="token function">longestPalindrome</span><span class="token punctuation">(</span>String s<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>s <span class="token operator">==</span> null <span class="token operator">||</span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>          <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span>      <span class="token keyword">int</span> n <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> start <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> end <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>      <span class="token keyword">boolean</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> dp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">boolean</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span>      <span class="token comment" spellcheck="true">// 这里的遍历顺序很重要：</span>      <span class="token comment" spellcheck="true">// 因为更新当前i和j需要参考i+1到j-1的位置，所以需要i从大到小，j从小到大更新；</span>      <span class="token comment" spellcheck="true">// 同时，j &lt; i是没有意义的。</span>      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> i<span class="token punctuation">;</span> j <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>              <span class="token comment" spellcheck="true">// 除了从公式得出的过程，如果i和j相差&lt;=2字符，那么当然是回文</span>            dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">==</span> s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>j <span class="token operator">-</span> i <span class="token operator">&lt;</span> <span class="token number">3</span> <span class="token operator">||</span> dp<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>dp<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> j <span class="token operator">-</span> i <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">></span> end <span class="token operator">-</span> start<span class="token punctuation">)</span> <span class="token punctuation">{</span>                start <span class="token operator">=</span> i<span class="token punctuation">;</span>                end <span class="token operator">=</span> j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> s<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span> end<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(n^2)$</li><li>空间复杂度：$O(n^2)$</li></ul></li></ol>]]></content>
      
      
      <categories>
          
          <category> leetcode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> dp </tag>
            
            <tag> medium </tag>
            
            <tag> longest xxx </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>4.Median of Two Sorted Arrays</title>
      <link href="/4-Median-of-Two-Sorted-Arrays/"/>
      <url>/4-Median-of-Two-Sorted-Arrays/</url>
      
        <content type="html"><![CDATA[<h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p>There are two sorted arrays <strong>nums1</strong> and <strong>nums2</strong> of size m and n respectively.</p><p>Find the median of the two sorted arrays. The overall run time complexity should be O(log (m+n)).</p><p>You may assume <strong>nums1</strong> and <strong>nums2</strong> cannot be both empty.</p><a id="more"></a><p><strong>Example 1:</strong></p><pre class="line-numbers language-cpp"><code class="language-cpp">nums1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>nums2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>The median is <span class="token number">2.0</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><strong>Example 2:</strong></p><pre class="line-numbers language-cpp"><code class="language-cpp">nums1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span>nums2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span>The median <span class="token function">is</span> <span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span> <span class="token operator">=</span> <span class="token number">2.5</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><h4 id="归并到一个数组，然后直接求解"><a href="#归并到一个数组，然后直接求解" class="headerlink" title="归并到一个数组，然后直接求解"></a>归并到一个数组，然后直接求解</h4><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">findMedianSortedArrays</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> A<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> B<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">int</span> m <span class="token operator">=</span> A<span class="token punctuation">.</span>length<span class="token punctuation">,</span> n <span class="token operator">=</span> B<span class="token punctuation">.</span>length<span class="token punctuation">,</span> i1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> i2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> c <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">int</span><span class="token punctuation">[</span>m <span class="token operator">+</span> n<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>i1 <span class="token operator">&lt;</span> m <span class="token operator">&amp;&amp;</span> i2 <span class="token operator">&lt;</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>A<span class="token punctuation">[</span>i1<span class="token punctuation">]</span> <span class="token operator">&lt;</span> B<span class="token punctuation">[</span>i2<span class="token punctuation">]</span><span class="token punctuation">)</span>            c<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> A<span class="token punctuation">[</span>i1<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">else</span>            c<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> B<span class="token punctuation">[</span>i2<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>i1 <span class="token operator">&lt;</span> m<span class="token punctuation">)</span>        c<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> A<span class="token punctuation">[</span>i1<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>i2 <span class="token operator">&lt;</span> n<span class="token punctuation">)</span>        c<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> B<span class="token punctuation">[</span>i2<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> index <span class="token operator">=</span> <span class="token punctuation">(</span>m <span class="token operator">+</span> n<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>m <span class="token operator">+</span> n<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span> c<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>c<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">+</span> c<span class="token punctuation">[</span>index <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2.0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(n1+n2)$，n1和n2分别是两个数组长度</li><li>空间复杂度：$O(n1 + n2)​$</li></ul><h4 id="递归二分查找"><a href="#递归二分查找" class="headerlink" title="递归二分查找"></a>递归二分查找</h4><pre class="line-numbers language-java"><code class="language-java"><span class="token comment" spellcheck="true">// 首先将问题转换为找到第k小的数，并对奇偶分开讨论</span><span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">findMedianSortedArrays</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums1<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums2<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">int</span> m <span class="token operator">=</span> nums1<span class="token punctuation">.</span>length<span class="token punctuation">,</span> n <span class="token operator">=</span> nums2<span class="token punctuation">.</span>length<span class="token punctuation">,</span> left <span class="token operator">=</span> <span class="token punctuation">(</span>m <span class="token operator">+</span> n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span> right <span class="token operator">=</span> <span class="token punctuation">(</span>m <span class="token operator">+</span> n <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>left <span class="token operator">==</span> right<span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span> <span class="token function">findKth</span><span class="token punctuation">(</span>nums1<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> nums2<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> left<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token function">findKth</span><span class="token punctuation">(</span>nums1<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> nums2<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> left<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">findKth</span><span class="token punctuation">(</span>nums1<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> nums2<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> right<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2.0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">// 找到两个数组中，从i开始的部分和从j开始的部分，第k位的数</span><span class="token comment" spellcheck="true">// 每次搜索都会减少k/2的数，所以调用层数是O(logk) = O(log(n1 + n2))</span><span class="token keyword">private</span> <span class="token keyword">int</span> <span class="token function">findKth</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums1<span class="token punctuation">,</span> <span class="token keyword">int</span> i<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums2<span class="token punctuation">,</span> <span class="token keyword">int</span> j<span class="token punctuation">,</span> <span class="token keyword">int</span> k<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">>=</span> nums1<span class="token punctuation">.</span>length<span class="token punctuation">)</span>        <span class="token keyword">return</span> nums2<span class="token punctuation">[</span>j <span class="token operator">+</span> k <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>j <span class="token operator">>=</span> nums2<span class="token punctuation">.</span>length<span class="token punctuation">)</span>        <span class="token keyword">return</span> nums1<span class="token punctuation">[</span>i <span class="token operator">+</span> k <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>      <span class="token comment" spellcheck="true">// 这里拿出来特判，是因为k==1对下面的过程不适用</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>k <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>nums1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> nums2<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment" spellcheck="true">// 首先假设两边各自贡献k/2个数；</span>      <span class="token comment" spellcheck="true">// 找到两个数组中，k/2位置的数，那么小的那一侧将会贡献更多的数，所以就从小的一侧开始切割掉k/2个数</span>    <span class="token keyword">int</span> midVal1 <span class="token operator">=</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> k <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">&lt;</span> nums1<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token operator">?</span> nums1<span class="token punctuation">[</span>i <span class="token operator">+</span> k <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">:</span> Integer<span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">;</span>    <span class="token keyword">int</span> midVal2 <span class="token operator">=</span> <span class="token punctuation">(</span>j <span class="token operator">+</span> k <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">&lt;</span> nums2<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token operator">?</span> nums2<span class="token punctuation">[</span>j <span class="token operator">+</span> k <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">:</span> Integer<span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>midVal1 <span class="token operator">&lt;</span> midVal2<span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token function">findKth</span><span class="token punctuation">(</span>nums1<span class="token punctuation">,</span> i <span class="token operator">+</span> k <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span> nums2<span class="token punctuation">,</span> j<span class="token punctuation">,</span> k <span class="token operator">-</span> k <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token function">findKth</span><span class="token punctuation">(</span>nums1<span class="token punctuation">,</span> i<span class="token punctuation">,</span> nums2<span class="token punctuation">,</span> j <span class="token operator">+</span> k <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span> k <span class="token operator">-</span> k <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">// 其实也可以改写成迭代版本，但是对于这个函数来说出口过多，也不是很简洁</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(log(n1 + n2))​$</li><li>空间复杂度：$O(log(n1 + n2))​$（这里指递归栈的空间）</li></ul><h4 id="迭代二分查找，详细解释"><a href="#迭代二分查找，详细解释" class="headerlink" title="迭代二分查找，详细解释"></a>迭代二分查找，<a href="https://leetcode.com/problems/median-of-two-sorted-arrays/discuss/2471/very-concise-ologminmn-iterative-solution-with-detailed-explanation">详细解释</a></h4><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">findMedianSortedArrays</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums1<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums2<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">int</span> m <span class="token operator">=</span> nums1<span class="token punctuation">.</span>length<span class="token punctuation">,</span> n <span class="token operator">=</span> nums2<span class="token punctuation">.</span>length<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>m <span class="token operator">&lt;</span> n<span class="token punctuation">)</span>          <span class="token keyword">return</span> <span class="token function">findMedianSortedArrays</span><span class="token punctuation">(</span>nums2<span class="token punctuation">,</span> nums1<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>          <span class="token keyword">return</span> <span class="token punctuation">(</span>nums1<span class="token punctuation">[</span><span class="token punctuation">(</span>m <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> nums1<span class="token punctuation">[</span>m <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2.0</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> left <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> right <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> n<span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>left <span class="token operator">&lt;=</span> right<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> mid2 <span class="token operator">=</span> <span class="token punctuation">(</span>left <span class="token operator">+</span> right<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> mid1 <span class="token operator">=</span> m <span class="token operator">+</span> n <span class="token operator">-</span> mid2<span class="token punctuation">;</span>        <span class="token keyword">double</span> L1 <span class="token operator">=</span> mid1 <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">?</span> Double<span class="token punctuation">.</span>MIN_VALUE <span class="token operator">:</span> nums1<span class="token punctuation">[</span><span class="token punctuation">(</span>mid1 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">double</span> L2 <span class="token operator">=</span> mid2 <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">?</span> Double<span class="token punctuation">.</span>MIN_VALUE <span class="token operator">:</span> nums2<span class="token punctuation">[</span><span class="token punctuation">(</span>mid2 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">double</span> R1 <span class="token operator">=</span> mid1 <span class="token operator">==</span> m <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">?</span> Double<span class="token punctuation">.</span>MAX_VALUE <span class="token operator">:</span> nums1<span class="token punctuation">[</span>mid1 <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">double</span> R2 <span class="token operator">=</span> mid2 <span class="token operator">==</span> n <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">?</span> Double<span class="token punctuation">.</span>MAX_VALUE <span class="token operator">:</span> nums2<span class="token punctuation">[</span>mid2 <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>L1 <span class="token operator">></span> R2<span class="token punctuation">)</span>              left <span class="token operator">=</span> mid2 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>L2 <span class="token operator">></span> R1<span class="token punctuation">)</span>              right <span class="token operator">=</span> mid2 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">else</span>              <span class="token keyword">return</span> <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>L1<span class="token punctuation">,</span> L2<span class="token punctuation">)</span> <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>R1<span class="token punctuation">,</span> R2<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(log(min(n1, n2)))$</li><li>空间复杂度：$O(1)$</li></ul><hr><p>这题还有很多其他的奇技淫巧，但可能没有上面的做法容易理解。</p>]]></content>
      
      
      <categories>
          
          <category> leetcode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> array </tag>
            
            <tag> hard </tag>
            
            <tag> binary search </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>3.Longest Substring Without Repeating Characters</title>
      <link href="/3-Longest-Substring-Without-Repeating-Characters/"/>
      <url>/3-Longest-Substring-Without-Repeating-Characters/</url>
      
        <content type="html"><![CDATA[<h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p>Given a string, find the length of the <strong>longest substring</strong> without repeating characters.</p><a id="more"></a><p><strong>Example 1:</strong></p><pre class="line-numbers language-cpp"><code class="language-cpp">Input<span class="token operator">:</span> <span class="token string">"abcabcbb"</span>Output<span class="token operator">:</span> <span class="token number">3</span> Explanation<span class="token operator">:</span> The answer is <span class="token string">"abc"</span><span class="token punctuation">,</span> with the length of <span class="token number">3</span><span class="token punctuation">.</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><strong>Example 2:</strong></p><pre class="line-numbers language-cpp"><code class="language-cpp">Input<span class="token operator">:</span> <span class="token string">"bbbbb"</span>Output<span class="token operator">:</span> <span class="token number">1</span>Explanation<span class="token operator">:</span> The answer is <span class="token string">"b"</span><span class="token punctuation">,</span> with the length of <span class="token number">1</span><span class="token punctuation">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><strong>Example 3:</strong></p><pre class="line-numbers language-cpp"><code class="language-cpp">Input<span class="token operator">:</span> <span class="token string">"pwwkew"</span>Output<span class="token operator">:</span> <span class="token number">3</span>Explanation<span class="token operator">:</span> The answer is <span class="token string">"wke"</span><span class="token punctuation">,</span> with the length of <span class="token number">3</span><span class="token punctuation">.</span>              Note that the answer must be a substring<span class="token punctuation">,</span> <span class="token string">"pwke"</span> is a subsequence <span class="token operator">and</span> <span class="token operator">not</span> a substring<span class="token punctuation">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><h4 id="暴力，检查不同的头和尾。"><a href="#暴力，检查不同的头和尾。" class="headerlink" title="暴力，检查不同的头和尾。"></a>暴力，检查不同的头和尾。</h4><ul><li>时间复杂度：$O(n^3)​$</li><li>空间复杂度：$O(min(n, m))$，n为字符串长度，而m为字符串中出现的字符种类数量</li></ul><h4 id="滑动窗口1。用HashSet存当前出现字符。"><a href="#滑动窗口1。用HashSet存当前出现字符。" class="headerlink" title="滑动窗口1。用HashSet存当前出现字符。"></a>滑动窗口1。用HashSet存当前出现字符。</h4><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">lengthOfLongestSubstring</span><span class="token punctuation">(</span>String s<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">int</span> n <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Set<span class="token operator">&lt;</span>Character<span class="token operator">></span> set <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashSet</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> res <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> n <span class="token operator">&amp;&amp;</span> j <span class="token operator">&lt;</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// try to extend the range [i, j]</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>set<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            res <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> j <span class="token operator">-</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span>            set<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> res<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(n)$</li><li>空间复杂度：$O(min(n, m))​$</li></ul><h4 id="滑动窗口2。用HashMap存当前出现的字符以及出现位置。"><a href="#滑动窗口2。用HashMap存当前出现的字符以及出现位置。" class="headerlink" title="滑动窗口2。用HashMap存当前出现的字符以及出现位置。"></a>滑动窗口2。用HashMap存当前出现的字符以及出现位置。</h4><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">lengthOfLongestSubstring</span><span class="token punctuation">(</span>String s<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">int</span> res <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> n <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> start <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    HashMap<span class="token operator">&lt;</span>Character<span class="token punctuation">,</span> Integer<span class="token operator">></span> pos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">char</span> c <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>pos<span class="token punctuation">.</span><span class="token function">containsKey</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span>            start <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>pos<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> start<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// key point</span>                  <span class="token comment" spellcheck="true">// 这里必须用max，因为有可能pos.get(c) + 1比start要小（较早出现，但未更新的字符）</span>        pos<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>        res <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> i <span class="token operator">-</span> start <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> res<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(n)​$</li><li>空间复杂度：$O(min(n, m))$</li></ul><h4 id="同3，但是可以将HashMap转换成HashTable，使用int-128-存放所有出现的字符位置。"><a href="#同3，但是可以将HashMap转换成HashTable，使用int-128-存放所有出现的字符位置。" class="headerlink" title="同3，但是可以将HashMap转换成HashTable，使用int[128]存放所有出现的字符位置。"></a>同3，但是可以将HashMap转换成HashTable，使用int[128]存放所有出现的字符位置。</h4><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">lengthOfLongestSubstring</span><span class="token punctuation">(</span>String s<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">int</span> n <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> res <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> index <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">int</span><span class="token punctuation">[</span><span class="token number">128</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// current index of character</span>      <span class="token comment" spellcheck="true">// 使用128存，而不是26存的好处不止在于可以放其他的字符，而且不需要进行类似“i-‘A’”的操作</span>    <span class="token comment" spellcheck="true">// try to extend the range [i, j]</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        i <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>index<span class="token punctuation">[</span>s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>        res <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> j <span class="token operator">-</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        index<span class="token punctuation">[</span>s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> res<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(n)$</li><li>空间复杂度：$O(m)$</li></ul>]]></content>
      
      
      <categories>
          
          <category> leetcode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hash map </tag>
            
            <tag> string </tag>
            
            <tag> medium </tag>
            
            <tag> hash set </tag>
            
            <tag> sliding window </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2.Add Two Numbers</title>
      <link href="/2-Add-Two-Numbers/"/>
      <url>/2-Add-Two-Numbers/</url>
      
        <content type="html"><![CDATA[<h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p>You are given two <strong>non-empty</strong> linked lists representing two non-negative integers. The digits are stored in <strong>reverse order</strong> and each of their nodes contain a single digit. Add the two numbers and return it as a linked list.</p><p>You may assume the two numbers do not contain any leading zero, except the number 0 itself.</p><a id="more"></a><p><strong>Example:</strong></p><pre class="line-numbers language-cpp"><code class="language-cpp">Input<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token number">4</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">5</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token number">6</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token number">4</span><span class="token punctuation">)</span>Output<span class="token operator">:</span> <span class="token number">7</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token number">0</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token number">8</span>Explanation<span class="token operator">:</span> <span class="token number">342</span> <span class="token operator">+</span> <span class="token number">465</span> <span class="token operator">=</span> <span class="token number">807</span><span class="token punctuation">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><h4 id="遍历，记得dummy-head的常用做法。"><a href="#遍历，记得dummy-head的常用做法。" class="headerlink" title="遍历，记得dummy head的常用做法。"></a>遍历，记得dummy head的常用做法。</h4><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> ListNode <span class="token function">addTwoNumbers</span><span class="token punctuation">(</span>ListNode l1<span class="token punctuation">,</span> ListNode l2<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">int</span> carry <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    ListNode dummy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ListNode</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> curr <span class="token operator">=</span> dummy<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// dummy head</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>carry <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">||</span> l1 <span class="token operator">!=</span> null <span class="token operator">||</span> l2 <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>l1 <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>            carry <span class="token operator">+=</span> l1<span class="token punctuation">.</span>val<span class="token punctuation">;</span>            l1 <span class="token operator">=</span> l1<span class="token punctuation">.</span>next<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>l2 <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>            carry <span class="token operator">+=</span> l2<span class="token punctuation">.</span>val<span class="token punctuation">;</span>            l2 <span class="token operator">=</span> l2<span class="token punctuation">.</span>next<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        curr<span class="token punctuation">.</span>next <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ListNode</span><span class="token punctuation">(</span>carry <span class="token operator">%</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        curr <span class="token operator">=</span> curr<span class="token punctuation">.</span>next<span class="token punctuation">;</span>        carry <span class="token operator">/=</span> <span class="token number">10</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> dummy<span class="token punctuation">.</span>next<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(n1 + n2)$，n1和n2分别是两个链表长度</li><li>空间复杂度：$O(max(n1, n2))$</li></ul>]]></content>
      
      
      <categories>
          
          <category> leetcode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> medium </tag>
            
            <tag> linked list </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>1.Two Sum</title>
      <link href="/1-Two-Sum/"/>
      <url>/1-Two-Sum/</url>
      
        <content type="html"><![CDATA[<h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p>Given an array of integers, return <strong>indices</strong> of the two numbers such that they add up to a specific target.</p><p>You may assume that each input would have <strong>exactly</strong> one solution, and you may not use the <em>same</em> element twice.</p><a id="more"></a><p><strong>Example:</strong></p><pre class="line-numbers language-cpp"><code class="language-cpp">Given nums <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">,</span> target <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">,</span>Because nums<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> nums<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">7</span> <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">,</span><span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><h4 id="使用排序-双指针"><a href="#使用排序-双指针" class="headerlink" title="使用排序+双指针"></a>使用排序+双指针</h4><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">twoSum</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">,</span> <span class="token keyword">int</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>      Arrays<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span>nums<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">int</span> left <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> right <span class="token operator">=</span> nums<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>      <span class="token keyword">while</span> <span class="token punctuation">(</span>left <span class="token operator">&lt;</span> right<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>nums<span class="token punctuation">[</span>left<span class="token punctuation">]</span> <span class="token operator">+</span> nums<span class="token punctuation">[</span>right<span class="token punctuation">]</span> <span class="token operator">&lt;</span> target<span class="token punctuation">)</span>              left<span class="token operator">++</span><span class="token punctuation">;</span>          <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>nums<span class="token punctuation">[</span>left<span class="token punctuation">]</span> <span class="token operator">+</span> nums<span class="token punctuation">[</span>right<span class="token punctuation">]</span> <span class="token operator">></span> target<span class="token punctuation">)</span>              right<span class="token operator">--</span><span class="token punctuation">;</span>          <span class="token keyword">else</span>              <span class="token keyword">break</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>      <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span>left<span class="token punctuation">,</span> right<span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(nlogn)$</li><li>空间复杂度：$O(1)$</li></ul><h4 id="使用HashMap存下数字和对应下标，一边存一边遍历"><a href="#使用HashMap存下数字和对应下标，一边存一边遍历" class="headerlink" title="使用HashMap存下数字和对应下标，一边存一边遍历"></a>使用HashMap存下数字和对应下标，一边存一边遍历</h4><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">twoSum</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">,</span> <span class="token keyword">int</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>    HashMap<span class="token operator">&lt;</span>Integer<span class="token punctuation">,</span> Integer<span class="token operator">></span> numbers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> nums<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> n <span class="token operator">=</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>numbers<span class="token punctuation">.</span><span class="token function">containsKey</span><span class="token punctuation">(</span>target <span class="token operator">-</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span>numbers<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>target <span class="token operator">-</span> n<span class="token punctuation">)</span><span class="token punctuation">,</span> i<span class="token punctuation">}</span><span class="token punctuation">;</span>        numbers<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>时间复杂度：$O(n)​$</li><li>空间复杂度：$O(n)$</li></ul><h4 id="对每个元素暴力遍历找另一半，代码略。"><a href="#对每个元素暴力遍历找另一半，代码略。" class="headerlink" title="对每个元素暴力遍历找另一半，代码略。"></a>对每个元素暴力遍历找另一半，代码略。</h4><ul><li>时间复杂度：$O(n^2)$</li><li>空间复杂度：$O(1)$</li></ul>]]></content>
      
      
      <categories>
          
          <category> leetcode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hash map </tag>
            
            <tag> array </tag>
            
            <tag> two pointers </tag>
            
            <tag> easy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello, World</title>
      <link href="/Hello-World/"/>
      <url>/Hello-World/</url>
      
        <content type="html"><![CDATA[<p>这里是ZJU软工菜🐔一枚。</p><p>记录刷题、面试，项目经历，以及其他……这是我来的路。</p>]]></content>
      
      
      <categories>
          
          <category> leetcode </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Shape of Britain——英国访学游记</title>
      <link href="/Shape-of-Britain/"/>
      <url>/Shape-of-Britain/</url>
      
        <content type="html"><![CDATA[<p>这是我去年暑假去英国的访学游记。</p><p>文中照片全部来自本人手机拍摄……</p><hr><h4 id="8月21日-伦敦时间23-24于飞机"><a href="#8月21日-伦敦时间23-24于飞机" class="headerlink" title="8月21日    伦敦时间23:24于飞机"></a>8月21日    伦敦时间23:24于飞机</h4><h3 id="序"><a href="#序" class="headerlink" title="序"></a>序</h3><p>​    我睡不着。</p><p>​    刚刚结束为期十七天，新鲜而充实的异国之旅带来的疲倦，反而令我难以入睡。</p><p>​    机舱里隆隆的引擎声和从脚底传来的震动，以及冷气略强的空调，似乎都可以成为失眠的理由。但，好像并不是。</p><p>​    是因为即将回国带来的激动？离开这片梦幻的土地产生的不舍？又或者是即将与这群朝夕相处的同伴分别，回归平淡日常带来的落差？</p><p>​    我很难归咎于其中一个理由。也许对几小时后欣赏舷窗外的日出的期待才是罪魁祸首。</p><p>​    窗外，铺开在飞机下方的云海像初春渐渐化开的薄薄雪层，里面偶尔可见闪烁的点点灯火，是城市的眼睛。近处的雾霭模糊了视线，不仔细看仿佛云层未曾移动。</p><p>​    在太阳升起之前，我打算整理一下这些天的经历和思绪。遗憾的是我没有记录日记的好习惯，这么多天的记忆片段混合只带给我一个英国朦胧的印象。</p><p>​    那么，我将努力描绘这一轮廓的一些边边角角，而非以日志的形式，记录下我的所见与所想。</p><h3 id="街道"><a href="#街道" class="headerlink" title="街道"></a>街道</h3><p><img src="/Shape-of-Britain/street.jpg" alt></p><p>​    伦敦的街道上，四处有着经历数百年风雨洗礼的古迹，也有一些年代较近但是同样典雅华美的房屋，二者融为一体，用浓厚的历史韵味浸润着穿行其中的人们。市区没有高楼大厦带来的压迫感，像一个健谈而好客的朋友，向旅行者娓娓道来这座城市的故事，却又狡黠地隐藏起无数细节，等待着有心人细细发掘和品味。</p><p>​    稍一抬头，就能看见伦敦的蓝天——如今的伦敦早已摘下雾都的灰帽子，尽显她迷人的风姿。大本钟和伦敦眼这些地标脱颖而出，构成了无数游人记忆的背景物。</p><p>​    这里遍地都是女王的宠物——灰羽白尾的鸽子悠闲地停在人行道上、房檐上，它们和行人一道，从容信步于大街上，俨然是一副英国公民的仪态。听说私自捉鸽子还是不小的罪：）</p><p>​    不时可以看见作为伦敦又一标志物的红色双层巴士在街道上穿行，给中世纪风格的街道带来一道明亮灵动的色彩。从巴士的二层向外可以俯瞰街道，为游览伦敦带来一个新奇的视角。</p><p>​    这里美中不足的是街道的规划。出于保护建筑的考虑，没有进行大范围的扩建，过去留给马车和行人的街道对现在这座处处都是异乡观光客的城市来说略显窘迫。此外还有缺少自行车专线，以及和狭窄的小路不相称的密集红绿灯等等的小毛病。</p><p>​    让人好笑的是，一直以来印象里欧洲市民的高素质在这里也被证明过于理想化了——大部分时候，这里的人也都是凑够一拨就敢闯红灯的主儿。不过这里的司机倒是颇有风度，一般都会礼让行人，也很少用喇叭吓唬人。当然这一点杭州也做的越来越好了。</p><p><img src="/Shape-of-Britain/street in cambridge.jpg" alt></p><h3 id="艺人"><a href="#艺人" class="headerlink" title="艺人"></a>艺人</h3><p><img src="/Shape-of-Britain/band.jpg" alt></p><p>​    走在伦敦的街道上，常常能听到忧郁的吉他弹唱，又或是明快的苏格兰风笛乐。有时你会看到一个衣着朴素的青年，随意地站在地铁的入口处翻唱流行歌曲；有时你会看到一个装备简单的乐队，在广场上即兴地演奏。他们周围总是不乏热情喝彩的观众，他们前面的盒子和帽子里总是堆满了硬币和纸币。</p><p>​    不过，可不要把他们和一般卖唱为生的流浪者相提并论——他们之中很多都是一些地方上小有名气的歌手和乐团，通过这样没有门槛的演出圈粉。也有一些是纯粹的音乐爱好者，在主业以外靠街头表演来调剂消遣。</p><p>​    大部分的艺人都是一群热爱生活的人，街头的表演可能不仅仅是谋生的手段，也是快乐和满足的源泉。这些自由而快乐的艺人，是伦敦城的最好注解。</p><h3 id="地铁"><a href="#地铁" class="headerlink" title="地铁"></a>地铁</h3><p>​    在伦敦的街道上走累了，不妨尝试一下这里的地铁。</p><p>​    很早就听说伦敦的地铁里很少有人在玩手机、打电话，都是一些安静地看报和沉思的绅士淑女们，和国内的地铁里人人都在水手机的场景形成鲜明对比。今日有幸亲眼见识了伦敦地铁的男男女女，发现此言确实不虚，只不过没说清楚——伦敦的地铁没有信号也没有wifi，除了看报发呆，玩玩cross puzzle以外，还有什么能排遣通勤的无聊的呢？</p><p>​    另外一点不能忍受的就是地铁里没有空调——在夏天的伦敦地铁里，无论是站台上或者车厢里都十分闷热。而且站台上也没有隔离墙，地铁进站时就能感受到一股劲风迎面而来，真让人捏把汗。</p><p>​    不过，对这一个世上最高龄的地铁系统，似乎也不好抱怨什么。只能说我们的祖国完美地利用了后发者的优势，让我们享受到了现代交通的便利。</p><h3 id="食物"><a href="#食物" class="headerlink" title="食物"></a>食物</h3><p>​    “拴住一个人最好的方式是拴住他的胃。”那么恐怕英国是无法拴住一个中国人的。</p><p>​    英国有三道名菜——Fish and chips。炸鱼就是一大块无味的鱼，薯条就是普通的粗薯条，不管加什么酱料，我都是在看不出这有什么美味的。英国人对炸鱼薯条的热情让人难以想象，而且是真心觉得这玩意很美味。每次想到这一点，我都不禁同情他们，为他们可能一生都吃不到真正美味的东西而感到遗憾。</p><p>​    除此之外，意大利菜，美国快餐（主要是开封菜）之类的也让人难以适应。找东亚的餐馆成为了一天重要的事——日本的寿司，泰国的咖喱，中国的烤鱼，那真的是天赐的美味。</p><p>​    不过我在这里并不要控诉英国食物的难吃和单调，而是描述这些天经历的一段奇遇。</p><p>​    有一天傍晚，我和熟悉的同学去贝克街221b看福尔摩斯。我们走进了一家寿司店，那里的面和饭也说不上好吃，但是因为时间比较晚了，加之本土的菜已经让我们不再期待在这儿能遭遇什么美食，倒也没有什么怨言。</p><p>​    等我们吃完，店里已经没有其他顾客了。这时老板走来正要关门，突然转身对我们说：你们想要免费的寿司吗？（Do you want FREE sushi?）</p><p>​    我们面面相觑，这是什么操作？正惊疑不定间，老板指着冷藏架上的寿司说：这些寿司我卖不完，今天要扔掉了，你们不嫌弃的话可以拿走。</p><p>​    他接着用手比划了一下，意思是全部都可以拿走。</p><p>​    我们看着半柜子的大大小小的寿司盒子，惊呆了。里面有紫菜的、三文鱼的、叫不出名字的各种寿司，简直是一顿豪华的寿司宴。以一盒五磅算的话，这里应该有六七十磅了。</p><p>​    谢过老板之后我们带着两大袋寿司满载而归，一路上感慨万千。<s>“资本主义确实有可取之处”</s>，不过当然更多地是对老板的大方和对食材的高标准要求感到印象深刻。我们商量着怎么处置这些寿司，甚至打算当街叫卖——当然最终还是带到寝室分食了。</p><p>​    这次奇遇使我们得出一个结论：以后要是吃不起饭，就去寿司店蹲点！</p><h3 id="景点"><a href="#景点" class="headerlink" title="景点"></a>景点</h3><p><img src="/Shape-of-Britain/london eye.jpg" alt></p><p>说句实话，伦敦的市区本身带来的美好已经足够让人惊艳，而她的几个主要景点倒是没有在我心里留下太多的印象；留下的只是一些画面。</p><p>伦敦眼上将泰晤士河两岸的建筑收尽眼底，在夕阳下熠熠闪光的河水与被染红的大本钟形成的剪影。</p><p>西敏斯特教堂里气象万千的彩色花窗，脚下无数有名无名者的墓碑，是人类群星闪耀的余烬。</p><p>塔桥上层的玻璃下方，车水马龙的桥面和汹涌的河水清晰可见，带给人魔幻而危险的刺激。</p><p>免费开放的大英博物馆、国家美术馆这些地方非但是外国游客的聚集地，也经常是本地人的休闲场所。经常看到有一家三口，大人带着小孩参观的场景。如果住在伦敦，时不时有空去欣赏世界名画的风采，也是充满情趣。</p><p>在伦敦的时候还去了一个地方，那就是杜莎夫人蜡像馆。那里不仅展出着本国的名人，包括莎士比亚，伊丽莎白这些，以及本土的明星，还有许多举世闻名的人物。一进场就能看到赫本在《蒂凡尼的早餐》里妆容精致，一袭黑色长裙，手持烟斗端坐在小桌边的经典场景，气质风采不亚于真人。此外还有同行的女孩子心心念念的卷福、抖森这些当今的大牌，和他们合影真是过足了瘾。</p><p>剑河两岸典雅幽静的学院建筑，横跨其上的叹息桥；国王学院依偎着高达数十米的巨大橡树，偶然飞过的鸽子永远留在了我的镜头里。种种的美好，不一而足。</p><p><img src="/Shape-of-Britain/king college1.jpg" alt></p><p><img src="/Shape-of-Britain/trinity college.jpg" alt></p><h3 id="学习"><a href="#学习" class="headerlink" title="学习"></a>学习</h3><p><img src="/Shape-of-Britain/teacher.JPG" alt></p><p>​    说了这么多旅行和娱乐的事情，是时候总结一下学习的情况了。</p><p>​    总体而言，这一次的体验收获丰富。虽然部分讲座的深度略显不足，但是考虑到这一次游学带有一部分科普的性质，而同行的人们也不全有计算机的基础，这一部分只当开拓眼界即可。</p><p>​    帝国理工大学的Schuller教授给我们带来了机器学习和深度学习概念的导览，略去了一些不必要的技术细节，并介绍了当前研究主要的前沿部分如CNN、end-to-end的理论和实践。当然仅仅通过介绍就想了解这一领域显然是不足的；根据这些入门的概念，在后期深入学习是十分必要的。</p><p>​    此外，在汤森路透和技术总监的交流也使我们看到AI在新闻领域的应用，Benevelant公司则利用NLP技术提取论文中的关系构建知识网络，着实让人开拓了眼界。</p><p>​    对于工业4.0的部分，在剑桥接触的ARM芯片公司有着制定行业标准的野心，无人驾驶领域通过lidar技术实现精确的前景辨认，以及窄带网络的分布计算去云端的系统，都使人印象深刻。然而隔行如隔山，我对于这一工业领域的了解有限，无法完全领会他们讲座的精髓之处。</p><h3 id="其他-·-尾声"><a href="#其他-·-尾声" class="headerlink" title="其他 · 尾声"></a>其他 · 尾声</h3><p>​    英国人很懒。</p><p>​    这里的店铺，比如饭店、书店，大多五六点就关门了；到了九点之后，服装店、化妆品这些也很难在街上看到；超市是最晚关门的，大约十点。酒吧之类的应该是从下午开始营业，自是另当别论，但是在七八点钟的时候，走在英国的街道上和走在国内的街道上是两种完全不同的体验。你会感觉错过了一定的时间，做什么都不方便。</p><p>​    英国人是悠闲的，生活质量比谋生更重要。其实整个欧洲都差不多。大概这就是社会发展水平的差异吧，对物质财富重视也是发展中国家人民的一大特点，这一点彼此都无可厚非。逛街体验上当然不如国内。</p><p>​    英国人的社交活动不多。</p><p>​    他们唯一的爱好就是周四周五的晚上，站在小酒吧的门口端着一杯酒尬聊。这样的奇妙场景十分常见，在人数众多的场合甚至有警察维护秩序。有机会的话，真想加入他们看看都在聊些什么。不过在酒吧饮酒似乎需要满21周岁————这是题外话了。</p><p>​    英国，有缘再会。</p>]]></content>
      
      
      <categories>
          
          <category> life </category>
          
      </categories>
      
      
        <tags>
            
            <tag> traveling </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
